var Et=Object.defineProperty;var Rt=(a,e,r)=>e in a?Et(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var p=(a,e,r)=>(Rt(a,typeof e!="symbol"?e+"":e,r),r);import{l as w,t as xe,q as s,aC as Ce,aM as At,aF as ke,x as $t,aJ as Ee,a1 as zt,y as A,n as K,a9 as Bt,w as Lt,aa as Gt,a6 as Vt,a8 as Le,cI as Oe,m as Ht,s as H,O as ct,Y as Zt,cJ as Wt,cK as qt,cL as Yt,cM as Kt,ad as se,aN as Xt,cN as Jt,a$ as J,aA as ut,J as R,F as B,b5 as dt,aV as P,bp as mt,by as Qt,cO as er,cP as tr,bb as Ue,cQ as Ge,c8 as F,cR as ft,cS as L,ca as O,v as rr,c9 as ht,cT as Ve,bn as ar,cU as ir,cV as Pe,cW as sr,cd as M,S as nr,e as pt,cu as gt,cX as or,bo as G,b6 as ve,cY as lr,cZ as cr,cE as He,cv as ur,c_ as dr}from"./index.ec641b5a.js";import{S as Ne}from"./Skeleton.1ecba237.js";import{T as mr}from"./Table.395efdc7.js";import{C as fr}from"./CSSTransition.2eb23181.js";import{e as ue}from"./routes.96a891de.js";import{H as Ze}from"./isEqual.5ca85d66.js";var ee="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/breadcrumb/BreadcrumbItem.js",hr=globalThis&&globalThis.__rest||function(a,e){var r={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&e.indexOf(t)<0&&(r[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(a);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(a,t[i])&&(r[t[i]]=a[t[i]]);return r},vt=function(e){var r=e.prefixCls,t=e.separator,i=t===void 0?"/":t,o=e.children,n=e.overlay,l=e.dropdownProps,d=hr(e,["prefixCls","separator","children","overlay","dropdownProps"]),u=w.exports.useContext(xe),m=u.getPrefixCls,f=m("breadcrumb",r),c=function(C){return n?s(Ce,{overlay:n,placement:"bottom",...l,children:s("span",{className:"".concat(f,"-overlay-link"),children:[C,s(At,{},void 0,!1,{fileName:ee,lineNumber:43,columnNumber:39},this)]},void 0,!0,{fileName:ee,lineNumber:41,columnNumber:39},this)},void 0,!1,{fileName:ee,lineNumber:38,columnNumber:27},this):C},h;return"href"in d?h=s("a",{className:"".concat(f,"-link"),...d,children:o},void 0,!1,{fileName:ee,lineNumber:52,columnNumber:25},this):h=s("span",{className:"".concat(f,"-link"),...d,children:o},void 0,!1,{fileName:ee,lineNumber:56,columnNumber:25},this),h=c(h),o?s("li",{children:[h,i&&s("span",{className:"".concat(f,"-separator"),children:i},void 0,!1,{fileName:ee,lineNumber:65,columnNumber:89},this)]},void 0,!0,{fileName:ee,lineNumber:65,columnNumber:25},this):null};vt.__ANT_BREADCRUMB_ITEM=!0;const Nt=vt;var pr="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/breadcrumb/BreadcrumbSeparator.js",bt=function(e){var r=e.children,t=w.exports.useContext(xe),i=t.getPrefixCls,o=i("breadcrumb");return s("span",{className:"".concat(o,"-separator"),children:r||"/"},void 0,!1,{fileName:pr,lineNumber:11,columnNumber:23},this)};bt.__ANT_BREADCRUMB_SEPARATOR=!0;const gr=bt;var de="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/breadcrumb/Breadcrumb.js",vr=globalThis&&globalThis.__rest||function(a,e){var r={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&e.indexOf(t)<0&&(r[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(a);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(a,t[i])&&(r[t[i]]=a[t[i]]);return r};function Nr(a,e){if(!a.breadcrumbName)return null;var r=Object.keys(e).join("|"),t=a.breadcrumbName.replace(new RegExp(":(".concat(r,")"),"g"),function(i,o){return e[o]||i});return t}function br(a,e,r,t){var i=r.indexOf(a)===r.length-1,o=Nr(a,e);return i?s("span",{children:o},void 0,!1,{fileName:de,lineNumber:43,columnNumber:36},this):s("a",{href:"#/".concat(t.join("/")),children:o},void 0,!1,{fileName:de,lineNumber:43,columnNumber:91},this)}var yt=function(e,r){return e=(e||"").replace(/^\//,""),Object.keys(r).forEach(function(t){e=e.replace(":".concat(t),r[t])}),e},yr=function(e,r,t){var i=Bt(e),o=yt(r||"",t);return o&&i.push(o),i},Re=function(e){var r=e.prefixCls,t=e.separator,i=t===void 0?"/":t,o=e.style,n=e.className,l=e.routes,d=e.children,u=e.itemRender,m=u===void 0?br:u,f=e.params,c=f===void 0?{}:f,h=vr(e,["prefixCls","separator","style","className","routes","children","itemRender","params"]),v=w.exports.useContext(xe),C=v.getPrefixCls,g=v.direction,N,b=C("breadcrumb",r);if(l&&l.length>0){var U=[];N=l.map(function(k){var y=yt(k.path,c);y&&U.push(y);var T;return k.children&&k.children.length&&(T=s(ke,{items:k.children.map(function(S){return{key:S.path||S.breadcrumbName,label:m(S,c,l,yr(U,S.path,c))}})},void 0,!1,{fileName:de,lineNumber:103,columnNumber:32},this)),s(Nt,{overlay:T,separator:i,children:m(k,c,l,U)},y||k.breadcrumbName,!1,{fileName:de,lineNumber:113,columnNumber:27},this)})}else d&&(N=$t(d).map(function(k,y){return k&&(Ee(k.type&&(k.type.__ANT_BREADCRUMB_ITEM===!0||k.type.__ANT_BREADCRUMB_SEPARATOR===!0),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),zt(k,{separator:i,key:y}))}));var D=A(b,K({},"".concat(b,"-rtl"),g==="rtl"),n);return s("nav",{className:D,style:o,...h,children:s("ol",{children:N},void 0,!1,{fileName:de,lineNumber:137,columnNumber:31},this)},void 0,!1,{fileName:de,lineNumber:134,columnNumber:23},this)};Re.Item=Nt;Re.Separator=gr;const le=Re;var wr={className:"",percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,style:{},trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},Cr=function(){var e=w.exports.useRef([]),r=w.exports.useRef(null);return w.exports.useEffect(function(){var t=Date.now(),i=!1;e.current.forEach(function(o){if(!!o){i=!0;var n=o.style;n.transitionDuration=".3s, .3s, .3s, .06s",r.current&&t-r.current<100&&(n.transitionDuration="0s, 0s")}}),i&&(r.current=Date.now())}),e.current},We=0,kr=Gt();function Sr(){var a;return kr?(a=We,We+=1):a="TEST_OR_SSR",a}const xr=function(a){var e=w.exports.useState(),r=Lt(e,2),t=r[0],i=r[1];return w.exports.useEffect(function(){i("rc_progress_".concat(Sr()))},[]),a||t};var ce="/Users/yl/github-repo/openflat/node_modules/.pnpm/rc-progress@3.3.3_sfoxds7t5ydpegc3knd667wn6m/node_modules/rc-progress/es/Circle.js",Ur=["id","prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function qe(a){return+a.replace("%","")}function Ye(a){var e=a!=null?a:[];return Array.isArray(e)?e:[e]}var te=100,Ke=function(e,r,t,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,n=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,u=o>0?90+o/2:-90,m=Math.PI*2*e,f=m*((360-o)/360),c=r/100*360*((360-o)/360),h=o===0?0:{bottom:0,top:180,left:90,right:-90}[n],v=(100-t)/100*f;return l==="round"&&t!==100&&(v+=d/2,v>=f&&(v=f-.01)),{stroke:typeof i=="string"?i:void 0,strokeDasharray:"".concat(f,"px ").concat(m),strokeDashoffset:v,transform:"rotate(".concat(u+c+h,"deg)"),transformOrigin:"50% 50%",transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},Ae=function(e){var r=e.id,t=e.prefixCls,i=e.strokeWidth,o=e.trailWidth,n=e.gapDegree,l=e.gapPosition,d=e.trailColor,u=e.strokeLinecap,m=e.style,f=e.className,c=e.strokeColor,h=e.percent,v=Vt(e,Ur),C=xr(r),g="".concat(C,"-gradient"),N=te/2-i/2,b=Ke(N,0,100,d,n,l,u,i),U=Ye(h),D=Ye(c),k=D.find(function(S){return S&&Le(S)==="object"}),y=Cr(),T=function(){var I=0;return U.map(function(Y,Z){var Q=D[Z]||D[D.length-1],$=Q&&Le(Q)==="object"?"url(#".concat(g,")"):void 0,ne=Ke(N,I,Y,Q,n,l,u,i);return I+=Y,s("circle",{className:"".concat(t,"-circle-path"),r:N,cx:te/2,cy:te/2,stroke:$,strokeLinecap:u,strokeWidth:i,opacity:Y===0?0:1,style:ne,ref:function(Te){y[Z]=Te}},Z,!1,{fileName:ce,lineNumber:91,columnNumber:27},this)}).reverse()};return s("svg",{className:A("".concat(t,"-circle"),f),viewBox:"0 0 ".concat(te," ").concat(te),style:m,id:r,...v,children:[k&&s("defs",{children:s("linearGradient",{id:g,x1:"100%",y1:"0%",x2:"0%",y2:"0%",children:Object.keys(k).sort(function(S,I){return qe(S)-qe(I)}).map(function(S,I){return s("stop",{offset:S,stopColor:k[S]},I,!1,{fileName:ce,lineNumber:127,columnNumber:25},this)})},void 0,!1,{fileName:ce,lineNumber:118,columnNumber:90},this)},void 0,!1,{fileName:ce,lineNumber:118,columnNumber:43},this),s("circle",{className:"".concat(t,"-circle-trail"),r:N,cx:te/2,cy:te/2,stroke:d,strokeLinecap:u,strokeWidth:o||i,style:b},void 0,!1,{fileName:ce,lineNumber:132,columnNumber:22},this),T()]},void 0,!0,{fileName:ce,lineNumber:113,columnNumber:23},this)};Ae.defaultProps=wr;Ae.displayName="Circle";function ie(a){return!a||a<0?0:a>100?100:a}function Se(a){var e=a.success,r=a.successPercent,t=r;return e&&"progress"in e&&(Ee(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),t=e.progress),e&&"percent"in e&&(t=e.percent),t}var Xe="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/progress/Circle.js";function Fr(a){var e=a.percent,r=a.success,t=a.successPercent,i=ie(Se({success:r,successPercent:t}));return[i,ie(ie(e)-i)]}function Tr(a){var e=a.success,r=e===void 0?{}:e,t=a.strokeColor,i=r.strokeColor;return[i||Oe.green,t||null]}var Pr=function(e){var r=e.prefixCls,t=e.width,i=e.strokeWidth,o=e.trailColor,n=o===void 0?null:o,l=e.strokeLinecap,d=l===void 0?"round":l,u=e.gapPosition,m=e.gapDegree,f=e.type,c=e.children,h=e.success,v=t||120,C={width:v,height:v,fontSize:v*.15+6},g=i||6,N=u||f==="dashboard"&&"bottom"||void 0,b=function(){if(m||m===0)return m;if(f==="dashboard")return 75},U=Object.prototype.toString.call(e.strokeColor)==="[object Object]",D=Tr({success:h,strokeColor:e.strokeColor}),k=A("".concat(r,"-inner"),K({},"".concat(r,"-circle-gradient"),U));return s("div",{className:k,style:C,children:[s(Ae,{percent:Fr(e),strokeWidth:g,trailWidth:g,strokeColor:D,strokeLinecap:d,trailColor:n,prefixCls:r,gapDegree:b(),gapPosition:N},void 0,!1,{fileName:Xe,lineNumber:72,columnNumber:19},this),c]},void 0,!0,{fileName:Xe,lineNumber:69,columnNumber:23},this)};const Dr=Pr;var be="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/progress/Line.js",Mr=globalThis&&globalThis.__rest||function(a,e){var r={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&e.indexOf(t)<0&&(r[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(a);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(a,t[i])&&(r[t[i]]=a[t[i]]);return r},Or=function(e){var r=[];return Object.keys(e).forEach(function(t){var i=parseFloat(t.replace(/%/g,""));isNaN(i)||r.push({key:i,value:e[t]})}),r=r.sort(function(t,i){return t.key-i.key}),r.map(function(t){var i=t.key,o=t.value;return"".concat(o," ").concat(i,"%")}).join(", ")},_r=function(e,r){var t=e.from,i=t===void 0?Oe.blue:t,o=e.to,n=o===void 0?Oe.blue:o,l=e.direction,d=l===void 0?r==="rtl"?"to left":"to right":l,u=Mr(e,["from","to","direction"]);if(Object.keys(u).length!==0){var m=Or(u);return{backgroundImage:"linear-gradient(".concat(d,", ").concat(m,")")}}return{backgroundImage:"linear-gradient(".concat(d,", ").concat(i,", ").concat(n,")")}},Ir=function(e){var r=e.prefixCls,t=e.direction,i=e.percent,o=e.strokeWidth,n=e.size,l=e.strokeColor,d=e.strokeLinecap,u=d===void 0?"round":d,m=e.children,f=e.trailColor,c=f===void 0?null:f,h=e.success,v=l&&typeof l!="string"?_r(l,t):{background:l},C=u==="square"||u==="butt"?0:void 0,g={backgroundColor:c||void 0,borderRadius:C},N=Ht({width:"".concat(ie(i),"%"),height:o||(n==="small"?6:8),borderRadius:C},v),b=Se(e),U={width:"".concat(ie(b),"%"),height:o||(n==="small"?6:8),borderRadius:C,backgroundColor:h==null?void 0:h.strokeColor},D=b!==void 0?s("div",{className:"".concat(r,"-success-bg"),style:U},void 0,!1,{fileName:be,lineNumber:121,columnNumber:68},this):null;return s(H,{children:[s("div",{className:"".concat(r,"-outer"),children:s("div",{className:"".concat(r,"-inner"),style:g,children:[s("div",{className:"".concat(r,"-bg"),style:N},void 0,!1,{fileName:be,lineNumber:130,columnNumber:19},this),D]},void 0,!0,{fileName:be,lineNumber:127,columnNumber:19},this)},void 0,!1,{fileName:be,lineNumber:125,columnNumber:78},this),m]},void 0,!0)};const jr=Ir;var Je="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/progress/Steps.js",Er=function(e){for(var r=e.size,t=e.steps,i=e.percent,o=i===void 0?0:i,n=e.strokeWidth,l=n===void 0?8:n,d=e.strokeColor,u=e.trailColor,m=u===void 0?null:u,f=e.prefixCls,c=e.children,h=Math.round(t*(o/100)),v=r==="small"?2:14,C=new Array(t),g=0;g<t;g++){var N=Array.isArray(d)?d[g]:d;C[g]=s("div",{className:A("".concat(f,"-steps-item"),K({},"".concat(f,"-steps-item-active"),g<=h-1)),style:{backgroundColor:g<=h-1?N:m,width:v,height:l}},g,!1,{fileName:Je,lineNumber:23,columnNumber:35},this)}return s("div",{className:"".concat(f,"-steps-outer"),children:[C,c]},void 0,!0,{fileName:Je,lineNumber:34,columnNumber:23},this)};const Rr=Er;var W="/Users/yl/github-repo/openflat/node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/progress/progress.js",Ar=globalThis&&globalThis.__rest||function(a,e){var r={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&e.indexOf(t)<0&&(r[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(a);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(a,t[i])&&(r[t[i]]=a[t[i]]);return r};ct("line","circle","dashboard");var $r=ct("normal","exception","active","success"),zr=function(e){var r,t=e.prefixCls,i=e.className,o=e.steps,n=e.strokeColor,l=e.percent,d=l===void 0?0:l,u=e.size,m=u===void 0?"default":u,f=e.showInfo,c=f===void 0?!0:f,h=e.type,v=h===void 0?"line":h,C=Ar(e,["prefixCls","className","steps","strokeColor","percent","size","showInfo","type"]);function g(){var $=Se(e);return parseInt($!==void 0?$.toString():d.toString(),10)}function N(){var $=e.status;return $r.indexOf($)<0&&g()>=100?"success":$||"normal"}function b($,ne){var Fe=e.format,Te=Se(e);if(!c)return null;var oe,It=Fe||function(jt){return"".concat(jt,"%")},Be=v==="line";return Fe||ne!=="exception"&&ne!=="success"?oe=It(ie(d),ie(Te)):ne==="exception"?oe=Be?s(Wt,{},void 0,!1,{fileName:W,lineNumber:85,columnNumber:40},this):s(qt,{},void 0,!1,{fileName:W,lineNumber:85,columnNumber:100},this):ne==="success"&&(oe=Be?s(Yt,{},void 0,!1,{fileName:W,lineNumber:87,columnNumber:40},this):s(Kt,{},void 0,!1,{fileName:W,lineNumber:87,columnNumber:100},this)),s("span",{className:"".concat($,"-text"),title:typeof oe=="string"?oe:void 0,children:oe},void 0,!1,{fileName:W,lineNumber:90,columnNumber:25},this)}var U=w.exports.useContext(xe),D=U.getPrefixCls,k=U.direction,y=D("progress",t),T=N(),S=b(y,T);Ee(!("successPercent"in e),"Progress","`successPercent` is deprecated. Please use `success.percent` instead.");var I=Array.isArray(n)?n[0]:n,Y=typeof n=="string"||Array.isArray(n)?n:void 0,Z;v==="line"?Z=o?s(Rr,{...e,strokeColor:Y,prefixCls:y,steps:o,children:S},void 0,!1,{fileName:W,lineNumber:109,columnNumber:37},this):s(jr,{...e,strokeColor:I,prefixCls:y,direction:k,children:S},void 0,!1,{fileName:W,lineNumber:113,columnNumber:38},this):(v==="circle"||v==="dashboard")&&(Z=s(Dr,{...e,strokeColor:I,prefixCls:y,progressStatus:T,children:S},void 0,!1,{fileName:W,lineNumber:119,columnNumber:29},this));var Q=A(y,(r={},K(r,"".concat(y,"-").concat(v==="dashboard"&&"circle"||o&&"steps"||v),!0),K(r,"".concat(y,"-status-").concat(T),!0),K(r,"".concat(y,"-show-info"),c),K(r,"".concat(y,"-").concat(m),m),K(r,"".concat(y,"-rtl"),k==="rtl"),r),i);return s("div",{...Zt(C,["status","format","trailColor","strokeWidth","width","gapDegree","gapPosition","strokeLinecap","success","successPercent"]),className:Q,children:Z},void 0,!1,{fileName:W,lineNumber:127,columnNumber:23},this)};const Br=zr;var me="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGListLoading.tsx";const Lr=({active:a,className:e="",...r})=>s("svg",{className:`${e} flat-icon ${a?"is-active":""}`,fill:"none",height:"50",viewBox:"0 0 50 50",width:"50",xmlns:"http://www.w3.org/2000/svg",...r,children:[s("rect",{height:"50",width:"50"},void 0,!1,{fileName:me,lineNumber:20,columnNumber:13},void 0),s("circle",{cx:"13",cy:"25",fill:"#3381FF",r:"2"},void 0,!1,{fileName:me,lineNumber:21,columnNumber:13},void 0),s("circle",{cx:"25",cy:"25",fill:"#3381FF",r:"4"},void 0,!1,{fileName:me,lineNumber:22,columnNumber:13},void 0),s("circle",{cx:"37",cy:"25",fill:"#3381FF",r:"2"},void 0,!1,{fileName:me,lineNumber:23,columnNumber:13},void 0)]},void 0,!0,{fileName:me,lineNumber:11,columnNumber:9},void 0),Gr="data:image/svg+xml;charset=utf8,%3csvg width='124' height='124' xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3clinearGradient x1='100%25' y1='50%25' x2='0%25' y2='50%25' id='a'%3e%3cstop stop-color='%237A7B7C' stop-opacity='0' offset='0%25'/%3e%3cstop stop-color='%237A7B7C' offset='100%25'/%3e%3c/linearGradient%3e%3c/defs%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='white' opacity='.01' d='M0 0h124v124H0z'/%3e%3cpath stroke='%237A7B7C' d='M31.464 110.196 28.6 109.5l2.132-2.035.697-2.864 2.035 2.132 2.864.697-2.132 2.035-.697 2.864zM92 21h8m-4-4v8'/%3e%3cpath fill='url(%23a)' opacity='.1' d='M32 80V22h25.943L64 30l30-.09V80z'/%3e%3cpath stroke='%237A7B7C' stroke-width='2' d='M92 95H22V29h28l7 9h35v7'/%3e%3cpath stroke='%237A7B7C' stroke-width='2' d='m26.321 75.122 2.253-10.36L32 49h70L92 95H22'/%3e%3c/g%3e%3c/svg%3e",Vr=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],Hr=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Zr=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],Wr=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Qe=(a,e,r)=>{let t=a;return typeof e=="string"||Array.isArray(e)?t=a.toLocaleString(e,r):(e===!0||r!==void 0)&&(t=a.toLocaleString(void 0,r)),t};function wt(a,e){if(!Number.isFinite(a))throw new TypeError(`Expected a finite number, got ${typeof a}: ${a}`);e={bits:!1,binary:!1,...e};const r=e.bits?e.binary?Wr:Zr:e.binary?Hr:Vr;if(e.signed&&a===0)return` 0 ${r[0]}`;const t=a<0,i=t?"-":e.signed?"+":"";t&&(a=-a);let o;if(e.minimumFractionDigits!==void 0&&(o={minimumFractionDigits:e.minimumFractionDigits}),e.maximumFractionDigits!==void 0&&(o={maximumFractionDigits:e.maximumFractionDigits,...o}),a<1){const u=Qe(a,e.locale,o);return i+u+" "+r[0]}const n=Math.min(Math.floor(e.binary?Math.log(a)/Math.log(1024):Math.log10(a)/3),r.length-1);a/=(e.binary?1024:1e3)**n,o||(a=a.toPrecision(3));const l=Qe(Number(a),e.locale,o),d=r[n];return i+l+" "+d}var et="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileListHeadTip/index.tsx";const qr=se.memo(function(e){const{className:r,...t}=e;return s(Xt,{...t,className:A(r,"cloud-storage-file-list-help"),children:s(Jt,{},void 0,!1,{fileName:et,lineNumber:19,columnNumber:21},this)},void 0,!1,{fileName:et,lineNumber:15,columnNumber:17},this)}),Yr="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M5.052 12.059a1.135 1.135 0 0 0 .784-.303 1.033 1.033 0 0 0 .303-.765 1.02 1.02 0 0 0-.303-.748c-.214-.214-.463-.303-.784-.303-.302 0-.552.089-.748.303a.97.97 0 0 0-.32.748c0 .302.107.552.32.765.196.196.446.303.748.303Zm5.948 0a1.135 1.135 0 0 0 .784-.303 1.033 1.033 0 0 0 .303-.765 1.02 1.02 0 0 0-.303-.748A1.06 1.06 0 0 0 11 9.94a1.02 1.02 0 0 0-.765.303c-.214.196-.303.445-.303.748s.089.552.303.765a1.091 1.091 0 0 0 .765.303Zm5.93 0a1.091 1.091 0 0 0 .766-.303.982.982 0 0 0 .32-.765.97.97 0 0 0-.32-.748 1.02 1.02 0 0 0-.766-.303 1.02 1.02 0 0 0-.765.303c-.214.196-.303.445-.303.748s.089.552.303.765a1.091 1.091 0 0 0 .765.303Z' fill='%23444E60'/%3e%3c/svg%3e",Kr="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F8F8F8'/%3e%3cstop offset='1' stop-color='%23DCDCDC'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23ECECEC'/%3e%3cstop offset='1' stop-color='%23CFCFCF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Xr="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cpath opacity='.01' d='M2 4h20v20H2V4Z' fill='%235D6066'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='m12 10 4-1v2l-3 .75V17h-.05a2.5 2.5 0 1 1-.95-2.5V10Z' fill='white'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%238CF79C'/%3e%3cstop offset='1' stop-color='%2303CF22'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2378FF8D'/%3e%3cstop offset='1' stop-color='%2303CA22'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Jr="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M9.5 13a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm4.5-1 3 7H7l2-4 3 1 2-4Z' fill='white'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2392E5FF'/%3e%3cstop offset='1' stop-color='%2300ACE2'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2392E5FF'/%3e%3cstop offset='1' stop-color='%2300ACE2'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Qr="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='M16.359 17.96a4.264 4.264 0 0 1-2.473-1.003c-1.37.3-2.673.735-3.976 1.27C8.874 20.064 7.905 21 7.07 21c-.168 0-.368-.033-.502-.134A.985.985 0 0 1 6 19.964c0-.3.067-1.136 3.241-2.506a23.785 23.785 0 0 0 1.771-4.144c-.4-.802-1.27-2.773-.668-3.776.2-.367.602-.568 1.036-.534.334 0 .668.167.869.434.434.601.4 1.871-.167 3.743a10.08 10.08 0 0 0 2.071 2.673c.702-.134 1.404-.234 2.106-.234 1.57.033 1.804.769 1.77 1.203 0 1.136-1.102 1.136-1.67 1.136Zm-9.357 2.07.1-.033c.469-.167.836-.5 1.103-.935a2.64 2.64 0 0 0-1.203.969Zm4.445-10.024h-.1c-.034 0-.1 0-.134.034-.134.568-.033 1.17.2 1.704.2-.568.2-1.17.034-1.738Zm.234 4.845-.034.067-.033-.033c-.3.768-.635 1.537-1.003 2.272l.067-.033v.067a19.445 19.445 0 0 1 2.273-.669l-.034-.033h.1c-.5-.501-.969-1.07-1.336-1.638Zm4.544 1.771c-.3 0-.568 0-.869.067a2.8 2.8 0 0 0 1.003.268c.234.033.468 0 .668-.067 0-.1-.133-.268-.802-.268Z' fill='white'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FF8989'/%3e%3cstop offset='1' stop-color='%23CE0000'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FF8989'/%3e%3cstop offset='1' stop-color='%23CE0000'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ea="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cpath d='M9 11h4a2 2 0 1 1 0 4h-2m0-4v8m-2 0h4' stroke='white' stroke-width='1.5' stroke-linejoin='round'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FFDA89'/%3e%3cstop offset='1' stop-color='%23F9AA00'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='22' y1='0' x2='14' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FFCD5F'/%3e%3cstop offset='1' stop-color='%23F90'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ta="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8 13a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-1l2 1v-4l-2 1v-1a1 1 0 0 0-1-1H8Z' fill='white'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2391CBFF'/%3e%3cstop offset='1' stop-color='%230285F9'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2366B7FF'/%3e%3cstop offset='1' stop-color='%230285F9'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",ra="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='M2 3a3 3 0 0 1 3-3h9l8 8v13a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V3Z' fill='url(%23a)'/%3e%3cpath d='m14 0 8 8h-5a3 3 0 0 1-3-3V0Z' fill='url(%23b)'/%3e%3cpath d='m8 12 2 7 2-5 2 5 2-7' stroke='white' stroke-width='1.5' stroke-linejoin='bevel'/%3e%3cpath d='M7 12h2m6 0h2' stroke='white' stroke-width='1.5' stroke-linejoin='round'/%3e%3cdefs%3e%3clinearGradient id='a' x1='14' y1='-4' x2='14' y2='24' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2356A4FF'/%3e%3cstop offset='1' stop-color='%230256F9'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='18.8' y1='-1.333' x2='18.8' y2='8' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%2356A4FF'/%3e%3cstop offset='1' stop-color='%230256F9'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",aa="data:image/svg+xml;charset=utf8,%3csvg width='9' height='9' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M1 4.5A3.5 3.5 0 1 0 4.5 1' stroke='%233381FF' fill='none'/%3e%3c/svg%3e",ia="data:image/svg+xml;charset=utf8,%3csvg width='9' height='9' xmlns='http://www.w3.org/2000/svg'%3e%3cg transform='translate(1 1)' stroke='%23F45454' fill='none' fill-rule='evenodd'%3e%3ccircle cx='3.5' cy='3.5' r='3.5'/%3e%3cpath d='m1 6 5-5'/%3e%3c/g%3e%3c/svg%3e",sa="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M23 19a3 3 0 0 1-3 3H4a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3h2.757a3 3 0 0 1 2.122.879L10 4h10a3 3 0 0 1 3 3v12Z' fill='url(%23a)'/%3e%3cpath d='M3 7a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v1H3V7Z' fill='white'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M23 19a3 3 0 0 1-3 3H4a3 3 0 0 1-3-3V9a1 1 0 0 1 1-1h20a1 1 0 0 1 1 1v10Z' fill='url(%23b)'/%3e%3cdefs%3e%3clinearGradient id='a' x1='11.8' y1='1.333' x2='11.8' y2='22' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FFB81D'/%3e%3cstop offset='1' stop-color='%23EFA400'/%3e%3c/linearGradient%3e%3clinearGradient id='b' x1='11.8' y1='6.25' x2='11.8' y2='20.25' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23FFDA89'/%3e%3cstop offset='1' stop-color='%23F9AA00'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Ct="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m5 11 5 4 7-8' stroke='%237A7B7C' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e",kt="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m6.757 6.757 8.486 8.486m0-8.486-8.486 8.486' stroke='%237A7B7C' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e",St=a=>/\\|\//.test(a);var fe="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileTitle/CloudStorageFileTitleRename.tsx";const na=se.memo(function({fileUUID:e,fileName:r,fileResourceType:t,onRename:i}){const o=J(),n=w.exports.useRef(),[l,d]=oa(r,t),[u,m]=w.exports.useState(l),f=i&&(()=>i(e)),c=i&&(()=>{const h=u+d;!u||h===r?i(e):t===B.Directory?St(u)?dt.error(o("invalid-directory-name-tips")):i(e,{name:u,ext:d,fullName:h}):i(e,{name:u,ext:d,fullName:h})});return w.exports.useEffect(()=>{const h=n.current;h&&(h.focus(),h.select())},[]),s(H,{children:[s(ut,{ref:n,className:"cloud-storage-file-title-rename-input",size:"small",value:u,onChange:h=>m(h.currentTarget.value),onPressEnter:c},void 0,!1,{fileName:fe,lineNumber:57,columnNumber:21},this),s(R,{className:"cloud-storage-file-title-rename-btn",shape:"circle",size:"small",type:"text",onClick:c,children:s("img",{alt:"confirm",height:22,src:Ct,width:22},void 0,!1,{fileName:fe,lineNumber:72,columnNumber:25},this)},void 0,!1,{fileName:fe,lineNumber:65,columnNumber:21},this),s(R,{className:"cloud-storage-file-title-rename-btn",shape:"circle",size:"small",type:"text",onClick:f,children:s("img",{alt:"cancel",height:22,src:kt,width:22},void 0,!1,{fileName:fe,lineNumber:81,columnNumber:25},this)},void 0,!1,{fileName:fe,lineNumber:74,columnNumber:21},this)]},void 0,!0)});function oa(a,e){if(e===B.Directory)return[a,""];const r=a.lastIndexOf(".");return[a.substr(0,r),a.slice(r)]}var he="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileTitle/CloudStorageNewDirectory.tsx";const la=se.memo(function({parentDirectoryPath:e,onNewDirectory:r}){const t=J(),i=w.exports.useRef(),[o,n]=w.exports.useState(t("new-directory")),l=r&&(()=>r({directoryName:"",parentDirectoryPath:e})),d=r&&(()=>{St(o)?dt.error(t("invalid-directory-name-tips")):r({directoryName:o,parentDirectoryPath:e})});return w.exports.useEffect(()=>{const u=i.current;u&&(u.focus(),u.select())},[]),s(H,{children:[s(ut,{ref:i,className:"cloud-storage-file-title-rename-input",size:"small",value:o,onChange:u=>n(u.currentTarget.value),onPressEnter:d},void 0,!1,{fileName:he,lineNumber:42,columnNumber:17},this),s(R,{className:"cloud-storage-file-title-rename-btn",shape:"circle",size:"small",type:"text",onClick:d,children:s("img",{alt:"confirm",height:22,src:Ct,width:22},void 0,!1,{fileName:he,lineNumber:57,columnNumber:21},this)},void 0,!1,{fileName:he,lineNumber:50,columnNumber:17},this),s(R,{className:"cloud-storage-file-title-rename-btn",shape:"circle",size:"small",type:"text",onClick:l,children:s("img",{alt:"cancel",height:22,src:kt,width:22},void 0,!1,{fileName:he,lineNumber:66,columnNumber:21},this)},void 0,!1,{fileName:he,lineNumber:59,columnNumber:17},this)]},void 0,!0)});var q="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileTitle/index.tsx";const xt=se.memo(function({fileUUID:e,fileName:r,convertStatus:t,titleClickable:i=!1,onTitleClick:o,renamingFileUUID:n,onRename:l,onNewDirectoryFile:d,resourceType:u,parentDirectoryPath:m,...f}){const c=J(),h=t===P.Converting,v=!h&&t===P.Failed,C=w.exports.useMemo(()=>ca(r),[r]),g=mt(),N=b=>{const U=new URLSearchParams({path:b}).toString();g.push({search:U})};return s("span",{title:`${v?c("transcoding-failure"):h?c("transcoding-in-progress"):""}${r}`,...f,className:A(f.className,"cloud-storage-file-title",{"is-convert-ready":!h&&!v}),children:[s("span",{className:"cloud-storage-file-title-icon-wrap",children:[s("img",{"aria-hidden":!0,className:"cloud-storage-file-title-icon",height:22,src:C,width:22},void 0,!1,{fileName:q,lineNumber:81,columnNumber:21},this),h?s("img",{"aria-hidden":!0,className:"cloud-storage-file-title-converting",height:11,src:aa,width:11},void 0,!1,{fileName:q,lineNumber:89,columnNumber:25},this):v?s("img",{"aria-hidden":!0,className:"cloud-storage-file-title-convert-error",height:11,src:ia,width:11},void 0,!1,{fileName:q,lineNumber:97,columnNumber:25},this):null]},void 0,!0,{fileName:q,lineNumber:80,columnNumber:17},this),m&&u===B.Directory&&e==="temporaryDirectory"&&s(la,{parentDirectoryPath:m,onNewDirectory:d},void 0,!1,{fileName:q,lineNumber:109,columnNumber:25},this),n===e?s(na,{fileName:r,fileResourceType:u,fileUUID:e,onRename:l},void 0,!1,{fileName:q,lineNumber:115,columnNumber:21},this):i?s("a",{className:"cloud-storage-file-title-content",onClick:b=>{b.preventDefault(),o&&o(e,N)},children:r},void 0,!1,{fileName:q,lineNumber:122,columnNumber:21},this):s("span",{className:"cloud-storage-file-title-content",children:r},void 0,!1,{fileName:q,lineNumber:132,columnNumber:21},this)]},void 0,!0,{fileName:q,lineNumber:67,columnNumber:13},this)});function ca(a){switch((/\.[a-z1-9]+$/i.exec(a)||[""])[0].toLowerCase()){case".ppt":case".pptx":return ea;case".doc":case".docx":return ra;case".pdf":return Qr;case".jpg":case".png":case".gif":case".jpeg":case".svg":case".bmp":case".eps":return Jr;case".mp4":case".avi":case".mov":case".wmv":case".3gp":case".mkv":case".flv":case".f4v":case".rmvb":case".webm":return ta;case".aac":case".mp3":case".wave":case".wma":case".flac":return Xr;case"":return sa;default:return Kr}}var re="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileList/CloudStorageFileListFileName.tsx";const ua=se.memo(function({file:e,index:r,titleClickable:t,renamingFileUUID:i,parentDirectoryPath:o,getPopupContainer:n,fileMenus:l,onItemMenuClick:d,onItemTitleClick:u,onRename:m,onNewDirectoryFile:f}){var g,N;const c=l&&l(e,r),h=((g=e.meta.whiteboardConvert)==null?void 0:g.convertStep)||((N=e.meta.whiteboardProjector)==null?void 0:N.convertStep),v=mt(),C=b=>{const U=new URLSearchParams({path:b}).toString();v.push({search:U})};return s("div",{className:"cloud-storage-file-list-filename-container",children:[s(xt,{convertStatus:h,fileName:e.fileName,fileUUID:e.fileUUID,parentDirectoryPath:o,renamingFileUUID:i,resourceType:e.resourceType,titleClickable:t,onNewDirectoryFile:f,onRename:m,onTitleClick:u},void 0,!1,{fileName:re,lineNumber:67,columnNumber:21},this),c&&c.length>0&&s("div",{className:"cloud-storage-file-list-menu-btn-wrap",children:s(Ce,{className:"cloud-storage-file-list-menu-btn",getPopupContainer:n,overlay:s(ke,{items:c.map(b=>({key:b.key,className:b.className,label:b.name})),onClick:({key:b})=>d==null?void 0:d(e.fileUUID,b,C)},void 0,!1,{fileName:re,lineNumber:85,columnNumber:37},this),overlayClassName:"cloud-storage-file-list-menu",children:s(R,{children:s("img",{"aria-hidden":!0,height:22,src:Yr,width:22},void 0,!1,{fileName:re,lineNumber:99,columnNumber:37},this)},void 0,!1,{fileName:re,lineNumber:98,columnNumber:33},this)},void 0,!1,{fileName:re,lineNumber:81,columnNumber:29},this)},void 0,!1,{fileName:re,lineNumber:80,columnNumber:25},this)]},void 0,!0,{fileName:re,lineNumber:66,columnNumber:17},this)});var _="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageFileList/index.tsx";const da=({files:a,selectedFileUUIDs:e,onSelectionChange:r,fileMenus:t,onItemMenuClick:i,titleClickable:o=!1,onItemTitleClick:n,renamingFileUUID:l,isLoadingData:d,onRename:u,onNewDirectoryFile:m,parentDirectoryPath:f})=>{const c=J(),h=w.exports.useRef(null),v=w.exports.useCallback(()=>h.current||document.body,[]),C=w.exports.useMemo(()=>[{title:s("span",{className:"cloud-storage-file-list-title-span",children:[s("span",{className:"cloud-storage-file-list-title",children:c("file-name")},void 0,!1,{fileName:_,lineNumber:65,columnNumber:25},void 0),s(qr,{getPopupContainer:v,placement:"right",title:c("supported-file-types")},void 0,!1,{fileName:_,lineNumber:66,columnNumber:25},void 0)]},void 0,!0,{fileName:_,lineNumber:64,columnNumber:21},void 0),dataIndex:"fileName",ellipsis:!0,render:function(N,b,U){return s(ua,{file:b,fileMenus:t,getPopupContainer:v,index:U,parentDirectoryPath:f,renamingFileUUID:l,titleClickable:o,onItemMenuClick:i,onItemTitleClick:n,onNewDirectoryFile:m,onRename:u},void 0,!1,{fileName:_,lineNumber:77,columnNumber:25},this)}},{title:s("span",{className:"cloud-storage-file-list-title",children:c("file-size")},void 0,!1,{fileName:_,lineNumber:94,columnNumber:24},void 0),dataIndex:"fileSize",ellipsis:!0,width:100,sorter:(g,N)=>g.fileSize-N.fileSize,showSorterTooltip:!1,render:function(N){const b=wt(N);return s("span",{title:b,children:N===0?"-":b},void 0,!1,{fileName:_,lineNumber:103,columnNumber:25},this)}},{title:s("span",{className:"cloud-storage-file-list-title",children:c("edit-date")},void 0,!1,{fileName:_,lineNumber:108,columnNumber:24},void 0),dataIndex:"createAt",ellipsis:!0,width:170,sorter:(g,N)=>g.createAt.valueOf()-N.createAt.valueOf(),sortDirections:["ascend","descend","ascend"],showSorterTooltip:!1,render:function(N){const b=Qt(N,"yyyy/MM/dd HH:mm");return s("span",{title:b,children:b},void 0,!1,{fileName:_,lineNumber:117,columnNumber:28},this)}}],[c,v,t,f,l,o,i,n,m,u]);return s("div",{ref:h,className:"cloud-storage-file-list-table",children:[s(mr,{columns:C,dataSource:a||[],locale:{emptyText:" "},pagination:!1,rowKey:"fileUUID",rowSelection:{selectedRowKeys:e,onChange:r},size:"small"},void 0,!1,{fileName:_,lineNumber:137,columnNumber:13},void 0),d&&s("div",{className:"cloud-storage-pull-up-loading",children:s(Lr,{},void 0,!1,{fileName:_,lineNumber:153,columnNumber:21},void 0)},void 0,!1,{fileName:_,lineNumber:152,columnNumber:17},void 0),a.length<=0&&s("div",{className:"cloud-storage-file-list-empty",children:s("div",{className:"cloud-storage-file-list-empty-content",children:[s("img",{height:124,src:Gr,width:124},void 0,!1,{fileName:_,lineNumber:159,columnNumber:25},void 0),s("div",{className:"cloud-storage-file-list-empty-text",children:c("no-data")},void 0,!1,{fileName:_,lineNumber:160,columnNumber:25},void 0)]},void 0,!0,{fileName:_,lineNumber:158,columnNumber:21},void 0)},void 0,!1,{fileName:_,lineNumber:157,columnNumber:17},void 0)]},void 0,!0,{fileName:_,lineNumber:136,columnNumber:9},void 0)},ma="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m5 11 5 4 7-8' stroke='%237EC452' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e",tt="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M15 9v6a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V9h0m1-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2h0M6 7h10m-3.5 3v4m-3-4v4' stroke='%237A7B7C' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e",fa="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='%23444E60' d='M16.328 4.879v2.828H13.5z'/%3e%3cpath d='M15.526 7.061A6 6 0 1 0 17 11' stroke='%23444E60' stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e";var j="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageUploadItem/index.tsx";const ha=({uploadID:a,fileName:e,percent:r,status:t,onRetry:i,onCancel:o})=>{const n=J();return s("div",{className:"cloud-storage-upload-item",children:[s(xt,{fileName:e,fileUUID:a},void 0,!1,{fileName:j,lineNumber:36,columnNumber:13},void 0),l(),s("div",{className:A("cloud-storage-upload-item-progress-bar",{"is-error":t==="error"}),style:{width:`${r}%`}},void 0,!1,{fileName:j,lineNumber:38,columnNumber:13},void 0)]},void 0,!0,{fileName:j,lineNumber:35,columnNumber:9},void 0);function l(){switch(t){case"uploading":return s(H,{children:[s("span",{className:"cloud-storage-upload-status",children:`${r}%`},void 0,!1,{fileName:j,lineNumber:52,columnNumber:25},this),s(R,{className:"cloud-storage-upload-status-btn",shape:"circle",size:"small",onClick:()=>o(a),children:s("img",{"aria-hidden":!0,height:22,src:tt,width:22},void 0,!1,{fileName:j,lineNumber:59,columnNumber:29},this)},void 0,!1,{fileName:j,lineNumber:53,columnNumber:25},this)]},void 0,!0);case"error":return s(H,{children:[s("span",{className:"cloud-storage-upload-status is-error",children:n("upload-fail")},void 0,!1,{fileName:j,lineNumber:67,columnNumber:25},this),s(R,{className:"cloud-storage-upload-status-btn",shape:"circle",size:"small",onClick:()=>i(a),children:s("img",{"aria-hidden":!0,height:22,src:fa,width:22},void 0,!1,{fileName:j,lineNumber:76,columnNumber:29},this)},void 0,!1,{fileName:j,lineNumber:70,columnNumber:25},this)]},void 0,!0);case"success":return s(H,{children:[s("span",{className:"cloud-storage-upload-status is-success",children:n("upload-success")},void 0,!1,{fileName:j,lineNumber:84,columnNumber:25},this),s("div",{className:"cloud-storage-upload-status-btn",children:s("img",{"aria-hidden":!0,height:22,src:ma,width:22},void 0,!1,{fileName:j,lineNumber:88,columnNumber:29},this)},void 0,!1,{fileName:j,lineNumber:87,columnNumber:25},this)]},void 0,!0);default:return s(H,{children:[s("span",{className:"cloud-storage-upload-status",children:n("pending-upload")},void 0,!1,{fileName:j,lineNumber:96,columnNumber:25},this),s(R,{className:"cloud-storage-upload-status-btn",shape:"circle",size:"small",onClick:()=>o(a),children:s("img",{"aria-hidden":!0,height:22,src:tt,width:22},void 0,!1,{fileName:j,lineNumber:103,columnNumber:29},this)},void 0,!1,{fileName:j,lineNumber:97,columnNumber:25},this)]},void 0,!0)}}},pa="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m5 8 6 6 6-6' stroke='%237A7B7C' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e",ga="data:image/svg+xml;charset=utf8,%3csvg width='22' height='22' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m6.757 6.757 8.486 8.486m0-8.486-8.486 8.486' stroke='%237A7B7C' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e";var _e=function(a,e){return _e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])},_e(a,e)};function va(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");_e(a,e);function r(){this.constructor=a}a.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ie=function(){return Ie=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Ie.apply(this,arguments)};function Na(a,e){var r={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&e.indexOf(t)<0&&(r[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(a);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(a,t[i])&&(r[t[i]]=a[t[i]]);return r}var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ba(a){var e=typeof a;return a!=null&&(e=="object"||e=="function")}var $e=ba,ya=typeof ye=="object"&&ye&&ye.Object===Object&&ye,wa=ya,Ca=wa,ka=typeof self=="object"&&self&&self.Object===Object&&self,Sa=Ca||ka||Function("return this")(),Ut=Sa,xa=Ut,Ua=function(){return xa.Date.now()},Fa=Ua,Ta=/\s/;function Pa(a){for(var e=a.length;e--&&Ta.test(a.charAt(e)););return e}var Da=Pa,Ma=Da,Oa=/^\s+/;function _a(a){return a&&a.slice(0,Ma(a)+1).replace(Oa,"")}var Ia=_a,ja=Ut,Ea=ja.Symbol,Ft=Ea,rt=Ft,Tt=Object.prototype,Ra=Tt.hasOwnProperty,Aa=Tt.toString,pe=rt?rt.toStringTag:void 0;function $a(a){var e=Ra.call(a,pe),r=a[pe];try{a[pe]=void 0;var t=!0}catch{}var i=Aa.call(a);return t&&(e?a[pe]=r:delete a[pe]),i}var za=$a,Ba=Object.prototype,La=Ba.toString;function Ga(a){return La.call(a)}var Va=Ga,at=Ft,Ha=za,Za=Va,Wa="[object Null]",qa="[object Undefined]",it=at?at.toStringTag:void 0;function Ya(a){return a==null?a===void 0?qa:Wa:it&&it in Object(a)?Ha(a):Za(a)}var Ka=Ya;function Xa(a){return a!=null&&typeof a=="object"}var Ja=Xa,Qa=Ka,ei=Ja,ti="[object Symbol]";function ri(a){return typeof a=="symbol"||ei(a)&&Qa(a)==ti}var ai=ri,ii=Ia,st=$e,si=ai,nt=0/0,ni=/^[-+]0x[0-9a-f]+$/i,oi=/^0b[01]+$/i,li=/^0o[0-7]+$/i,ci=parseInt;function ui(a){if(typeof a=="number")return a;if(si(a))return nt;if(st(a)){var e=typeof a.valueOf=="function"?a.valueOf():a;a=st(e)?e+"":e}if(typeof a!="string")return a===0?a:+a;a=ii(a);var r=oi.test(a);return r||li.test(a)?ci(a.slice(2),r?2:8):ni.test(a)?nt:+a}var di=ui,mi=$e,De=Fa,ot=di,fi="Expected a function",hi=Math.max,pi=Math.min;function gi(a,e,r){var t,i,o,n,l,d,u=0,m=!1,f=!1,c=!0;if(typeof a!="function")throw new TypeError(fi);e=ot(e)||0,mi(r)&&(m=!!r.leading,f="maxWait"in r,o=f?hi(ot(r.maxWait)||0,e):o,c="trailing"in r?!!r.trailing:c);function h(y){var T=t,S=i;return t=i=void 0,u=y,n=a.apply(S,T),n}function v(y){return u=y,l=setTimeout(N,e),m?h(y):n}function C(y){var T=y-d,S=y-u,I=e-T;return f?pi(I,o-S):I}function g(y){var T=y-d,S=y-u;return d===void 0||T>=e||T<0||f&&S>=o}function N(){var y=De();if(g(y))return b(y);l=setTimeout(N,C(y))}function b(y){return l=void 0,c&&t?h(y):(t=i=void 0,n)}function U(){l!==void 0&&clearTimeout(l),u=0,t=d=i=l=void 0}function D(){return l===void 0?n:b(De())}function k(){var y=De(),T=g(y);if(t=arguments,i=this,d=y,T){if(l===void 0)return v(d);if(f)return clearTimeout(l),l=setTimeout(N,e),h(d)}return l===void 0&&(l=setTimeout(N,e)),n}return k.cancel=U,k.flush=D,k}var Pt=gi,vi=Pt,Ni=$e,bi="Expected a function";function yi(a,e,r){var t=!0,i=!0;if(typeof a!="function")throw new TypeError(bi);return Ni(r)&&(t="leading"in r?!!r.leading:t,i="trailing"in r?!!r.trailing:i),vi(a,e,{leading:t,maxWait:e,trailing:i})}var wi=yi,Dt=function(a,e,r,t){switch(e){case"debounce":return Pt(a,r,t);case"throttle":return wi(a,r,t);default:return a}},je=function(a){return typeof a=="function"},X=function(){return typeof window>"u"},lt=function(a){return a instanceof Element||a instanceof HTMLDocument},Mt=function(a,e,r,t){return function(i){var o=i.width,n=i.height;e(function(l){return l.width===o&&l.height===n||l.width===o&&!t||l.height===n&&!r?l:(a&&je(a)&&a(o,n),{width:o,height:n})})}};(function(a){va(e,a);function e(r){var t=a.call(this,r)||this;t.cancelHandler=function(){t.resizeHandler&&t.resizeHandler.cancel&&(t.resizeHandler.cancel(),t.resizeHandler=null)},t.attachObserver=function(){var u=t.props,m=u.targetRef,f=u.observerOptions;if(!X()){m&&m.current&&(t.targetRef.current=m.current);var c=t.getElement();!c||t.observableElement&&t.observableElement===c||(t.observableElement=c,t.resizeObserver.observe(c,f))}},t.getElement=function(){var u=t.props,m=u.querySelector,f=u.targetDomEl;if(X())return null;if(m)return document.querySelector(m);if(f&&lt(f))return f;if(t.targetRef&&lt(t.targetRef.current))return t.targetRef.current;var c=er.exports.findDOMNode(t);if(!c)return null;var h=t.getRenderType();switch(h){case"renderProp":return c;case"childFunction":return c;case"child":return c;case"childArray":return c;default:return c.parentElement}},t.createResizeHandler=function(u){var m=t.props,f=m.handleWidth,c=f===void 0?!0:f,h=m.handleHeight,v=h===void 0?!0:h,C=m.onResize;if(!(!c&&!v)){var g=Mt(C,t.setState.bind(t),c,v);u.forEach(function(N){var b=N&&N.contentRect||{},U=b.width,D=b.height,k=!t.skipOnMount&&!X();k&&g({width:U,height:D}),t.skipOnMount=!1})}},t.getRenderType=function(){var u=t.props,m=u.render,f=u.children;return je(m)?"renderProp":je(f)?"childFunction":w.exports.isValidElement(f)?"child":Array.isArray(f)?"childArray":"parent"};var i=r.skipOnMount,o=r.refreshMode,n=r.refreshRate,l=n===void 0?1e3:n,d=r.refreshOptions;return t.state={width:void 0,height:void 0},t.skipOnMount=i,t.targetRef=w.exports.createRef(),t.observableElement=null,X()||(t.resizeHandler=Dt(t.createResizeHandler,o,l,d),t.resizeObserver=new window.ResizeObserver(t.resizeHandler)),t}return e.prototype.componentDidMount=function(){this.attachObserver()},e.prototype.componentDidUpdate=function(){this.attachObserver()},e.prototype.componentWillUnmount=function(){X()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},e.prototype.render=function(){var r=this.props,t=r.render,i=r.children,o=r.nodeType,n=o===void 0?"div":o,l=this.state,d=l.width,u=l.height,m={width:d,height:u,targetRef:this.targetRef},f=this.getRenderType(),c;switch(f){case"renderProp":return t&&t(m);case"childFunction":return c=i,c(m);case"child":if(c=i,c.type&&typeof c.type=="string"){m.targetRef;var h=Na(m,["targetRef"]);return w.exports.cloneElement(c,h)}return w.exports.cloneElement(c,m);case"childArray":return c=i,c.map(function(v){return!!v&&w.exports.cloneElement(v,m)});default:return w.exports.createElement(n,null)}},e})(w.exports.PureComponent);var Ci=X()?w.exports.useEffect:w.exports.useLayoutEffect;function ki(a){a===void 0&&(a={});var e=a.skipOnMount,r=e===void 0?!1:e,t=a.refreshMode,i=a.refreshRate,o=i===void 0?1e3:i,n=a.refreshOptions,l=a.handleWidth,d=l===void 0?!0:l,u=a.handleHeight,m=u===void 0?!0:u,f=a.targetRef,c=a.observerOptions,h=a.onResize,v=w.exports.useRef(r),C=w.exports.useRef(null),g=f!=null?f:C,N=w.exports.useRef(),b=w.exports.useState({width:void 0,height:void 0}),U=b[0],D=b[1];return Ci(function(){if(!X()){var k=Mt(h,D,d,m),y=function(S){!d&&!m||S.forEach(function(I){var Y=I&&I.contentRect||{},Z=Y.width,Q=Y.height,$=!v.current&&!X();$&&k({width:Z,height:Q}),v.current=!1})};N.current=Dt(y,t,o,n);var T=new window.ResizeObserver(N.current);return g.current&&T.observe(g.current,c),function(){T.disconnect();var S=N.current;S&&S.cancel&&S.cancel()}}},[t,o,n,d,m,h,c,g.current]),Ie({ref:g},U)}var ge="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageUploadTitle/index.tsx";const Si=se.memo(function({finishWithError:e,finished:r,total:t}){const i=J(),o=r&&t?r/t*100:0,n=o>=100;return s("div",{className:"cloud-storage-upload-title",children:[e?s(tr,{className:"cloud-storage-upload-title-error"},void 0,!1,{fileName:ge,lineNumber:23,columnNumber:21},this):s(Br,{percent:o,showInfo:n,strokeWidth:n?8:10,type:"circle",width:20},void 0,!1,{fileName:ge,lineNumber:25,columnNumber:21},this),s("h1",{className:"cloud-storage-upload-title-content",children:i(e?"upload-exception":n?"upload-completed":"transfer-list")},void 0,!1,{fileName:ge,lineNumber:33,columnNumber:17},this),!n&&!e&&t&&!Number.isNaN(r)&&s("span",{className:"cloud-storage-upload-title-count",children:[r,"/",t]},void 0,!0,{fileName:ge,lineNumber:41,columnNumber:21},this)]},void 0,!0,{fileName:ge,lineNumber:21,columnNumber:13},this)});var z="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageUploadPanel/index.tsx";const xi=({maxHeight:a=260,finishWithError:e,compact:r,expand:t,finished:i,total:o,className:n,children:l,onExpandChange:d,onClose:u,...m})=>{const{height:f=0,width:c,ref:h}=ki();return s("section",{...m,className:A(n,"cloud-storage-upload-panel",{"is-panel-compact":r,"is-panel-fold":!t}),children:[s("header",{className:"cloud-storage-upload-panel-head",onClickCapture:v=>{r&&d&&(d(!t),v.stopPropagation())},children:[s(Si,{finishWithError:e,finished:i,total:o},void 0,!1,{fileName:z,lineNumber:63,columnNumber:17},void 0),s("div",{className:"cloud-storage-upload-panel-head-btns",children:[s(R,{className:"cloud-storage-upload-panel-expand-btn",shape:"circle",size:"small",onClick:()=>d&&d(!t),children:s("img",{height:22,src:pa,width:22},void 0,!1,{fileName:z,lineNumber:75,columnNumber:25},void 0)},void 0,!1,{fileName:z,lineNumber:69,columnNumber:21},void 0),!r&&s(R,{shape:"circle",size:"small",onClick:u,children:s("img",{height:22,src:ga,width:22},void 0,!1,{fileName:z,lineNumber:79,columnNumber:29},void 0)},void 0,!1,{fileName:z,lineNumber:78,columnNumber:25},void 0)]},void 0,!0,{fileName:z,lineNumber:68,columnNumber:17},void 0)]},void 0,!0,{fileName:z,lineNumber:54,columnNumber:13},void 0),s("div",{className:"cloud-storage-upload-panel-content fancy-scrollbar",style:{width:r&&!t?200:c,height:t?f<a?f:a:0},children:s("div",{ref:h,className:"cloud-storage-upload-panel-content-sizer",children:s("div",{className:"cloud-storage-upload-panel-status-list",children:l},void 0,!1,{fileName:z,lineNumber:92,columnNumber:21},void 0)},void 0,!1,{fileName:z,lineNumber:91,columnNumber:17},void 0)},void 0,!1,{fileName:z,lineNumber:84,columnNumber:13},void 0)]},void 0,!0,{fileName:z,lineNumber:47,columnNumber:9},void 0)};var V="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageSkeletons/index.tsx";const Ui=({isCompactMode:a})=>s("div",{className:"cloud-storage-skeletons",children:Array(10).fill(0).map((e,r)=>s("div",{className:"cloud-storage-skeletons-item",children:[s("div",{className:"cloud-storage-skeletons-item-icon",children:s(Ne,{active:!0,paragraph:{rows:1,width:"100%"},title:!1},void 0,!1,{fileName:V,lineNumber:19,columnNumber:29},void 0)},void 0,!1,{fileName:V,lineNumber:18,columnNumber:25},void 0),s("div",{className:A("cloud-storage-skeletons-item-file",{"cloud-storage-skeletons-item-file-compact":a}),children:s(Ne,{active:!0,paragraph:{rows:1,width:"100%"},title:!1},void 0,!1,{fileName:V,lineNumber:26,columnNumber:29},void 0)},void 0,!1,{fileName:V,lineNumber:21,columnNumber:25},void 0),s("div",{className:"cloud-storage-skeletons-item-file-size",children:s(Ne,{active:!0,paragraph:{rows:1,width:"100%"},title:!1},void 0,!1,{fileName:V,lineNumber:29,columnNumber:29},void 0)},void 0,!1,{fileName:V,lineNumber:28,columnNumber:25},void 0),s("div",{className:"cloud-storage-skeletons-item-file-date",children:s(Ne,{active:!0,paragraph:{rows:1,width:"100%"},title:!1},void 0,!1,{fileName:V,lineNumber:32,columnNumber:29},void 0)},void 0,!1,{fileName:V,lineNumber:31,columnNumber:25},void 0)]},r,!0,{fileName:V,lineNumber:17,columnNumber:21},void 0))},void 0,!1,{fileName:V,lineNumber:13,columnNumber:9},void 0),Fi="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M16.375 9v8h1.25V9h-1.25ZM15 18.375H9v1.25h6v-1.25ZM7.625 17V9h-1.25v8h1.25ZM9 18.375c-.76 0-1.375-.616-1.375-1.375h-1.25A2.625 2.625 0 0 0 9 19.625v-1.25ZM16.375 17c0 .76-.616 1.375-1.375 1.375v1.25A2.625 2.625 0 0 0 17.625 17h-1.25ZM11 5.625h2v-1.25h-2v1.25Zm2 0c.76 0 1.375.616 1.375 1.375h1.25A2.625 2.625 0 0 0 13 4.375v1.25ZM9.625 7c0-.76.616-1.375 1.375-1.375v-1.25A2.625 2.625 0 0 0 8.375 7h1.25Z' fill='%23D21F00'/%3e%3cpath d='M4 7h16' stroke='%23D21F00' stroke-width='1.25' stroke-linejoin='round'/%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3c/svg%3e",Ti="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath opacity='.01' fill='white' d='M0 0h24v24H0z'/%3e%3cpath d='m11 7-.442.442a.625.625 0 0 0 .442.183V7ZM4.625 17V7h-1.25v10h1.25ZM6 5.625h2.172v-1.25H6v1.25Zm3.144.403 1.414 1.414.884-.884-1.414-1.414-.884.884ZM11 7.625h7v-1.25h-7v1.25ZM19.375 9v4h1.25V9h-1.25ZM14 18.375H6v1.25h8v-1.25Zm4-10.75c.76 0 1.375.616 1.375 1.375h1.25A2.625 2.625 0 0 0 18 6.375v1.25Zm-9.828-2c.364 0 .714.145.972.403l.884-.884a2.625 2.625 0 0 0-1.856-.769v1.25ZM4.625 7c0-.76.616-1.375 1.375-1.375v-1.25A2.625 2.625 0 0 0 3.375 7h1.25Zm-1.25 10A2.625 2.625 0 0 0 6 19.625v-1.25c-.76 0-1.375-.616-1.375-1.375h-1.25Z' fill='%235D6066'/%3e%3cpath d='M4 10h16' stroke='%235D6066' stroke-width='1.25'/%3e%3cpath d='M17 13v6' stroke='%235D6066' stroke-width='1.25' stroke-linejoin='round'/%3e%3cpath d='M20 16h-6' stroke='%235D6066' stroke-width='1.25'/%3e%3c/svg%3e";var Pi="/Users/yl/github-repo/openflat/packages/flat-components/src/containers/CloudStorageContainer/CloudStorageUploadItemContainer.tsx";const Di=Ue(function({task:e,onCancel:r,onRetry:t}){return s(ha,{fileName:e.fileName,percent:e.percent,status:e.status,uploadID:e.uploadID,onCancel:r,onRetry:t},void 0,!1,{fileName:Pi,lineNumber:15,columnNumber:17},this)});var Mi="/Users/yl/github-repo/openflat/packages/flat-components/src/containers/CloudStorageContainer/CloudStorageUploadListContainer.tsx";const Oi=Ue(function({tasks:e,onCancel:r,onRetry:t}){return s(H,{children:e.map(i=>s(Di,{task:i,onCancel:r,onRetry:t},i.uploadID,!1,{fileName:Mi,lineNumber:19,columnNumber:25},this))},void 0,!1)});var _i="/Users/yl/github-repo/openflat/packages/flat-components/src/containers/CloudStorageContainer/CloudStorageFileListContainer.tsx";const Ii=Ue(function({store:e,isLoadingData:r}){return s(da,{titleClickable:!0,fileMenus:e.fileMenus,files:Ge(e.files),isLoadingData:r,parentDirectoryPath:e.parentDirectoryPath,renamingFileUUID:e.renamingFileUUID,selectedFileUUIDs:Ge(e.selectedFileUUIDs),onItemMenuClick:e.onItemMenuClick,onItemTitleClick:e.onItemTitleClick,onNewDirectoryFile:e.onNewDirectoryFile,onRename:e.onRename,onSelectionChange:e.onSelectionChange},void 0,!1,{fileName:_i,lineNumber:16,columnNumber:17},this)}),ji="data:image/svg+xml;charset=utf8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='white' fill-opacity='.01' d='M0 0h24v24H0z'/%3e%3cpath d='m9 6 3 3 3 3-3 3-3 3' stroke='%23B7BBC1' stroke-width='1.25' stroke-linejoin='round'/%3e%3c/svg%3e";var E="/Users/yl/github-repo/openflat/packages/flat-components/src/components/CloudStorage/CloudStorageNavigation/index.tsx";const Ei=se.memo(function({path:e,pushHistory:r}){const t=J(),i=w.exports.useMemo(()=>e.split("/").filter(Boolean),[e]),o=5;return s("div",{className:"cloud-storage-navigation-container",children:s(le,{separator:s("img",{src:ji},void 0,!1,{fileName:E,lineNumber:23,columnNumber:40},this),children:i.length>=o?s(H,{children:[s(le.Item,{children:s("a",{onClick:()=>r("/"),children:t("my-cloud")},void 0,!1,{fileName:E,lineNumber:27,columnNumber:33},this)},void 0,!1,{fileName:E,lineNumber:26,columnNumber:29},this),s(le.Item,{children:s("span",{className:"cloud-storage-navigation-more-path",children:"..."},void 0,!1,{fileName:E,lineNumber:30,columnNumber:33},this)},void 0,!1,{fileName:E,lineNumber:29,columnNumber:29},this),i.map((n,l)=>{const d="/"+i.slice(0,l+1).join("/")+"/";return i.slice(-3).some(u=>n===u)?s(le.Item,{children:s("a",{onClick:()=>r(d),children:n},void 0,!1,{fileName:E,lineNumber:39,columnNumber:45},this)},l,!1,{fileName:E,lineNumber:38,columnNumber:41},this):null})]},void 0,!0):s(H,{children:[s(le.Item,{children:s("a",{onClick:()=>r("/"),children:t("my-cloud")},void 0,!1,{fileName:E,lineNumber:49,columnNumber:33},this)},void 0,!1,{fileName:E,lineNumber:48,columnNumber:29},this),i.map((n,l)=>{const d="/"+i.slice(0,l+1).join("/")+"/";return s(le.Item,{children:s("a",{onClick:()=>r(d),children:n},void 0,!1,{fileName:E,lineNumber:56,columnNumber:41},this)},l,!1,{fileName:E,lineNumber:55,columnNumber:37},this)})]},void 0,!0)},void 0,!1,{fileName:E,lineNumber:23,columnNumber:17},this)},void 0,!1,{fileName:E,lineNumber:22,columnNumber:13},this)});class Ri{constructor(){p(this,"compact",!1);p(this,"totalUsage",NaN);p(this,"selectedFileUUIDs",F.array());p(this,"isUploadPanelExpand",!1);p(this,"renamingFileUUID","");p(this,"cloudStorageSinglePageFiles",50);p(this,"isFetchingFiles",!1);p(this,"parentDirectoryPath",new URLSearchParams(window.location.search).get("path")||"/");p(this,"setRenamePanel",e=>{this.renamingFileUUID=e});p(this,"setCurrentDirectoryPath",e=>{this.parentDirectoryPath=this.parentDirectoryPath+e+"/"});p(this,"setParentDirectoryPath",e=>{this.parentDirectoryPath=e});p(this,"setPanelExpand",e=>{this.isUploadPanelExpand=e});p(this,"setCompact",e=>{this.compact=e});p(this,"onSelectionChange",e=>{this.selectedFileUUIDs.replace(e)});p(this,"onRename",(e,r)=>{this.renamingFileUUID="",r&&this.onNewFileName(e,r)});ft(this,{compact:F,totalUsage:F,selectedFileUUIDs:F,isUploadPanelExpand:F,renamingFileUUID:F,isFetchingFiles:F,parentDirectoryPath:F,isUploadPanelVisible:L,totalUsageHR:L,sortedUploadTasks:L,uploadFinishWithError:L,uploadFinishedCount:L,uploadTotalCount:L,setRenamePanel:O,setCurrentDirectoryPath:O,setParentDirectoryPath:O,setPanelExpand:O,setCompact:O,onSelectionChange:O,onRename:O})}get isUploadPanelVisible(){return this.uploadTotalCount>0}get totalUsageHR(){return Number.isNaN(this.totalUsage)?"":wt(this.totalUsage,{binary:!0})}get cloudStorageDataPagination(){return Math.ceil(this.files.length/this.cloudStorageSinglePageFiles)}get sortedUploadTasks(){return F.array([...this.uploadingUploadTasks,...this.failedUploadTasks,...this.pendingUploadTasks,...this.successUploadTasks])}get uploadFinishWithError(){return this.pendingUploadTasks.length>0||this.uploadingUploadTasks.length>0?!1:this.failedUploadTasks.length>0}get uploadFinishedCount(){return this.successUploadTasks.length}get uploadTotalCount(){return this.sortedUploadTasks.length}}var x="/Users/yl/github-repo/openflat/packages/flat-components/src/containers/CloudStorageContainer/index.tsx";const Ai=[".ppt",".pptx",".doc",".docx",".pdf",".png",".jpg",".jpeg",".gif",".mp3",".mp4"],$i=a=>Ai.some(e=>a.name.endsWith(e)),Ot=a=>Array.from(a).every(e=>$i(e)),zi=a=>{a.preventDefault(),Ot(a.dataTransfer.files)&&(a.dataTransfer.dropEffect="copy")},es=Ue(function({store:e,path:r,pushHistory:t}){const i=J(),o=w.exports.useRef(null),[n,l]=w.exports.useState(!1),[d,u]=w.exports.useState(!1);w.exports.useEffect(()=>{const g=window.setTimeout(()=>l(!0),200);return()=>window.clearTimeout(g)},[]),w.exports.useEffect(()=>{d&&e.fetchMoreCloudStorageData(e.cloudStorageDataPagination+1,e.parentDirectoryPath)},[d,e]);const m=w.exports.useCallback(g=>{g.preventDefault(),Ot(g.dataTransfer.files)&&e.onDropFile(g.dataTransfer.files)},[e]),f=s(ke,{items:[{label:i("new-directory"),key:"new-directory",icon:s("img",{src:Ti},void 0,!1,{fileName:x,lineNumber:94,columnNumber:31},this),onClick:e.onNewEmptyDirectory}]},void 0,!1,{fileName:x,lineNumber:89,columnNumber:13},this),c=s(ke,{items:[{label:i("local-file"),key:"local-file",onClick:e.onUpload}]},void 0,!1,{fileName:x,lineNumber:102,columnNumber:13},this),h=g=>s("span",{className:A("cloud-storage-container-btn-arrow",{"cloud-storage-container-btn-arrow-primary":g}),children:[s("span",{},void 0,!1,{fileName:x,lineNumber:120,columnNumber:21},this),s("span",{},void 0,!1,{fileName:x,lineNumber:121,columnNumber:21},this)]},void 0,!0,{fileName:x,lineNumber:115,columnNumber:17},this),v=s("div",{className:"cloud-storage-container-btns",children:[e.selectedFileUUIDs.length>=1&&s("span",{onClick:e.onBatchDelete,children:s("img",{className:"cloud-storage-container-btn-delete",src:Fi},void 0,!1,{fileName:x,lineNumber:130,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:129,columnNumber:21},this),s(Ce,{overlay:f,placement:"bottomLeft",children:s(R,{className:"cloud-storage-container-dropdown-btn",children:[i("new"),h()]},void 0,!0,{fileName:x,lineNumber:134,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:133,columnNumber:17},this),s(Ce,{overlay:c,placement:"bottomLeft",children:s(R,{className:"cloud-storage-container-dropdown-btn",type:"primary",children:[i("upload"),h(!0)]},void 0,!0,{fileName:x,lineNumber:140,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:139,columnNumber:17},this)]},void 0,!0,{fileName:x,lineNumber:127,columnNumber:13},this),C=()=>{if(o.current){const g=o.current.scrollTop,N=o.current.clientHeight,U=o.current.scrollHeight-30;u(Math.ceil(g+N)>=U)}};return s("div",{className:"cloud-storage-container",onDragOver:zi,onDrop:m,children:[!e.compact&&s("div",{className:"cloud-storage-container-head",children:[s("div",{children:[s("h1",{className:"cloud-storage-container-title",children:i("my-cloud")},void 0,!1,{fileName:x,lineNumber:166,columnNumber:29},this),s("small",{className:A("cloud-storage-container-subtitle",{"is-hide":!e.totalUsage}),children:e.totalUsageHR?i("used-storage",{usage:e.totalUsageHR}):"-"},void 0,!1,{fileName:x,lineNumber:167,columnNumber:29},this)]},void 0,!0,{fileName:x,lineNumber:165,columnNumber:25},this),v]},void 0,!0,{fileName:x,lineNumber:164,columnNumber:21},this),s("div",{className:"cloud-storage-container-navigation-box",children:r!==null&&r!=="/"&&s(Ei,{path:r,pushHistory:t},void 0,!1,{fileName:x,lineNumber:182,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:180,columnNumber:17},this),s("div",{ref:o,className:"cloud-storage-container-file-list fancy-scrollbar",onScroll:C,children:e.totalUsageHR?s(Ii,{isLoadingData:e.isFetchingFiles,store:e},void 0,!1,{fileName:x,lineNumber:191,columnNumber:25},this):n?s(Ui,{isCompactMode:e.compact},void 0,!1,{fileName:x,lineNumber:196,columnNumber:25},this):null},void 0,!1,{fileName:x,lineNumber:185,columnNumber:17},this),s(fr,{mountOnEnter:!0,unmountOnExit:!0,classNames:"cloud-storage-container-mask",in:e.isUploadPanelVisible&&e.isUploadPanelExpand&&e.compact,timeout:400,children:s("div",{className:"cloud-storage-container-mask",onClick:g=>{g.target===g.currentTarget&&e.setPanelExpand(!1)}},void 0,!1,{fileName:x,lineNumber:206,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:199,columnNumber:17},this),e.isUploadPanelVisible&&s(xi,{className:"cloud-storage-container-upload-panel",compact:e.compact,expand:e.isUploadPanelExpand,finishWithError:e.uploadFinishWithError,finished:e.uploadFinishedCount,total:e.uploadTotalCount,onClose:e.onUploadPanelClose,onExpandChange:e.setPanelExpand,children:s(Oi,{tasks:e.sortedUploadTasks,onCancel:e.onUploadCancel,onRetry:e.onUploadRetry},void 0,!1,{fileName:x,lineNumber:226,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:216,columnNumber:21},this),e.compact&&s("div",{className:"cloud-storage-container-footer",children:v},void 0,!1,{fileName:x,lineNumber:234,columnNumber:21},this)]},void 0,!0,{fileName:x,lineNumber:162,columnNumber:13},this)}),Bi=a=>(/\.([^.]+)$/.exec(a)||["",""])[1].toLowerCase(),Li=a=>/\.pptx$/i.test(a);var ae=(a=>(a[a.Pending=1]="Pending",a[a.Starting=2]="Starting",a[a.Uploading=3]="Uploading",a[a.Success=4]="Success",a[a.Failed=5]="Failed",a[a.Cancelling=6]="Cancelling",a[a.Cancelled=7]="Cancelled",a))(ae||{});class Gi{constructor(e,r){p(this,"uploadID",rr());p(this,"status",1);p(this,"percent",0);p(this,"file");p(this,"fileUUID");p(this,"targetDirectoryPath");p(this,"_cancelTokenSource");this.file=e,this.targetDirectoryPath=r,ht(this,{file:F.ref,_cancelTokenSource:!1})}async upload(){if(this.getStatus()!==1)return;const e="LTAI5tAzWZLUQS3ueBFSoKjE",{name:r,size:t}=this.file;try{this.updateStatus(2);let i;try{i=await Ve({fileName:r,fileSize:t,targetDirectoryPath:this.targetDirectoryPath})}catch(c){if(ar(c)&&c.errorCode===ir.UploadConcurrentLimit)console.warn("[cloud-storage]: hit max concurrent upload count limit"),i=await Ve({fileName:r,fileSize:t,targetDirectoryPath:this.targetDirectoryPath});else throw c}const{ossFilePath:o,fileUUID:n,policy:l,ossDomain:d,signature:u}=i;if(this.getStatus()!==2)return;this.updateFileUUID(n);const m=new FormData,f=encodeURIComponent(r);m.append("key",o),m.append("name",r),m.append("policy",l),m.append("OSSAccessKeyId",e),m.append("success_action_status","200"),m.append("callback",""),m.append("signature",u),m.append("Content-Disposition",`attachment; filename="${f}"; filename*=UTF-8''${f}`),m.append("file",this.file),this._cancelTokenSource=Pe.CancelToken.source(),this.updateStatus(3),await Pe.post(d,m,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:c=>{this.updatePercent(Math.floor(100*c.loaded/c.total))},cancelToken:this._cancelTokenSource.token})}catch(i){i instanceof Pe.Cancel?this.updateStatus(7):(console.error(i),this.updateStatus(5),ue(i))}this._cancelTokenSource=void 0,this.getStatus()===3&&(await this.finish(),this.updateStatus(4))}async finish(){if(this.fileUUID)try{await sr({fileUUID:this.fileUUID,isWhiteboardProjector:Li(this.file.name)})}catch(e){console.error(e)}}cancelUploadProgress(){this._cancelTokenSource&&(this._cancelTokenSource.cancel(),this._cancelTokenSource=void 0)}async cancelUpload(){if(!(this.getStatus()===6||!this.fileUUID)){this.updateStatus(6);try{this.cancelUploadProgress()}catch(e){console.error(e)}this.updateStatus(7)}}updateFileUUID(e){this.fileUUID=e}updatePercent(e){this.percent=e}updateStatus(e){this.status=e}getStatus(){return this.status}}const ze=class{constructor(){p(this,"status",1);p(this,"uploadingMap",F.map());p(this,"pending",F.array());p(this,"success",F.array());p(this,"failed",F.array());ht(this)}get uploading(){return F.array([...this.uploadingMap.values()].reverse())}addTasks(e,r){for(const t of e){const i=new Gi(t,r);this.pending.unshift(i)}this.startUpload()}async startUpload(){if(this.getStatus()!==3){if(this.pending.length<=0){this.updateStatus(1);return}for(this.updateStatus(2);this.uploadingMap.size<ze.MaxUploadingCount;){if(this.getStatus()!==2)return;const e=this.popPendingTask();e&&(M(()=>{this.uploadingMap.set(e.uploadID,e)}),console.log(`[cloud storage]: UploadTaskManager uploads "${e.file.name}"`),e.upload().then(()=>this.finishUpload(e))),await new Promise(r=>setTimeout(r,200))}}}finishUpload(e){this.uploadingMap.delete(e.uploadID),e.status===ae.Success?this.success.unshift(e):e.status===ae.Failed&&this.failed.unshift(e),this.startUpload()}retry(e){const r=this.failed.findIndex(t=>t.uploadID===e);if(r>=0){const t=this.failed[r];this.failed.splice(r,1),this.addTasks([t.file],t.targetDirectoryPath)}}async cancel(e){const r=this.uploadingMap.get(e);r&&(await r.cancelUpload(),M(()=>{this.uploadingMap.delete(e)}))}async cancelAll(){if(this.getStatus()!==3){this.updateStatus(3);for(const e of this.uploadingMap.values())e.cancelUploadProgress();M(()=>{this.pending.clear(),this.success.clear(),this.failed.clear(),this.uploadingMap.clear()}),this.updateStatus(1)}}updateStatus(e){this.status=e}getStatus(){return this.status}popPendingTask(){return this.pending.pop()}};let we=ze;p(we,"MaxUploadingCount",3);let Me;function Vi(){return Me||(Me=new we),Me}class Hi{constructor(){p(this,"sideEffect",new nr);p(this,"tasks",new Map)}hasTask(e){return this.tasks.has(e)}async addTask(e,r=1500){const t=pt(e.resourceType,e.meta);if(t===null)return;const{convertStep:i}=t;if(i===P.Done||i===P.Failed||this.tasks.has(e.fileUUID))return;const o=Bi(e.fileName),n=await gt.getInstance().requestService(`file-convert:${o}`);if(!!n){if(i===P.None){const l=await n.startConvert(e);l&&(l.resourceType===B.WhiteboardProjector&&M(()=>{e.meta.whiteboardProjector&&(e.meta.whiteboardProjector.convertStep=P.Converting,e.meta.whiteboardProjector.taskUUID=l.taskUUID,e.meta.whiteboardProjector.taskToken=l.taskToken)}),l.resourceType===B.WhiteboardConvert&&M(()=>{e.meta.whiteboardConvert&&(e.meta.whiteboardConvert.convertStep=P.Converting,e.meta.whiteboardConvert.taskUUID=l.taskUUID,e.meta.whiteboardConvert.taskToken=l.taskToken)}))}this.tasks.set(e.fileUUID,e),this.sideEffect.setInterval(async()=>{const l=await n.queryStatus(e);if(l.status===P.Done||l.status===P.Failed){try{await or({fileUUID:e.fileUUID})}catch(d){console.error(d)}M(()=>{e.meta.whiteboardConvert&&(e.meta.whiteboardConvert.convertStep=l.status),e.meta.whiteboardProjector&&(e.meta.whiteboardProjector.convertStep=l.status)}),l.error&&ue(l.error),this.cancelTask(e.fileUUID)}},r,e.fileUUID)}}cancelTask(e){this.sideEffect.flush(e),this.tasks.delete(e)}cancelAllTasks(){this.sideEffect.flushAll(),this.tasks.clear()}}class Zi{constructor(e,r){p(this,"running",!1);p(this,"timer",0);p(this,"invoke",async()=>{window.clearTimeout(this.timer),await this.task(),this.running&&(this.timer=window.setTimeout(this.invoke,this.interval))});this.task=e,this.interval=r}start(){this.running=!0,this.invoke()}stop(){this.running=!1,window.clearTimeout(this.timer)}}class _t extends Ri{constructor({compact:r,insertCourseware:t}){super();p(this,"uploadTaskManager",Vi());p(this,"filesMap",F.map());p(this,"insertCourseware");p(this,"onCoursewareInserted");p(this,"hasMoreFile",!0);p(this,"isOpenDirectoryFile",!1);p(this,"convertStatusManager",new Hi);p(this,"scheduler");p(this,"fileMenus",r=>{var i,o;const t=[{key:"open",name:G.t("open")}];return(((i=r.meta.whiteboardConvert)==null?void 0:i.convertStep)!==P.Failed||((o=r.meta.whiteboardProjector)==null?void 0:o.convertStep)!==P.Failed)&&t.push({key:"rename",name:G.t("rename")}),r.resourceType!==B.Directory&&t.push({key:"download",name:G.t("download")}),t.push({key:"delete",className:"danger",name:G.t("delete")}),t});p(this,"onParentDirectoryPathClick",r=>{this.setParentDirectoryPath(r),this.isOpenDirectoryFile=!0,this.scheduler.invoke()});p(this,"onItemMenuClick",(r,t,i)=>{switch(t){case"open":{this.onItemTitleClick(r,i);break}case"download":{this.downloadFile(r);break}case"rename":{this.setRenamePanel(r);break}case"delete":{ve.confirm({content:G.t("delete-courseware-tips"),onOk:()=>this.removeFiles([r])});break}default:console.warn("[cloud-storage]: unhandled item menu click")}});p(this,"onItemTitleClick",(r,t)=>{var o,n;const i=this.filesMap.get(r);if(i)try{if(i.resourceType===B.Directory){this.setCurrentDirectoryPath(i.fileName),t(this.parentDirectoryPath),this.isOpenDirectoryFile=!0;return}this.compact?((o=i.meta.whiteboardConvert)==null?void 0:o.convertStep)===P.Failed||((n=i.meta.whiteboardProjector)==null?void 0:n.convertStep)===P.Failed?ve.info({content:G.t("the-courseware-cannot-be-transcoded")}):this.insertCourseware(i):this.previewCourseware(i)}catch(l){console.error(l)}});p(this,"onBatchDelete",()=>{this.selectedFileUUIDs.length>0&&ve.confirm({content:G.t("delete-select-courseware-tips"),onOk:async()=>{this.selectedFileUUIDs.length>0&&await this.removeFiles(this.selectedFileUUIDs)}})});p(this,"onUpload",async()=>{try{const r=await this.pickCourseware();r&&r.length>0&&(this.setPanelExpand(!0),this.uploadTaskManager.addTasks(Array.from(r),this.parentDirectoryPath))}catch(r){ue(r)}});p(this,"onUploadPanelClose",()=>{this.uploadTaskManager.pending.length>0||this.uploadTaskManager.uploading.length>0?ve.confirm({title:G.t("cancel-upload"),content:G.t("cancel-upload-tips"),cancelText:G.t("think-again"),onOk:()=>this.cancelAll()}):this.cancelAll()});p(this,"onUploadRetry",r=>{this.uploadTaskManager.retry(r)});p(this,"onUploadCancel",async r=>{try{await this.uploadTaskManager.cancel(r)}catch(i){console.error(i)}this.uploadTaskManager.pending.length+this.uploadTaskManager.success.length+this.uploadTaskManager.failed.length+this.uploadTaskManager.uploading.length<=0&&this.setPanelExpand(!1)});p(this,"onNewEmptyDirectory",async()=>{M(()=>{this.filesMap.set("temporaryDirectory",{fileName:"",fileURL:"/",fileUUID:"temporaryDirectory",fileSize:0,createAt:new Date,resourceType:B.Directory,meta:{}})})});p(this,"onNewDirectoryFile",async r=>{try{if(r.directoryName===""){this.filesMap.delete("temporaryDirectory");return}const{fileUUID:t}=await lr(r);M(()=>{this.filesMap.delete("temporaryDirectory"),this.filesMap.set(t,{fileName:r.directoryName,fileURL:"",fileUUID:t,fileSize:0,createAt:new Date,resourceType:B.Directory,meta:{}})})}catch(t){ue(t)}});p(this,"onNewFileName",async(r,t)=>{const i=this.filesMap.get(r);if(i){if(i.fileName===t.fullName)return;await cr({fileUUID:r,newName:t.name}),M(()=>{i.fileName=t.fullName})}});p(this,"fetchMoreCloudStorageData",async r=>{if(this.isFetchingFiles)return;const t=this.cloudStorageDataPagination*this.cloudStorageSinglePageFiles;if(this.filesMap.size>=t&&this.hasMoreFile){M(()=>{this.isFetchingFiles=!0});try{const{files:i}=await He({page:r,order:"DESC",directoryPath:this.parentDirectoryPath});M(()=>{this.isFetchingFiles=!1}),this.hasMoreFile=i.length>0;const o={};for(const n of i){const l=this.filesMap.get(n.fileUUID);M(()=>{l?(l.createAt.valueOf()!==n.createAt.valueOf()&&(l.createAt=n.createAt),l.fileName=n.fileName,l.fileSize=n.fileSize,l.resourceType=n.resourceType,Ze(l.meta,n.meta)||(l.meta=n.meta)):o[n.fileUUID]=F.object(n)})}M(()=>{this.filesMap.merge(o)})}catch{M(()=>{this.isFetchingFiles=!1})}}});p(this,"refreshFiles",async()=>{try{const{totalUsage:r,files:t}=await He({page:1,order:"DESC",directoryPath:this.parentDirectoryPath});M(()=>{this.totalUsage=r});const i={},o=[];for(const n of t){const l=this.filesMap.get(n.fileUUID);M(()=>{l?(l.createAt.valueOf()!==n.createAt.valueOf()&&(l.createAt=n.createAt),l.fileName=n.fileName,l.fileSize=n.fileSize,l.resourceType=n.resourceType,Ze(l.meta,n.meta)||(l.meta=n.meta)):i[n.fileUUID]=F.object(n)}),n.meta.whiteboardProjector&&(n.meta.whiteboardProjector.convertStep===P.Done||n.meta.whiteboardProjector.convertStep===P.Failed?this.convertStatusManager.cancelTask(n.fileUUID):o.push(n.fileUUID)),n.meta.whiteboardConvert&&(n.meta.whiteboardConvert.convertStep===P.Done||n.meta.whiteboardConvert.convertStep===P.Failed?this.convertStatusManager.cancelTask(n.fileUUID):o.push(n.fileUUID))}M(()=>{this.isOpenDirectoryFile?(this.filesMap.replace(i),this.isOpenDirectoryFile=!1):this.filesMap.merge(i)});for(const n of o)await this.queryConvertStatus(n)}catch(r){ue(r)}});this.insertCourseware=t,this.compact=r,this.scheduler=new Zi(this.refreshFiles,10*1e3),ft(this,{filesMap:F,pendingUploadTasks:L,uploadingUploadTasks:L,successUploadTasks:L,failedUploadTasks:L,files:L,fileMenus:O,onItemMenuClick:O,onItemTitleClick:O,onParentDirectoryPathClick:O,onBatchDelete:O,onUpload:O,onUploadPanelClose:O,onUploadRetry:O,onUploadCancel:O,onNewFileName:O,onNewEmptyDirectory:O})}get pendingUploadTasks(){return this.mapUploadTasks(this.uploadTaskManager.pending)}get uploadingUploadTasks(){return this.mapUploadTasks(this.uploadTaskManager.uploading)}get successUploadTasks(){return this.mapUploadTasks(this.uploadTaskManager.success)}get failedUploadTasks(){return this.mapUploadTasks(this.uploadTaskManager.failed)}get files(){return F.array([...this.filesMap.values()].sort((r,t)=>{const i=r.resourceType==="Directory",o=t.resourceType==="Directory";return i===o?t.createAt.valueOf()-r.createAt.valueOf():i?-1:1}))}onDropFile(r){this.setPanelExpand(!0),this.uploadTaskManager.addTasks(Array.from(r),this.parentDirectoryPath)}initialize({onCoursewareInserted:r}={}){this.onCoursewareInserted=r,this.scheduler.start(),this.uploadTaskManager.pending.length<=0&&this.uploadTaskManager.uploadingMap.size<=0&&this.uploadTaskManager.cancelAll();const t=ur(()=>this.uploadTaskManager.uploading.length,(i,o)=>{i<o&&(console.log("[cloud storage]: start now refresh"),this.scheduler.invoke(),this.hasMoreFile=!0)});return()=>{t(),this.scheduler.stop(),this.convertStatusManager.cancelAllTasks(),this.onCoursewareInserted=void 0}}async previewCourseware(r){const t=await gt.getInstance().requestService("file");t==null||t.preview(r)}async removeFiles(r){try{const t=[];r.forEach(i=>{t.push(i)}),await Promise.all([dr({uuids:t})]),M(()=>{for(const i of r)this.filesMap.delete(i);this.selectedFileUUIDs.clear()})}catch(t){ue(t)}}downloadFile(r){const t=this.filesMap.get(r);if(t&&t.fileURL){const i=document.createElement("a");i.href=t.fileURL,i.click()}}pickCourseware(){return new Promise(r=>{const t=document.createElement("input");t.type="file",t.multiple=!0,t.accept=".ppt,.pptx,.doc,.docx,.pdf,.png,.jpg,.jpeg,.gif,.mp3,.mp4",t.onchange=()=>r(t.files),t.click()})}static mapUploadStatus(r){switch(r){case ae.Pending:return"idle";case ae.Success:return"success";case ae.Starting:case ae.Uploading:return"uploading";default:return"error"}}mapUploadTasks(r){return F.array(r.map(t=>({uploadID:t.uploadID,fileName:t.file.name,percent:t.percent,status:_t.mapUploadStatus(t.status)})))}async queryConvertStatus(r){const t=this.filesMap.get(r);if(!!t&&(t.resourceType===B.WhiteboardConvert||t.resourceType===B.WhiteboardProjector)){const i=pt(t.resourceType,t.meta);if(i===null||i.convertStep===P.Done||i.convertStep===P.Failed)return;this.convertStatusManager.addTask(t)}}async cancelAll(){try{await this.uploadTaskManager.cancelAll()}catch(r){console.error(r)}this.setPanelExpand(!1)}}export{_t as C,Gi as U,es as a};
//# sourceMappingURL=style.2fbf8d03.js.map
