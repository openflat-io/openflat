var Ms=Object.defineProperty;var Es=(i,e,t)=>e in i?Ms(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var d=(i,e,t)=>(Es(i,typeof e!="symbol"?e+"":e,t),t);import{bK as V,bP as ce,bQ as P,bR as Rs,bS as _s,bT as Ts,bU as Fs,bV as Ps,bW as As,l as h,q as n,bb as y,a$ as C,b3 as Xe,bX as Ls,bY as Hs,bZ as O,by as Ut,b_ as Ws,b$ as Os,c0 as ps,c1 as At,c2 as vs,c3 as $s,b7 as Ns,y as A,s as pe,c4 as js,b6 as le,J as xe,c5 as Ke,c6 as Zs,c7 as Vs,ad as Ae,ax as Bs,b5 as K,b4 as zs,c8 as Z,c9 as Qe,ca as Te,cb as Gs,cc as re,S as It,cd as oe,ce as Ys,cf as Js,cg as qs,ch as Lt,ci as Xs,cj as Ks,ck as Qs,cl as ei,cm as ti,cn as si,co as ii,cp as ai,cq as ni,cr as ri,o as Ye,bv as M,cs as oi,ct as li,aV as ci,bo as Pe,F as mi,cu as Dt,aR as Ie,cv as Ht,bu as Oe,bI as G,cw as Wt,cx as ui,cy as di,cz as hi,cA as fi,cB as gi,bf as kt,bp as pi,cC as vi,cD as Ni,be as bs,bd as bi,bF as wi,bH as Si,cE as xi,v as ws,d as Ui,cF as yi,P as Ci,cG as Ii,cH as Di,bw as ki}from"./index.ec641b5a.js";import{c as Ue}from"./index.a44c3572.js";import{d as Mi,c as Ei,I as Ri}from"./index.21e94715.js";import{g as Mt}from"./index.a792be8b.js";import{e as Ce,u as Et}from"./routes.96a891de.js";import{C as _i,a as Ti,U as Fi}from"./style.2fbf8d03.js";import{u as Pi}from"./lifecycle.f56c70c9.js";import{W as Ss}from"./index.81013a66.js";import{f as Ai,h as Li}from"./agora.f9cd284f.js";import{g as Hi}from"./courseware-converting.fa8cab40.js";import{W as Wi}from"./constants.3556e8ac.js";import{d as Oi}from"./debounce.3c601f71.js";import{a as Ot,I as $t}from"./constants.1a2b4361.js";function ze(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ze=function(t){return typeof t}:ze=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(i)}function De(i,e){if(V(2,arguments),!e||ze(e)!=="object")return new Date(NaN);var t=e.years?ce(e.years):0,s=e.months?ce(e.months):0,a=e.weeks?ce(e.weeks):0,r=e.days?ce(e.days):0,l=e.hours?ce(e.hours):0,m=e.minutes?ce(e.minutes):0,o=e.seconds?ce(e.seconds):0,c=P(i),u=s||t?Rs(c,s+t*12):c,f=r||a?_s(u,r+a*7):u,g=m+l*60,N=o+g*60,v=N*1e3,p=new Date(f.getTime()+v);return p}function $i(i,e){V(2,arguments);var t=P(i),s=P(e),a=t.getFullYear()-s.getFullYear(),r=t.getMonth()-s.getMonth();return a*12+r}function ji(i,e){V(2,arguments);var t=P(i),s=P(e);return t.getFullYear()-s.getFullYear()}function jt(i,e){var t=i.getFullYear()-e.getFullYear()||i.getMonth()-e.getMonth()||i.getDate()-e.getDate()||i.getHours()-e.getHours()||i.getMinutes()-e.getMinutes()||i.getSeconds()-e.getSeconds()||i.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Zi(i,e){V(2,arguments);var t=P(i),s=P(e),a=jt(t,s),r=Math.abs(Mi(t,s));t.setDate(t.getDate()-a*r);var l=Number(jt(t,s)===-a),m=a*(r-l);return m===0?0:m}function Rt(i,e){return V(2,arguments),P(i).getTime()-P(e).getTime()}function Vi(i,e,t){V(2,arguments);var s=Rt(i,e)/Ts;return Mt(t==null?void 0:t.roundingMethod)(s)}function Bi(i,e,t){V(2,arguments);var s=Rt(i,e)/Fs;return Mt(t==null?void 0:t.roundingMethod)(s)}function zi(i){V(1,arguments);var e=P(i);return Ps(e).getTime()===As(e).getTime()}function Gi(i,e){V(2,arguments);var t=P(i),s=P(e),a=Ue(t,s),r=Math.abs($i(t,s)),l;if(r<1)l=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-a*r);var m=Ue(t,s)===-a;zi(P(i))&&r===1&&Ue(i,s)===1&&(m=!1),l=a*(r-Number(m))}return l===0?0:l}function Yi(i,e,t){V(2,arguments);var s=Rt(i,e)/1e3;return Mt(t==null?void 0:t.roundingMethod)(s)}function Ji(i,e){V(2,arguments);var t=P(i),s=P(e),a=Ue(t,s),r=Math.abs(ji(t,s));t.setFullYear(1584),s.setFullYear(1584);var l=Ue(t,s)===-a,m=a*(r-Number(l));return m===0?0:m}function qi(i){V(1,arguments);var e=P(i.start),t=P(i.end);if(isNaN(e.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(t.getTime()))throw new RangeError("End Date is invalid");var s={};s.years=Math.abs(Ji(t,e));var a=Ue(t,e),r=De(e,{years:a*s.years});s.months=Math.abs(Gi(t,r));var l=De(r,{months:a*s.months});s.days=Math.abs(Zi(t,l));var m=De(l,{days:a*s.days});s.hours=Math.abs(Vi(t,m));var o=De(m,{hours:a*s.hours});s.minutes=Math.abs(Bi(t,o));var c=De(o,{minutes:a*s.minutes});return s.seconds=Math.abs(Yi(t,c)),s}var Xi=function(i){return(i+1)%1e6};function Ki(){var i=h.exports.useReducer(Xi,0),e=i[1];return e}const Qi="data:image/svg+xml;charset=utf8,%3csvg width='200' height='200' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M20 100c0-44.183 35.817-80 80-80h80v80c0 44.183-35.817 80-80 80s-80-35.817-80-80Z' fill='%23F4F8FF'/%3e%3cpath d='M156 136h-.625v-.625H156V136Zm0 12h.625v1.509l-1.067-1.067L156 148Zm-12-12v-.625h.259l.183.183L144 136Zm27.375-40A7.375 7.375 0 0 0 164 88.625v-1.25A8.625 8.625 0 0 1 172.625 96h-1.25Zm0 32V96h1.25v32h-1.25ZM164 135.375a7.375 7.375 0 0 0 7.375-7.375h1.25a8.626 8.626 0 0 1-8.625 8.625v-1.25Zm-8 0h8v1.25h-8v-1.25Zm.625.625v12h-1.25v-12h1.25Zm-1.067 12.442-12-12 .884-.884 12 12-.884.884ZM100 135.375h44v1.25h-44v-1.25ZM92.625 128a7.375 7.375 0 0 0 7.375 7.375v1.25A8.625 8.625 0 0 1 91.375 128h1.25Zm0-32v32h-1.25V96h1.25ZM100 88.625A7.375 7.375 0 0 0 92.625 96h-1.25A8.625 8.625 0 0 1 100 87.375v1.25Zm64 0h-64v-1.25h64v1.25Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 107h-40v2h40v-2Zm-8 8h-32v2h32v-2Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M28 60a8 8 0 0 1 8-8h64a8 8 0 0 1 8 8v32a8 8 0 0 1-8 8H56l-12 12v-12h-8a8 8 0 0 1-8-8V60Zm26 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm14 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm17-3a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z' fill='%233381FF'/%3e%3c/svg%3e",ea="data:image/svg+xml;charset=utf8,%3csvg width='200' height='200' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M20 100c0-44.183 35.817-80 80-80h80v80c0 44.183-35.817 80-80 80s-80-35.817-80-80Z' fill='%232B2F38'/%3e%3cpath d='M156 136h-.625v-.625H156V136Zm0 12h.625v1.509l-1.067-1.067L156 148Zm-12-12v-.625h.259l.183.183L144 136Zm27.375-40A7.375 7.375 0 0 0 164 88.625v-1.25A8.625 8.625 0 0 1 172.625 96h-1.25Zm0 32V96h1.25v32h-1.25ZM164 135.375a7.375 7.375 0 0 0 7.375-7.375h1.25a8.626 8.626 0 0 1-8.625 8.625v-1.25Zm-8 0h8v1.25h-8v-1.25Zm.625.625v12h-1.25v-12h1.25Zm-1.067 12.442-12-12 .884-.884 12 12-.884.884ZM100 135.375h44v1.25h-44v-1.25ZM92.625 128a7.375 7.375 0 0 0 7.375 7.375v1.25A8.625 8.625 0 0 1 91.375 128h1.25Zm0-32v32h-1.25V96h1.25ZM100 88.625A7.375 7.375 0 0 0 92.625 96h-1.25A8.625 8.625 0 0 1 100 87.375v1.25Zm64 0h-64v-1.25h64v1.25Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 107h-40v2h40v-2Zm-8 8h-32v2h32v-2ZM28 60a8 8 0 0 1 8-8h64a8 8 0 0 1 8 8v32a8 8 0 0 1-8 8H56l-12 12v-12h-8a8 8 0 0 1-8-8V60Zm26 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm14 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm17-3a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z' fill='%232867CC'/%3e%3c/svg%3e";var ke="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGCamera.tsx";const ta=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("circle",{className:"flat-icon-stroke-color",cx:"12",cy:"11",r:"7",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:ke,lineNumber:16,columnNumber:13},void 0),n("circle",{className:"flat-icon-stroke-color",cx:"12",cy:"11",r:"3",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:ke,lineNumber:25,columnNumber:13},void 0),n("circle",{className:"flat-icon-fill-color",cx:"14.625",cy:"6.625",fill:"#5D6066",r:".625"},void 0,!1,{fileName:ke,lineNumber:34,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"M7 18.25a8.004 8.004 0 0 0 10 0",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:ke,lineNumber:41,columnNumber:13},void 0)]},void 0,!0,{fileName:ke,lineNumber:7,columnNumber:9},void 0);var tt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGCameraMute.tsx";const sa=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-stroke-color",d:"m5 5 14 14",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:tt,lineNumber:20,columnNumber:13},void 0),n("path",{className:"flat-icon-fill-color",clipRule:"evenodd",d:"m15.72 18.373.91.909a8.63 8.63 0 0 1-9.788-.364l-.232-.18.78-.976a7.38 7.38 0 0 0 8.33.61Zm2.434-2.87A7.625 7.625 0 0 0 7.497 4.846l.897.896a6.375 6.375 0 0 1 8.864 8.864l.896.897Zm-3.857 1.446.952.951A7.625 7.625 0 0 1 5.1 7.751l.951.952a6.375 6.375 0 0 0 8.246 8.246Zm.956-4.348a3.625 3.625 0 0 0-4.854-4.854l.964.964a2.378 2.378 0 0 1 2.926 2.926l.964.964Zm-.628-5.351a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25Z",fill:"#5D6066",fillRule:"evenodd"},void 0,!1,{fileName:tt,lineNumber:27,columnNumber:13},void 0)]},void 0,!0,{fileName:tt,lineNumber:11,columnNumber:9},void 0);var st="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGChatBanning.tsx";const ia=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-fill-color",clipRule:"evenodd",d:"M18.674 16.022A2.62 2.62 0 0 0 19.625 14V7A2.625 2.625 0 0 0 17 4.375H7.027l1.25 1.25H17c.76 0 1.375.616 1.375 1.375v7c0 .469-.235.883-.593 1.13l.892.892Zm-5.95-.647 1.25 1.25h-1.717l-2.815 2.817a.625.625 0 0 1-1.06-.347L8.375 19v-2.375H7a2.625 2.625 0 0 1-2.62-2.459L4.375 14V7.027l1.25 1.25V14c0 .76.616 1.375 1.375 1.375h2c.345 0 .625.28.625.625v1.491l1.933-1.933a.625.625 0 0 1 .344-.175l.098-.008h.723Z",fill:"#5D6066",fillRule:"evenodd"},void 0,!1,{fileName:st,lineNumber:20,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"m5 5 14 14",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:st,lineNumber:27,columnNumber:13},void 0)]},void 0,!0,{fileName:st,lineNumber:11,columnNumber:9},void 0);var it="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGExit.tsx";const Mr=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-fill-color",d:"M15.625 7V6h-1.25v1h1.25ZM14 4.375H6v1.25h8v-1.25ZM4.375 6v12h1.25V6h-1.25ZM6 19.625h8v-1.25H6v1.25ZM15.625 18v-1h-1.25v1h1.25ZM14 19.625c.898 0 1.625-.727 1.625-1.625h-1.25a.375.375 0 0 1-.375.375v1.25ZM4.375 18c0 .898.728 1.625 1.625 1.625v-1.25A.375.375 0 0 1 5.625 18h-1.25ZM6 4.375c-.897 0-1.625.728-1.625 1.625h1.25c0-.207.168-.375.375-.375v-1.25ZM15.625 6c0-.897-.727-1.625-1.625-1.625v1.25c.207 0 .375.168.375.375h1.25Z",fill:"#5D6066"},void 0,!1,{fileName:it,lineNumber:16,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"M10 12h9m-3 3 3-3-3-3",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:it,lineNumber:21,columnNumber:13},void 0)]},void 0,!0,{fileName:it,lineNumber:7,columnNumber:9},void 0);var at="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGHandUp.tsx";const aa=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-stroke-color",d:"M15.869 12.624a3 3 0 0 0-2.121 3.674",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:at,lineNumber:16,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",clipRule:"evenodd",d:"m17.4 17.617 2.554-7.549a.862.862 0 0 0-.385-1.023.815.815 0 0 0-1.05.202l-2.65 3.377-2.07-7.727a1 1 0 0 0-1.932.517l1.294 4.83-.966.259-1.812-6.762a1 1 0 1 0-1.932.518l1.812 6.761-.966.26-1.553-5.796A1 1 0 0 0 5.812 6l1.553 5.796-.966.259-1.035-3.864a1 1 0 1 0-1.932.518l2.588 9.659a4 4 0 0 0 4.9 2.828l3.727-.998a4 4 0 0 0 2.754-2.582Z",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:at,lineNumber:23,columnNumber:13},void 0)]},void 0,!0,{fileName:at,lineNumber:7,columnNumber:9},void 0);var Zt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGMenuFold.tsx";const Er=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:n("path",{className:"flat-icon-stroke-color",d:"m16 10 2 2-2 2M6 6h12M6 18h12M6 14h8m-8-4h8",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:Zt,lineNumber:16,columnNumber:13},void 0)},void 0,!1,{fileName:Zt,lineNumber:7,columnNumber:9},void 0);var Vt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGMenuUnfold.tsx";const Rr=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:n("path",{className:"flat-icon-stroke-color",d:"m8 10-2 2 2 2m10-8H6m12 12H6m12-4h-8m8-4h-8",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:Vt,lineNumber:20,columnNumber:13},void 0)},void 0,!1,{fileName:Vt,lineNumber:11,columnNumber:9},void 0);var nt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGMicrophoneMute.tsx";const na=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-stroke-color",d:"m5 5 14 14",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:nt,lineNumber:20,columnNumber:13},void 0),n("path",{className:"flat-icon-fill-color",clipRule:"evenodd",d:"M19.277 16.625H20v-1.25h-1.973l1.25 1.25Zm-3.239 2.065.89.89a4.602 4.602 0 0 1-2.716 1.04l-.212.005h-4a4.626 4.626 0 0 1-4.55-3.787l-.033-.213H4v-1.25h2c.345 0 .625.28.625.625a3.375 3.375 0 0 0 3.19 3.37l.185.005h4a3.36 3.36 0 0 0 2.038-.685Zm.587-4.717V8a4.625 4.625 0 0 0-8.5-2.526l.911.91a3.374 3.374 0 0 1 6.281.991H14v1.25h1.375v.75H14v1.25h1.375v.75h-1.348l1.25 1.25h.098v.098l1.25 1.25Zm-2.587 2.717.89.89A4.625 4.625 0 0 1 7.375 14v-3.973l1.25 1.25v.098h.098l1.25 1.25H8.625V14a3.375 3.375 0 0 0 5.413 2.69Z",fill:"#5D6066",fillRule:"evenodd"},void 0,!1,{fileName:nt,lineNumber:27,columnNumber:13},void 0)]},void 0,!0,{fileName:nt,lineNumber:11,columnNumber:9},void 0);var Bt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGPlus.tsx";const ra=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:n("path",{className:"flat-icon-stroke-color",d:"M5 12h14m-7-7v14",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:Bt,lineNumber:16,columnNumber:13},void 0)},void 0,!1,{fileName:Bt,lineNumber:7,columnNumber:9},void 0);var $e="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGRecord.tsx";const oa=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("rect",{className:"flat-icon-stroke-color",height:"12",rx:"2",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25",width:"14",x:"3",y:"6"},void 0,!1,{fileName:$e,lineNumber:16,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",clipRule:"evenodd",d:"m17 11 4-2v6l-4-2v-2Z",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:$e,lineNumber:27,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"M6 9h4",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:$e,lineNumber:35,columnNumber:13},void 0)]},void 0,!0,{fileName:$e,lineNumber:7,columnNumber:9},void 0);var we="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGRecordStop.tsx";const la=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-stroke-color",d:"M3 11V8a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-5",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:we,lineNumber:20,columnNumber:13},void 0),n("circle",{className:"flat-icon-stroke-color",cx:"6",cy:"15",r:"3",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:we,lineNumber:27,columnNumber:13},void 0),n("path",{className:"flat-icon-fill-color",d:"M5 14h2v2H5z",fill:"#5D6066"},void 0,!1,{fileName:we,lineNumber:36,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",clipRule:"evenodd",d:"m17 11 4-2v6l-4-2v-2Z",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:we,lineNumber:37,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"M6 9h4",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:we,lineNumber:45,columnNumber:13},void 0)]},void 0,!0,{fileName:we,lineNumber:11,columnNumber:9},void 0);var Me="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGScreenSharing.tsx";const _r=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-stroke-color",d:"M12 17v3m-3 0h6",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:Me,lineNumber:20,columnNumber:13},void 0),n("path",{className:"flat-icon-fill-color",d:"M18.375 11v4h1.25v-4h-1.25ZM17 16.375H7v1.25h10v-1.25ZM5.625 15V8h-1.25v7h1.25ZM7 6.625h5v-1.25H7v1.25ZM5.625 8c0-.76.616-1.375 1.375-1.375v-1.25A2.625 2.625 0 0 0 4.375 8h1.25ZM7 16.375c-.76 0-1.375-.616-1.375-1.375h-1.25A2.625 2.625 0 0 0 7 17.625v-1.25ZM18.375 15c0 .76-.616 1.375-1.375 1.375v1.25A2.625 2.625 0 0 0 19.625 15h-1.25Z",fill:"#5D6066"},void 0,!1,{fileName:Me,lineNumber:27,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"m17 4 2 2-2 2",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:Me,lineNumber:32,columnNumber:13},void 0),n("path",{className:"flat-icon-fill-color",d:"M19 5.375h-3v1.25h3v-1.25ZM13.375 8v3h1.25V8h-1.25ZM16 5.375A2.625 2.625 0 0 0 13.375 8h1.25c0-.76.616-1.375 1.375-1.375v-1.25Z",fill:"#5D6066"},void 0,!1,{fileName:Me,lineNumber:39,columnNumber:13},void 0)]},void 0,!0,{fileName:Me,lineNumber:11,columnNumber:9},void 0);var zt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGSend.tsx";const ca=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:n("path",{className:"flat-icon-stroke-color",d:"m15 10-5 5v5l4-4 4 3 2-15-16 9 4 1",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:zt,lineNumber:16,columnNumber:13},void 0)},void 0,!1,{fileName:zt,lineNumber:7,columnNumber:9},void 0);var rt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/FlatIcons/icons/SVGUserInvite.tsx";const ma=({active:i,className:e="",...t})=>n("svg",{className:`${e} flat-icon ${i?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:[n("path",{className:"flat-icon-fill-color",d:"m7.265 14.925.294.552-.294-.552Zm-.03.724.324-.172-.588-1.103-.324.173.588 1.102Zm3.203-3.128.121-.242-1.118-.559-.12.242 1.117.559Zm-.813-2.935V7h-1.25v2.586h1.25ZM14.375 7v2.586h1.25V7h-1.25Zm-.934 5.28.496.99 1.118-.558-.496-.992-1.118.56Zm.934-2.694c0 .74-.294 1.449-.817 1.972l.884.884a4.04 4.04 0 0 0 1.183-2.856h-1.25ZM9.625 7A2.375 2.375 0 0 1 12 4.625v-1.25A3.625 3.625 0 0 0 8.375 7h1.25Zm.817 4.558a2.79 2.79 0 0 1-.817-1.972h-1.25c0 1.071.426 2.098 1.183 2.856l.884-.884Zm-2.883 3.919a6.793 6.793 0 0 0 2.88-2.956l-1.119-.559a5.543 5.543 0 0 1-2.349 2.412l.588 1.103ZM12 4.625A2.375 2.375 0 0 1 14.375 7h1.25A3.625 3.625 0 0 0 12 3.375v1.25ZM4.625 20a4.93 4.93 0 0 1 2.61-4.35l-.588-1.103A6.18 6.18 0 0 0 3.375 20h1.25Z",fill:"#5D6066"},void 0,!1,{fileName:rt,lineNumber:20,columnNumber:13},void 0),n("path",{className:"flat-icon-stroke-color",d:"M21 17h-8m4 4v-8",stroke:"#5D6066",strokeLinejoin:"round",strokeWidth:"1.25"},void 0,!1,{fileName:rt,lineNumber:25,columnNumber:13},void 0)]},void 0,!0,{fileName:rt,lineNumber:11,columnNumber:9},void 0);var me="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatTypeBox/index.tsx";const ua=y(function({isCreator:e,isBan:t,onBanChange:s,onMessageSend:a}){const r=C(),l=Xe(),m=h.exports.useRef(null),[o,c]=h.exports.useState(""),[u,f]=h.exports.useState(!1),g=h.exports.useMemo(()=>o.trim(),[o]);async function N(){var v;if(!(u||g.length<=0)){f(!0);try{await l(a(o)),c(""),(v=m.current)==null||v.focus()}catch(p){console.warn(p)}f(!1)}}return n("div",{className:"chat-typebox",children:[e&&n("button",{className:"chat-typebox-icon",title:r("ban"),onClick:s,children:n(ia,{active:t},void 0,!1,{fileName:me,lineNumber:53,columnNumber:21},this)},void 0,!1,{fileName:me,lineNumber:52,columnNumber:17},this),!e&&t?n("span",{className:"chat-typebox-ban-input",title:r("all-staff-are-under-ban"),children:r("all-staff-are-under-ban")},void 0,!1,{fileName:me,lineNumber:57,columnNumber:17},this):n("input",{ref:m,className:"chat-typebox-input",placeholder:r("say-something"),type:"text",value:o,onChange:v=>c(v.currentTarget.value.slice(0,200)),onKeyPress:v=>{v.key==="Enter"&&N()}},void 0,!1,{fileName:me,lineNumber:61,columnNumber:17},this),n("button",{className:"chat-typebox-send",disabled:!e&&t||u||g.length<=0,title:r("send"),onClick:N,children:n(ca,{},void 0,!1,{fileName:me,lineNumber:81,columnNumber:17},this)},void 0,!1,{fileName:me,lineNumber:75,columnNumber:13},this)]},void 0,!0,{fileName:me,lineNumber:50,columnNumber:9},this)});var da=30,ha=100,fa=function(){function i(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hs(this,i),O(this,"_cellHeightCache",{}),O(this,"_cellWidthCache",{}),O(this,"_columnWidthCache",{}),O(this,"_rowHeightCache",{}),O(this,"_defaultHeight",void 0),O(this,"_defaultWidth",void 0),O(this,"_minHeight",void 0),O(this,"_minWidth",void 0),O(this,"_keyMapper",void 0),O(this,"_hasFixedHeight",void 0),O(this,"_hasFixedWidth",void 0),O(this,"_columnCount",0),O(this,"_rowCount",0),O(this,"columnWidth",function(u){var f=u.index,g=e._keyMapper(0,f);return e._columnWidthCache[g]!==void 0?e._columnWidthCache[g]:e._defaultWidth}),O(this,"rowHeight",function(u){var f=u.index,g=e._keyMapper(f,0);return e._rowHeightCache[g]!==void 0?e._rowHeightCache[g]:e._defaultHeight});var s=t.defaultHeight,a=t.defaultWidth,r=t.fixedHeight,l=t.fixedWidth,m=t.keyMapper,o=t.minHeight,c=t.minWidth;this._hasFixedHeight=r===!0,this._hasFixedWidth=l===!0,this._minHeight=o||0,this._minWidth=c||0,this._keyMapper=m||ga,this._defaultHeight=Math.max(this._minHeight,typeof s=="number"?s:da),this._defaultWidth=Math.max(this._minWidth,typeof a=="number"?a:ha),this._hasFixedHeight===!1&&this._hasFixedWidth===!1&&console.warn("CellMeasurerCache should only measure a cell's width or height. You have configured CellMeasurerCache to measure both. This will result in poor performance."),this._hasFixedHeight===!1&&this._defaultHeight===0&&console.warn("Fixed height CellMeasurerCache should specify a :defaultHeight greater than 0. Failing to do so will lead to unnecessary layout and poor performance."),this._hasFixedWidth===!1&&this._defaultWidth===0&&console.warn("Fixed width CellMeasurerCache should specify a :defaultWidth greater than 0. Failing to do so will lead to unnecessary layout and poor performance.")}return Ls(i,[{key:"clear",value:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=this._keyMapper(t,s);delete this._cellHeightCache[a],delete this._cellWidthCache[a],this._updateCachedColumnAndRowSizes(t,s)}},{key:"clearAll",value:function(){this._cellHeightCache={},this._cellWidthCache={},this._columnWidthCache={},this._rowHeightCache={},this._rowCount=0,this._columnCount=0}},{key:"hasFixedHeight",value:function(){return this._hasFixedHeight}},{key:"hasFixedWidth",value:function(){return this._hasFixedWidth}},{key:"getHeight",value:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this._hasFixedHeight)return this._defaultHeight;var a=this._keyMapper(t,s);return this._cellHeightCache[a]!==void 0?Math.max(this._minHeight,this._cellHeightCache[a]):this._defaultHeight}},{key:"getWidth",value:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this._hasFixedWidth)return this._defaultWidth;var a=this._keyMapper(t,s);return this._cellWidthCache[a]!==void 0?Math.max(this._minWidth,this._cellWidthCache[a]):this._defaultWidth}},{key:"has",value:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=this._keyMapper(t,s);return this._cellHeightCache[a]!==void 0}},{key:"set",value:function(t,s,a,r){var l=this._keyMapper(t,s);s>=this._columnCount&&(this._columnCount=s+1),t>=this._rowCount&&(this._rowCount=t+1),this._cellHeightCache[l]=r,this._cellWidthCache[l]=a,this._updateCachedColumnAndRowSizes(t,s)}},{key:"_updateCachedColumnAndRowSizes",value:function(t,s){if(!this._hasFixedWidth){for(var a=0,r=0;r<this._rowCount;r++)a=Math.max(a,this.getWidth(r,s));var l=this._keyMapper(0,s);this._columnWidthCache[l]=a}if(!this._hasFixedHeight){for(var m=0,o=0;o<this._columnCount;o++)m=Math.max(m,this.getHeight(t,o));var c=this._keyMapper(t,0);this._rowHeightCache[c]=m}}},{key:"defaultHeight",get:function(){return this._defaultHeight}},{key:"defaultWidth",get:function(){return this._defaultWidth}}]),i}();function ga(i,e){return"".concat(i,"-").concat(e)}var x="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatMessage/index.tsx";const pa=y(function({userUUID:e,messageUser:t,message:s,onMount:a,openCloudStorage:r}){const l=C();switch(h.exports.useEffect(()=>{a()},[]),s.type){case"notice":return n("div",{className:"chat-message-line",children:n("div",{className:"chat-message-notice",children:s.text},void 0,!1,{fileName:x,lineNumber:36,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:35,columnNumber:17},this);case"ban":return n("div",{className:"chat-message-line",children:n("div",{className:"chat-message-ban",children:n("span",{children:s.status?l("banned"):l("unban")},void 0,!1,{fileName:x,lineNumber:44,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:43,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:42,columnNumber:17},this);case"user-guide":return n("div",{className:"chat-message-line",children:n("div",{className:"chat-message-user-guide-bubble",children:n("pre",{children:[l("user-guide-text"),n("span",{className:"chat-message-user-guide-btn",onClick:r,children:l("user-guide-button")},void 0,!1,{fileName:x,lineNumber:55,columnNumber:29},this)]},void 0,!0,{fileName:x,lineNumber:53,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:52,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:51,columnNumber:17},this)}const m=new Date(s.timestamp),o=Ut(m,"yyyy-MM-dd HH:mm"),[c,u]=o.split(" "),f=Ut(new Date,"yyyy-MM-dd"),g=c===f?u:o;return e===s.senderID?n("div",{className:"chat-message-line is-reverse",children:[n("div",{className:"chat-message-avatar",children:n("span",{className:"chat-message-user-avatar",children:n("img",{alt:"[avatar]",src:t==null?void 0:t.avatar},void 0,!1,{fileName:x,lineNumber:82,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:81,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:80,columnNumber:17},this),n("div",{className:"chat-message-user-bubble",children:[n("div",{className:"chat-message-user",children:[n("span",{className:"chat-message-user-name",children:(t==null?void 0:t.name)||s.senderID},void 0,!1,{fileName:x,lineNumber:87,columnNumber:25},this),n("time",{className:"chat-message-user-time",dateTime:m.toISOString(),title:m.toLocaleString(),children:g},void 0,!1,{fileName:x,lineNumber:90,columnNumber:25},this)]},void 0,!0,{fileName:x,lineNumber:86,columnNumber:21},this),n("div",{className:"chat-message-bubble is-self",children:n("pre",{children:s.text},void 0,!1,{fileName:x,lineNumber:99,columnNumber:25},this)},void 0,!1,{fileName:x,lineNumber:98,columnNumber:21},this)]},void 0,!0,{fileName:x,lineNumber:85,columnNumber:17},this)]},void 0,!0,{fileName:x,lineNumber:79,columnNumber:13},this):n("div",{className:"chat-message-line",children:[n("div",{className:"chat-message-avatar",children:n("span",{className:"chat-message-user-avatar",children:n("img",{alt:"[avatar]",src:t==null?void 0:t.avatar},void 0,!1,{fileName:x,lineNumber:110,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:109,columnNumber:17},this)},void 0,!1,{fileName:x,lineNumber:108,columnNumber:13},this),n("div",{className:"chat-message-user-bubble",children:[n("div",{className:"chat-message-user",children:[n("span",{className:"chat-message-user-name",children:(t==null?void 0:t.name)||s.senderID},void 0,!1,{fileName:x,lineNumber:115,columnNumber:21},this),n("time",{className:"chat-message-user-time",dateTime:m.toISOString(),title:m.toLocaleString(),children:g},void 0,!1,{fileName:x,lineNumber:118,columnNumber:21},this)]},void 0,!0,{fileName:x,lineNumber:114,columnNumber:17},this),n("div",{className:"chat-message-bubble",children:n("pre",{children:s.text},void 0,!1,{fileName:x,lineNumber:127,columnNumber:21},this)},void 0,!1,{fileName:x,lineNumber:126,columnNumber:17},this)]},void 0,!0,{fileName:x,lineNumber:113,columnNumber:13},this)]},void 0,!0,{fileName:x,lineNumber:107,columnNumber:9},this)});var ie="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatMessageList/index.tsx";const va=y(function({visible:e,userUUID:t,messages:s,getUserByUUID:a,loadMoreRows:r,openCloudStorage:l}){const m=Ki(),[o,c]=h.exports.useState(s.length-1),[u]=h.exports.useState(()=>new fa({defaultHeight:72,fixedWidth:!0,keyMapper:v=>s[v].uuid}));h.exports.useEffect(()=>{e&&(u.clearAll(),m(),c(s.length-1))},[e]),h.exports.useEffect(()=>{if(o!==void 0){const v=window.setTimeout(()=>{c(void 0)},0);return()=>{window.clearTimeout(v)}}},[o]),Ws(()=>({messageCount:s.length,latestMessage:s.length>0?s[s.length-1]:null}),({messageCount:v,latestMessage:p},b)=>{v>b.messageCount&&(!b.latestMessage||p.timestamp>b.latestMessage.timestamp?c(v-1):c(v-b.messageCount))});const f=h.exports.useRef(!0),g=({index:v})=>{const p=v>0;return f.current?(f.current=!1,!0):p},N=({index:v,parent:p,style:b})=>n($s,{cache:u,columnIndex:0,parent:p,rowIndex:v,children:({measure:w,registerChild:S})=>n("div",{ref:E=>E&&S&&S(E),style:b,children:n(At,{children:()=>n(pa,{message:s[v],messageUser:a(s[v].senderID),openCloudStorage:l,userUUID:t,onMount:w},void 0,!1,{fileName:ie,lineNumber:128,columnNumber:37},this)},void 0,!1,{fileName:ie,lineNumber:126,columnNumber:29},this)},void 0,!1,{fileName:ie,lineNumber:125,columnNumber:25},this)},s[v].uuid,!1,{fileName:ie,lineNumber:116,columnNumber:13},this);return n(Os,{isRowLoaded:g,loadMoreRows:r,rowCount:s.length,threshold:1,children:({onRowsRendered:v,registerChild:p})=>n(ps,{children:({height:b,width:w})=>n(At,{children:()=>n(vs,{ref:p,className:"fancy-scrollbar",height:b,rowCount:s.length,rowHeight:u.rowHeight,rowRenderer:N,scrollToAlignment:"start",scrollToIndex:o,width:w,onRowsRendered:v},void 0,!1,{fileName:ie,lineNumber:155,columnNumber:37},this)},void 0,!1,{fileName:ie,lineNumber:153,columnNumber:29},this)},void 0,!1,{fileName:ie,lineNumber:151,columnNumber:21},this)},void 0,!1,{fileName:ie,lineNumber:144,columnNumber:13},this)});var ue="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatMessages/index.tsx";const Na=y(function({messages:e,...t}){const s=h.exports.useContext(Ns);return n("div",{className:"chat-messages-wrap",children:[n("div",{className:"chat-messages",children:e.length>0?n("div",{className:"chat-messages-box",children:n(va,{messages:e,...t},void 0,!1,{fileName:ue,lineNumber:24,columnNumber:25},this)},void 0,!1,{fileName:ue,lineNumber:23,columnNumber:21},this):n("div",{className:"chat-messages-default",children:n("img",{src:s?ea:Qi},void 0,!1,{fileName:ue,lineNumber:28,columnNumber:25},this)},void 0,!1,{fileName:ue,lineNumber:27,columnNumber:21},this)},void 0,!1,{fileName:ue,lineNumber:21,columnNumber:13},this),n(ua,{...t},void 0,!1,{fileName:ue,lineNumber:32,columnNumber:13},this)]},void 0,!0,{fileName:ue,lineNumber:20,columnNumber:9},this)});var Gt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatTabTitle/index.tsx";function ba(i){return Number.isSafeInteger(i)}const Yt=({unreadCount:i,children:e})=>{const t=h.exports.useMemo(()=>ba(i)&&n("span",{className:A("chat-tab-red-dot",{"is-large":i>99}),children:i<100?i:"99+"},void 0,!1,{fileName:Gt,lineNumber:18,columnNumber:17},void 0),[i]);return n("span",{className:"chat-tab-title",children:[e,t]},void 0,!0,{fileName:Gt,lineNumber:30,columnNumber:9},void 0)};var z="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatUser/index.tsx";const wa=y(function({ownerUUID:e,userUUID:t,user:s,disableEndSpeaking:a,onAcceptRaiseHand:r,onEndSpeaking:l,generateAvatar:m}){const o=C(),[c,u]=h.exports.useState(!1),f=e===t,g=t===s.userUUID;return n("div",{className:"chat-user",children:[n("img",{alt:`User ${s.name}`,className:"chat-user-avatar",src:c?m(t):s.avatar,onError:()=>u(!0)},void 0,!1,{fileName:z,lineNumber:42,columnNumber:13},this),n("span",{className:"chat-user-name",children:s.name},void 0,!1,{fileName:z,lineNumber:48,columnNumber:13},this),e===s.userUUID?n("span",{className:"chat-user-status is-teacher",children:o("teacher")},void 0,!1,{fileName:z,lineNumber:50,columnNumber:17},this):s.hasLeft?n(pe,{children:[n("span",{className:"chat-user-status has-left",children:o("has-left")},void 0,!1,{fileName:z,lineNumber:53,columnNumber:21},this),(f||g)&&!a&&n("button",{className:"chat-user-ctl-btn is-speaking",onClick:()=>l(s.userUUID),children:o("end")},void 0,!1,{fileName:z,lineNumber:55,columnNumber:25},this)]},void 0,!0):s.isSpeak?n(pe,{children:[n("span",{className:"chat-user-status is-speaking",children:o("during-the-presentation")},void 0,!1,{fileName:z,lineNumber:65,columnNumber:21},this),(f||g)&&!a&&n("button",{className:"chat-user-ctl-btn is-speaking",onClick:()=>l(s.userUUID),children:o("end")},void 0,!1,{fileName:z,lineNumber:69,columnNumber:25},this)]},void 0,!0):s.isRaiseHand?n(pe,{children:[n("span",{className:"chat-user-status is-hand-raising",children:o("raised-hand")},void 0,!1,{fileName:z,lineNumber:79,columnNumber:21},this),f&&n("button",{className:"chat-user-ctl-btn is-hand-raising",onClick:()=>r(s.userUUID),children:o("agree")},void 0,!1,{fileName:z,lineNumber:81,columnNumber:25},this)]},void 0,!0):g&&n("span",{className:"chat-user-status is-teacher",children:o("me")},void 0,!1,{fileName:z,lineNumber:90,columnNumber:34},this)]},void 0,!0,{fileName:z,lineNumber:41,columnNumber:9},this)});var ae="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/ChatUsers/index.tsx";const Sa=y(function({isCreator:e,hasHandRaising:t,withAcceptHands:s,users:a,onCancelAllHandRaising:r,...l}){const m=C(),o=({index:u,style:f})=>{const g=a[u];return n("div",{style:f,children:n(wa,{...l,user:g},void 0,!1,{fileName:ae,lineNumber:32,columnNumber:17},this)},g.userUUID,!1,{fileName:ae,lineNumber:31,columnNumber:13},this)},c=({height:u,width:f})=>n(vs,{className:"fancy-scrollbar",data:a,height:u,rowCount:a.length,rowHeight:48,rowRenderer:o,width:f},void 0,!1,{fileName:ae,lineNumber:39,columnNumber:13},this);return n("div",{className:A("chat-users-wrap",{"with-accept-hands":s}),children:[e&&t&&n("div",{className:"chat-users-cancel-hands-wrap",children:n("button",{className:"chat-users-cancel-hands",onClick:r,children:m("cancel-hand-raising")},void 0,!1,{fileName:ae,lineNumber:55,columnNumber:21},this)},void 0,!1,{fileName:ae,lineNumber:54,columnNumber:17},this),n("div",{className:A("chat-users",{"with-cancel-hands":e&&t}),children:n(ps,{children:c},void 0,!1,{fileName:ae,lineNumber:65,columnNumber:17},this)},void 0,!1,{fileName:ae,lineNumber:60,columnNumber:13},this)]},void 0,!0,{fileName:ae,lineNumber:52,columnNumber:9},this)});var ne="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ChatPanel/index.tsx";const xa=y(function(e){const t=C(),[s,a]=h.exports.useState("messages"),r=h.exports.useMemo(()=>{const l=e.users.length;return l===0?"":l>999?"(999+)":`(${l})`},[e.users.length]);return n("div",{className:"chat-panel",children:n(js,{activeKey:s,items:[{key:"messages",label:n(Yt,{children:n("span",{children:t("messages")},void 0,!1,{fileName:ne,lineNumber:38,columnNumber:33},this)},void 0,!1,{fileName:ne,lineNumber:37,columnNumber:29},this),children:n(Na,{...e,visible:s==="messages"},void 0,!1,{fileName:ne,lineNumber:41,columnNumber:35},this)},{key:"users",label:n(Yt,{...e,children:n("span",{children:[t("users")," ",r]},void 0,!0,{fileName:ne,lineNumber:47,columnNumber:33},this)},void 0,!1,{fileName:ne,lineNumber:46,columnNumber:29},this),children:n(Sa,{...e},void 0,!1,{fileName:ne,lineNumber:52,columnNumber:35},this)}],tabBarGutter:0,onChange:a},void 0,!1,{fileName:ne,lineNumber:31,columnNumber:13},this)},void 0,!1,{fileName:ne,lineNumber:30,columnNumber:9},this)});var te="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/ExitRoomConfirmModal/index.tsx";const Ua=({visible:i,loading:e,onStop:t,onCancel:s})=>{const a=C();return n(le,{okButtonProps:{loading:e},open:i,title:a("confirmation-of-the-end-of-classes"),onCancel:s,onOk:t,children:n("p",{children:a("end-of-class-tips")},void 0,!1,{fileName:te,lineNumber:31,columnNumber:13},void 0)},void 0,!1,{fileName:te,lineNumber:24,columnNumber:9},void 0)},ya=({visible:i,hangLoading:e,stopLoading:t,onHang:s,onStop:a,onCancel:r})=>{const l=C();return n(le,{footer:[n(xe,{onClick:r,children:l("cancel")},"Cancel",!1,{fileName:te,lineNumber:61,columnNumber:17},void 0),n(xe,{loading:e,onClick:s,children:l("hang-up-the-room")},"ReturnMain",!1,{fileName:te,lineNumber:64,columnNumber:17},void 0),n(xe,{loading:t,type:"primary",onClick:a,children:l("end-the-class")},"StopClass",!1,{fileName:te,lineNumber:67,columnNumber:17},void 0)],open:i,title:l("close-option"),onCancel:r,onOk:r,children:n("p",{children:l("exit-room-tips")},void 0,!1,{fileName:te,lineNumber:76,columnNumber:13},void 0)},void 0,!1,{fileName:te,lineNumber:59,columnNumber:9},void 0)},Ca=({visible:i,onExit:e,onCancel:t})=>{const s=C();return n(le,{open:i,title:s("student-sure-to-exit-the-room"),onCancel:t,onOk:e,children:n("p",{children:s("student-exit-room-tip")},void 0,!1,{fileName:te,lineNumber:104,columnNumber:13},void 0)},void 0,!1,{fileName:te,lineNumber:98,columnNumber:9},void 0)},Ia="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cpath d='M0 10h2v4H0zm6-4v8H4V6h2zm4-4v12H8V2h2z' fill='%23d0d1d1' fill-rule='evenodd'/%3e%3c/svg%3e",Da="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='%23FF9393' d='M0 10h2v4H0z'/%3e%3cpath fill='%23FFD4D4' d='M6 6v8H4V6h2zm4-4v12H8V2h2z'/%3e%3c/g%3e%3c/svg%3e",ka="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='%23FFF3D1' d='M8 2h2v12H8z'/%3e%3cpath fill='%23FFE08D' d='M2 10v4H0v-4h2zm4-4v8H4V6h2z'/%3e%3c/g%3e%3c/svg%3e",Jt="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cpath fill='%239FDF76' fill-rule='evenodd' d='M2 10v4H0v-4h2zm4-4v8H4V6h2zm4-4v12H8V2h2z'/%3e%3c/svg%3e";var Ee="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/NetworkStatus/index.tsx";function Ma(i,e){return i===5||e===5||i===4||e===4?Da:i===3||e===3?ka:i===2||e===2||i===1||e===1||i===8||e===8?Jt:Ia}const Tr=y(function({networkQuality:e}){const t=C(),{uplink:s,downlink:a}=e,r=h.exports.useMemo(()=>Ma(s,a),[s,a]),l=h.exports.useMemo(()=>t("network-quality",{uplink:t(`network-quality${s}`),downlink:t(`network-quality${a}`)}),[t,s,a]);return n("div",{className:"network-status",children:[n("span",{className:"network-status-delay",title:t("client-to-edge-server-network-latency"),children:[t("delay"),n("span",{className:"network-status-delay-ms",children:[e.delay,"ms"]},void 0,!0,{fileName:Ee,lineNumber:62,columnNumber:17},this)]},void 0,!0,{fileName:Ee,lineNumber:57,columnNumber:13},this),n("span",{className:"network-status-signal",title:l,children:[t("network"),n("img",{alt:l,src:r},void 0,!1,{fileName:Ee,lineNumber:66,columnNumber:17},this)]},void 0,!0,{fileName:Ee,lineNumber:64,columnNumber:13},this)]},void 0,!0,{fileName:Ee,lineNumber:56,columnNumber:9},this)});var Ea="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/TopBar/TopBarRightBtn/index.tsx";const _t=({title:i,icon:e,disabled:t,className:s,...a})=>n("button",{...a,className:A("topbar-right-btn",s),disabled:t,title:i,children:e},void 0,!1,{fileName:Ea,lineNumber:17,columnNumber:5},void 0);var Re="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/RoomInfo/index.tsx";const Fr=({roomStatus:i,roomType:e})=>{const t=C();return n("div",{className:"room-info",children:[n("span",{children:[t("current-status"),n("span",{className:A("room-info-progress",{"is-active":i!==Ke.Idle}),children:t(`room-status.${Zs(i)}`)},void 0,!1,{fileName:Re,lineNumber:20,columnNumber:17},void 0)]},void 0,!0,{fileName:Re,lineNumber:18,columnNumber:13},void 0),n("span",{children:[t("current-mode"),n("span",{className:"room-info-mode",children:t(`class-room-type.${e||Vs.BigClass}`)},void 0,!1,{fileName:Re,lineNumber:30,columnNumber:17},void 0)]},void 0,!0,{fileName:Re,lineNumber:28,columnNumber:13},void 0)]},void 0,!0,{fileName:Re,lineNumber:17,columnNumber:9},void 0)},Ra=({isCreator:i,isRemoteLogin:e,roomStatus:t,onExit:s})=>{const a=h.exports.useRef(),[r,l]=h.exports.useState(!1),m=C();return h.exports.useEffect(()=>{e&&l(!0)},[e]),h.exports.useEffect(()=>{t===Ke.Stopped&&(i?s():l(!0))},[t,i,s]),h.exports.useEffect(()=>{let o;if(r){let c=5;a.current=le.info({title:m(e?"you-have-entered-the-room-at-another-device":"the-room-has-ended-and-is-about-to-exit"),okText:m("got-it-countdown",{countdown:c}),onOk:s,onCancel:s}),o=window.setInterval(()=>{var u;(u=a.current)==null||u.update({okText:m("got-it-countdown",{countdown:--c})}),c<=0&&(window.clearInterval(o),s())},1e3)}return()=>{var c;window.clearInterval(o),(c=a.current)==null||c.destroy()}},[r,s,m,e]),null};var Q="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/VideoAvatar/IconMic.tsx";const _a=Ae.memo(function({getVolumeLevel:e,noise:t=.075,...s}){t=Math.max(0,Math.min(1,t));const a=14,r=8,l=8,m=4,[o,c]=h.exports.useState(0),[u,f]=h.exports.useState(0);return h.exports.useEffect(()=>{if(!e){c(0);return}const g=()=>{c(Math.max(0,Math.min(1,e())))};g();const N=setInterval(g,500);return()=>clearInterval(N)},[e]),h.exports.useEffect(()=>{if(!o)return;const g=setInterval(()=>{f(o+Math.random()*t*(Math.random()>.5?1:-1))},50);return()=>clearInterval(g)},[o,t]),n("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...s,children:[n("defs",{children:n("clipPath",{id:"icon-mic-v-clip",children:n("rect",{height:a,rx:r/2,width:r,x:l,y:m},void 0,!1,{fileName:Q,lineNumber:67,columnNumber:21},this)},void 0,!1,{fileName:Q,lineNumber:66,columnNumber:17},this)},void 0,!1,{fileName:Q,lineNumber:65,columnNumber:13},this),n("path",{d:"M0 0h24v24H0z",fill:"#999CA3",opacity:".01"},void 0,!1,{fileName:Q,lineNumber:70,columnNumber:13},this),n("rect",{clipPath:"url(#icon-mic-v-clip)",fill:"#fff",height:a,width:r,x:l,y:m},void 0,!1,{fileName:Q,lineNumber:71,columnNumber:13},this),n("path",{d:"M4 16.625h2v-1.25H4v1.25Zm6 4h4v-1.25h-4v1.25Zm8-4h2v-1.25h-2v1.25Zm-4 4A4.625 4.625 0 0 0 18.625 16h-1.25A3.375 3.375 0 0 1 14 19.375v1.25ZM5.375 16A4.625 4.625 0 0 0 10 20.625v-1.25A3.375 3.375 0 0 1 6.625 16h-1.25Z",fill:"#fff"},void 0,!1,{fileName:Q,lineNumber:79,columnNumber:13},this),n("g",{clipPath:"url(#icon-mic-v-clip)",children:n("rect",{fill:"#44AD00",height:a*2,style:{transform:`translateY(${Math.pow(1-u,2.3)*a}px)`,transition:"transform .1s"},width:r,x:l,y:m},void 0,!1,{fileName:Q,lineNumber:84,columnNumber:17},this)},void 0,!1,{fileName:Q,lineNumber:83,columnNumber:13},this)]},void 0,!0,{fileName:Q,lineNumber:57,columnNumber:9},this)});var j="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/VideoAvatar/index.tsx";const Ta=({small:i,avatarUser:e,isCreator:t,userUUID:s,updateDeviceState:a,getVolumeLevel:r,children:l})=>{const m=e.userUUID!==s&&(!t||!e.camera),o=e.userUUID!==s&&(!t||!e.mic);return n("div",{className:A("video-avatar",{"is-small":i}),children:[n("div",{className:"video-avatar-video",children:l},void 0,!1,{fileName:j,lineNumber:44,columnNumber:13},void 0),(!l||!e.camera)&&n("div",{className:"video-avatar-image-container",children:[n("div",{className:"video-avatar-image-blur-bg",style:{backgroundImage:`url(${e.avatar})`}},void 0,!1,{fileName:j,lineNumber:47,columnNumber:21},void 0),n("img",{alt:e.name,className:"video-avatar-image",draggable:!1,src:e.avatar},void 0,!1,{fileName:j,lineNumber:51,columnNumber:21},void 0)]},void 0,!0,{fileName:j,lineNumber:46,columnNumber:17},void 0),n("div",{className:"video-avatar-bottom",children:[n("h1",{className:"video-avatar-user-name",title:e.name,children:e.name},void 0,!1,{fileName:j,lineNumber:60,columnNumber:17},void 0),n("div",{className:"video-avatar-media-ctrl",children:[n("button",{className:A("video-avatar-media-ctrl-btn",{"is-muted":!e.camera}),disabled:m,onClick:()=>{(t||s===e.userUUID)&&a(e.userUUID,!e.camera,e.mic)},children:e.camera?n(ta,{},void 0,!1,{fileName:j,lineNumber:79,columnNumber:46},void 0):n(sa,{},void 0,!1,{fileName:j,lineNumber:79,columnNumber:62},void 0)},void 0,!1,{fileName:j,lineNumber:64,columnNumber:21},void 0),n("button",{className:A("video-avatar-media-ctrl-btn",{"is-muted":!e.mic}),disabled:o,onClick:()=>{(t||s===e.userUUID)&&a(e.userUUID,e.camera,!e.mic)},children:e.mic?n(_a,{getVolumeLevel:r},void 0,!1,{fileName:j,lineNumber:97,columnNumber:29},void 0):n(na,{},void 0,!1,{fileName:j,lineNumber:99,columnNumber:29},void 0)},void 0,!1,{fileName:j,lineNumber:81,columnNumber:21},void 0)]},void 0,!0,{fileName:j,lineNumber:63,columnNumber:17},void 0)]},void 0,!0,{fileName:j,lineNumber:59,columnNumber:13},void 0)]},void 0,!0,{fileName:j,lineNumber:43,columnNumber:9},void 0)},Fa="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 108 95'%3e%3cdefs%3e%3clinearGradient id='a' x1='50%25' x2='50%25' y1='99.443%25' y2='0%25'%3e%3cstop offset='0%25' stop-color='%23444E60' stop-opacity='0'/%3e%3cstop offset='100%25' stop-color='%23444E60'/%3e%3c/linearGradient%3e%3c/defs%3e%3cpath fill='url(%23a)' fill-rule='evenodd' d='M18 154.798c0-14.195 8.629-27.005 21.9-32.58l.404-.167 17.59-7.144c2.816-1.144 4.761-3.705 5.083-6.666L63 108l-3.886-3.768a17.685 17.685 0 0 1-5.368-11.653l-.018-.357-.219-.239a12.068 12.068 0 0 1-2.987-6.598l-.034-.32-.047-.505a3.442 3.442 0 0 1-.014-.317c0-1.882 1.51-3.417 3.405-3.503l.168-.004v-3.072c0-9.658 7.899-17.506 17.702-17.662L72 60c9.941 0 18 7.908 18 17.664v3.072c1.974 0 3.573 1.57 3.573 3.507 0 .106-.004.212-.014.317l-.047.506a12.062 12.062 0 0 1-3.021 6.917l-.22.24c-.174 4.529-2.1 8.823-5.385 12.009L81 108c.233 2.966 1.99 5.602 4.644 7.003l17.66 7.048c13.585 5.422 22.516 18.304 22.693 32.667l.003.436V156H18v-1.202z' opacity='.16' transform='translate(-18 -60)'/%3e%3c/svg%3e";var ot="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/VideoAvatarAbsent/index.tsx";const Pa=({small:i,isAvatarUserCreator:e})=>{const t=C();return n("div",{className:A("video-avatar-absent",{"is-small":i}),children:[n("img",{className:"video-avatar-absent-img",draggable:!1,src:Fa},void 0,!1,{fileName:ot,lineNumber:20,columnNumber:13},void 0),n("span",{className:"video-avatar-absent-content",children:t(`${e?"teacher":"student"}-left-temporarily`)},void 0,!1,{fileName:ot,lineNumber:21,columnNumber:13},void 0)]},void 0,!0,{fileName:ot,lineNumber:19,columnNumber:9},void 0)};var qt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/RaiseHand/index.tsx";const Aa=({isRaiseHand:i,disableHandRaising:e,onRaiseHandChange:t})=>{const s=C();return e?null:n("button",{className:"raise-hand-btn",title:s("raise-your-hand"),onClick:t,children:n(aa,{active:i},void 0,!1,{fileName:qt,lineNumber:22,columnNumber:13},void 0)},void 0,!1,{fileName:qt,lineNumber:21,columnNumber:9},void 0)},La=Ei(qi,1),Ha="data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 40 40'%3e%3ccircle cx='20' cy='20' r='19.5' stroke='white'/%3e%3cpath fill='white' d='M8 8h24v24H8z' opacity='.01'/%3e%3cpath fill='white' d='M15 16.375h-1v1.25h1v-1.25ZM12.375 18v8h1.25v-8h-1.25ZM14 27.625h12v-1.25H14v1.25ZM27.625 26v-8h-1.25v8h1.25ZM26 16.375h-1v1.25h1v-1.25ZM27.625 18c0-.898-.727-1.625-1.625-1.625v1.25c.207 0 .375.168.375.375h1.25ZM26 27.625c.898 0 1.625-.727 1.625-1.625h-1.25a.375.375 0 0 1-.375.375v1.25ZM12.375 26c0 .898.727 1.625 1.625 1.625v-1.25a.375.375 0 0 1-.375-.375h-1.25ZM14 16.375c-.898 0-1.625.727-1.625 1.625h1.25c0-.207.168-.375.375-.375v-1.25Z'/%3e%3cpath stroke='white' stroke-linejoin='round' stroke-width='1.25' d='M20 13v9m-3-3 3 3 3-3'/%3e%3c/svg%3e";var Y="/Users/yl/github-repo/openflat/packages/flat-components/src/components/SaveAnnotationModal/index.tsx";function Wa(i,e="annotation.png",t="Save image failed"){try{const s=document.createElement("a");s.download=e,s.href=i.toDataURL(),s.click()}catch(s){console.error(s),K.error(t)}}const Oa=({visible:i,onClose:e,images:t})=>{const s=C();return n(le,{closable:!0,destroyOnClose:!0,footer:null,open:i,title:s("annotation.save-action"),width:640,wrapClassName:"save-annotation-modal-container",onCancel:e,children:t.map((a,r)=>n($a,{failText:s("annotation.save-failed"),filename:`annotation-${r+1}.png`,footerText:String(r+1),image:a},r,!1,{fileName:Y,lineNumber:53,columnNumber:17},void 0))},void 0,!1,{fileName:Y,lineNumber:42,columnNumber:9},void 0)},$a=Ae.memo(function({image:e,filename:t="annotation.png",footerText:s,failText:a="Save image failed"}){const r=Xe(),l=C(),m=h.exports.useRef(null),[o,c]=h.exports.useState(!0),[u,f]=h.exports.useState(null);h.exports.useEffect(()=>{r(e).then(N=>{f(N),c(!1)})},[e,r]),h.exports.useEffect(()=>{const N=m.current;!N||(u?N.appendChild(u):N.firstChild&&N.removeChild(N.firstChild))},[u]);const g=h.exports.useCallback(()=>{u&&Wa(u,t,a)},[u,a,t]);return n("div",{className:A("save-annotation",{"is-loading":!u}),title:l("save"),onClick:g,children:[o&&n("div",{className:"save-annotation-loader",children:n(Ss,{indicator:n(Bs,{spin:!0},void 0,!1,{fileName:Y,lineNumber:119,columnNumber:38},this),size:"large"},void 0,!1,{fileName:Y,lineNumber:119,columnNumber:21},this)},void 0,!1,{fileName:Y,lineNumber:118,columnNumber:17},this),n("div",{ref:m,className:"save-annotation-image"},void 0,!1,{fileName:Y,lineNumber:122,columnNumber:13},this),n("div",{className:"save-annotation-mask"},void 0,!1,{fileName:Y,lineNumber:123,columnNumber:13},this),n("div",{className:"save-annotation-actions",children:n("img",{alt:"download",src:Ha,title:l("save")},void 0,!1,{fileName:Y,lineNumber:125,columnNumber:17},this)},void 0,!1,{fileName:Y,lineNumber:124,columnNumber:13},this),n("div",{className:"save-annotation-footer",children:s},void 0,!1,{fileName:Y,lineNumber:127,columnNumber:13},this)]},void 0,!0,{fileName:Y,lineNumber:110,columnNumber:9},this)});var ja="/Users/yl/github-repo/openflat/packages/flat-components/src/components/PresetsModal/Thumbnail.tsx";const Za=Ae.memo(function(e){const t=Xe(),s=h.exports.useRef(null);return h.exports.useEffect(()=>{t(Ba(e.image)).then(a=>{const r=s.current;r&&Va(r,a,e.width,e.height)}).catch(console.error)},[e.height,e.image,e.width,t]),n("canvas",{ref:s},void 0,!1,{fileName:ja,lineNumber:26,columnNumber:12},this)});function Va(i,e,t,s){i.width=t,i.height=s;const a=i.getContext("2d");if(a){const r=e.width/e.height;if(r>1){const l=s/r;a.drawImage(e,0,(s-l)/2,t,l)}else{const l=t*r;a.drawImage(e,(t-l)/2,0,l,s)}}}function Ba(i){return new Promise((e,t)=>{const s=new Image;s.onload=()=>e(s),s.onerror=t,s.src=i})}var de="/Users/yl/github-repo/openflat/packages/flat-components/src/components/PresetsModal/index.tsx";const za=280,Ga=200,Ya=({visible:i,images:e,onClick:t,onClose:s})=>{const a=C();return n(le,{closable:!0,footer:null,open:i,title:a("presets.title"),width:640,wrapClassName:"presets-modal-container",onCancel:s,children:e.map(({src:r,i18nKey:l})=>n("div",{className:"presets-modal-item",children:[n("button",{className:"presets-modal-btn",title:a(l),onClick:()=>t(r),children:[n(Za,{height:Ga,image:r,width:za},void 0,!1,{fileName:de,lineNumber:50,columnNumber:25},void 0),n("div",{className:"presets-modal-mask",children:n(ra,{},void 0,!1,{fileName:de,lineNumber:52,columnNumber:29},void 0)},void 0,!1,{fileName:de,lineNumber:51,columnNumber:25},void 0)]},void 0,!0,{fileName:de,lineNumber:45,columnNumber:21},void 0),n("div",{className:"presets-modal-text",children:a(l)},void 0,!1,{fileName:de,lineNumber:55,columnNumber:21},void 0)]},l,!0,{fileName:de,lineNumber:44,columnNumber:17},void 0))},void 0,!1,{fileName:de,lineNumber:34,columnNumber:9},void 0)};var lt="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/CloudRecordBtn/index.tsx";const Pr=y(({loading:i,isRecording:e,onClick:t})=>{const s=C();return n(_t,{disabled:i,icon:e?n(la,{active:!0},void 0,!1,{fileName:lt,lineNumber:21,columnNumber:37},void 0):n(oa,{},void 0,!1,{fileName:lt,lineNumber:21,columnNumber:64},void 0),title:s("recording"),onClick:t},void 0,!1,{fileName:lt,lineNumber:19,columnNumber:13},void 0)});var ct="/Users/yl/github-repo/openflat/packages/flat-components/src/components/ClassroomPage/Timer/index.tsx";const mt=i=>String(i).padStart(2,"0"),Ja=(i,e)=>{const[t,s]=h.exports.useState(Date.now()),a=zs();return h.exports.useEffect(()=>{let r=NaN;if(!a.current){if(e===Ke.Started){const l=()=>{s(Math.floor(Date.now()/1e3)*1e3),r=window.requestAnimationFrame(l)};l()}return()=>{window.cancelAnimationFrame(r)}}},[e,a]),h.exports.useMemo(()=>{const{days:r=0,hours:l=0,minutes:m=0,seconds:o=0}=La({start:i,end:t}),c=`${mt(m)}:${mt(o)}`,u=l+r*24;return u>0?`${mt(u)}:${c}`:c},[i,t])},Ar=({roomStatus:i=Ke.Paused,beginTime:e})=>{const t=Ja(e,i),s=C();return n("span",{className:"timer-bar",children:[n("span",{className:`timer-${i}`,children:s("room-started")},void 0,!1,{fileName:ct,lineNumber:69,columnNumber:13},void 0),n("span",{className:"timer-text",children:t},void 0,!1,{fileName:ct,lineNumber:70,columnNumber:13},void 0)]},void 0,!0,{fileName:ct,lineNumber:68,columnNumber:9},void 0)};class qa{constructor(e){d(this,"roomUUID");d(this,"userUUID");d(this,"ownerUUID");d(this,"cachedUsers",Z.map());d(this,"creator",null);d(this,"currentUser",null);d(this,"speakingJoiners",Z.array([]));d(this,"handRaisingJoiners",Z.array([]));d(this,"otherJoiners",Z.array([]));d(this,"isInRoom");d(this,"initUsers",async e=>{this.otherJoiners.clear(),this.speakingJoiners.clear(),this.handRaisingJoiners.clear(),(await this.createUsers(e)).forEach(s=>{this.sortUser(s),this.cacheUser(s)})});d(this,"addUser",async e=>{this.cachedUsers.has(e)&&this.removeUser(e);const[t]=await this.createUsers([e]);return this.cacheUser(t),this.sortUser(t),t});d(this,"removeUser",e=>{if(this.creator&&this.creator.userUUID===e)this.creator.hasLeft=!0,this.creator=null;else for(const{group:t}of this.joinerGroups)for(let s=0;s<this[t].length;s++)if(this[t][s].userUUID===e){this[t][s].hasLeft=!0,this[t].splice(s,1);break}});d(this,"updateUsers",e=>{const t=Te("editUser",e),s=[];let a=!1;this.creator&&(a=t(this.creator)===!1);for(const{group:r,shouldMoveOut:l}of this.joinerGroups){if(a)break;for(let m=0;m<this[r].length&&!a;m++){const o=this[r][m];a=t(o)===!1,l(o)&&(this[r].splice(m,1),m--,s.push(o))}}s.forEach(this.sortUser)});d(this,"syncExtraUsersInfo",async e=>{const t=await this.createUsers(e.filter(s=>!this.cachedUsers.has(s)));for(const s of t)this.cacheUser(s)});d(this,"pickRandomJoiner",()=>{const e=Math.floor(Math.random()*this.joiners.length);for(let t=0;t<this.joiners.length;t++){const s=this.joiners[(e+t)%this.joiners.length];if(s&&s.userUUID!==this.userUUID)return s}});d(this,"sortUser",e=>{if(e.userUUID===this.userUUID&&(this.currentUser=e),e.userUUID===this.ownerUUID)this.creator=e;else if(e.isSpeak){const t=this.speakingJoiners.findIndex(({userUUID:s})=>s===e.userUUID);t>=0&&this.speakingJoiners.splice(t,1),this.speakingJoiners.push(e)}else if(e.isRaiseHand){const t=this.handRaisingJoiners.findIndex(({userUUID:s})=>s===e.userUUID);t>=0&&this.handRaisingJoiners.splice(t,1),this.handRaisingJoiners.push(e)}else this.otherJoiners.push(e)});d(this,"joinerGroups",[{group:"speakingJoiners",shouldMoveOut:e=>!e.isSpeak},{group:"handRaisingJoiners",shouldMoveOut:e=>!e.isRaiseHand},{group:"otherJoiners",shouldMoveOut:e=>e.isRaiseHand||e.isSpeak}]);this.roomUUID=e.roomUUID,this.userUUID=e.userUUID,this.ownerUUID=e.ownerUUID,this.isInRoom=e.isInRoom,Qe(this)}get joiners(){return[...this.speakingJoiners,...this.handRaisingJoiners,...this.otherJoiners]}get totalUserCount(){return(this.creator?1:0)+(this.speakingJoiners.length+this.handRaisingJoiners.length+this.otherJoiners.length)}get isCreator(){return this.ownerUUID===this.userUUID}cacheUser(e){this.cachedUsers.set(e.userUUID,e)}async createUsers(e){if(e=[...new Set(e)],e.length<=0)return[];const t=await Gs({roomUUID:this.roomUUID,usersUUID:e});return e.map(s=>Z.object({userUUID:s,rtcUID:String(t[s].rtcUID),avatar:t[s].avatarURL,name:t[s].name,camera:s===this.userUUID?re.autoCameraOn:!1,mic:s===this.userUUID?re.autoMicOn:!1,isSpeak:s===this.userUUID&&this.isCreator,isRaiseHand:!1,hasLeft:!this.isInRoom(s)}))}}class Xa{constructor(e){d(this,"sideEffect",new It);d(this,"messages",Z.array([]));d(this,"rtm");d(this,"newMessage",e=>{const t=Date.now();let s=0;for(;s<this.messages.length&&this.messages[s].timestamp<=t;)s++;this.messages.splice(s,0,e),this.onNewMessage(e)});this.rtm=e.rtm,Qe(this,{rtm:Z.ref,sideEffect:!1}),e.isShowUserGuide&&this.messages.every(t=>t.type!=="user-guide")&&oe(()=>{this.messages.push({type:"user-guide",uuid:"user-guide",timestamp:Date.now(),roomUUID:e.roomUUID,senderID:e.ownerUUID})}),this.sideEffect.addDisposer(this.rtm.events.on("room-message",t=>{this.newMessage({type:"room-message",...t})})),this.sideEffect.addDisposer(this.rtm.events.on("notice",t=>{this.newMessage({type:"notice",...t})})),this.sideEffect.addDisposer(this.rtm.events.on("ban",t=>{this.newMessage({type:"ban",...t})}))}destroy(){this.sideEffect.flushAll()}onNewMessage(e){}}let ut,Xt=!0,Kt=!0;class dt{constructor(e,t,s,a){const{readable:r,writable:l}=t,{options:m,config:o,streamOptions:c,useWebWorkers:u,transferStreams:f,scripts:g}=s;Object.assign(e,{busy:!0,readable:r,writable:l,options:Object.assign({},m),scripts:g,transferStreams:f,terminate(){e.worker&&!e.busy&&(e.worker.terminate(),e.interface=null)},onTaskFinished(){e.busy=!1,a(e)}});const{signal:N,onstart:v,onprogress:p,size:b,onend:w}=c;let S=0;const E={};return v&&(E.start=()=>ht(v,b)),E.transform=async(L,_)=>{S+=L.length,p&&await ht(p,S,b),_.enqueue(L)},E.flush=()=>{r.size=S,w&&ht(w,S)},e.readable=r.pipeThrough(new TransformStream(E,{highWaterMark:1,size:()=>o.chunkSize}),{signal:N}),ut===void 0&&(ut=typeof Worker<"u"),u&&ut?Qa(e,o):Ka(e,o)}}async function ht(i,...e){try{await i(...e)}catch{}}function Ka(i,e){const t=new Ys(i.readable,i.writable,i.options,e),{onTaskFinished:s}=i;return{async run(){try{return await t.run()}finally{s()}}}}function Qa(i,{baseURL:e,chunkSize:t}){const s={type:"module"};if(Object.assign(i,{streams:{},result:new Promise((o,c)=>{i.resolveResult=o,i.rejectResult=c})}),!i.interface){if(!Xt)i.worker=r(s);else try{i.worker=r({})}catch{Xt=!1,i.worker=r(s)}i.worker.addEventListener(Js,m,!1),i.interface={run(){const{readable:o,writable:c,options:u}=i,f=i.scripts.slice(1),g={type:Qs,scripts:f,options:u,config:{chunkSize:t}};return i.transferStreams&&Kt?l({...g,readable:o,writable:c})||(Kt=!1,a(o,c)):(l(g),a(o,c)),i.result}}}return i.interface;function a(o,c){Object.assign(i.streams,{reader:o.getReader(),writer:c.getWriter()})}function r(o){let c,u;c=i.scripts[0],typeof c=="function"&&(c=c());try{u=new URL(c,e)}catch{u=c}return new Worker(u,o)}function l(o){const{worker:c,writer:u,onTaskFinished:f}=i;try{let{data:g,readable:N,writable:v}=o;const p=[];if(g){const{buffer:b,length:w}=g;w!=b.byteLength&&(g=new Uint8Array(g)),o.data=g.buffer,p.push(o.data)}if(N&&p.push(N),v&&p.push(v),p.length)try{return c.postMessage(o,p),!0}catch{o.readable=o.writable=null,c.postMessage(o)}else c.postMessage(o)}catch(g){throw u&&u.releaseLock(),f(),g}}async function m(o){const c=o.data,{resolveResult:u,rejectResult:f,onTaskFinished:g}=i,{reader:N,writer:v}=i.streams,{type:p,data:b,messageId:w,result:S}=c,E=c.error;try{if(E){const{message:_,stack:I,code:D,name:T}=E,W=new Error(_);Object.assign(W,{stack:I,code:D,name:T}),L(W)}else{if(p==qs){const{value:_,done:I}=await N.read();l({type:Lt,data:_,done:I,messageId:w})}p==Lt&&(await v.ready,await v.write(new Uint8Array(b)),l({type:Xs,messageId:w})),p==Ks&&L(null,S)}}catch(_){L(_)}function L(_,I){_?f(_):u(I),v&&v.releaseLock(),g()}}}let he=[];const ft=[];let Qt=0;async function en(i,e){const{options:t,config:s}=e,{transferStreams:a,useWebWorkers:r,useCompressionStream:l,codecType:m,compressed:o,signed:c,encrypted:u}=t,{workerScripts:f}=s;e.transferStreams=a||a===void 0;const g=!o&&!c&&!u&&!e.transferStreams;e.useWebWorkers=!g&&(r||r===void 0&&s.useWebWorkers),e.scripts=e.useWebWorkers&&f?f[m]:[],t.useCompressionStream=l||l===void 0&&s.useCompressionStream;let N;if(he.length<s.maxWorkers){const p={indexWorker:Qt};Qt++,he.push(p),N=new dt(p,i,e,v)}else{const p=he.find(b=>!b.busy);p?(es(p),N=new dt(p,i,e,v)):N=await new Promise(b=>ft.push({resolve:b,stream:i,workerOptions:e}))}return N.run();function v(p){if(ft.length){const[{resolve:b,stream:w,workerOptions:S}]=ft.splice(0,1);b(new dt(p,w,S,v))}else if(p.worker){const{terminateWorkerTimeout:b}=s;es(p),Number.isFinite(b)&&b>=0&&(p.terminateTimeout=setTimeout(()=>{he=he.filter(w=>w!=p),p.terminate()},b))}else he=he.filter(b=>b!=p)}}function es(i){const{terminateTimeout:e}=i;e&&(clearTimeout(e),i.terminateTimeout=null)}const tn=64*1024;class xs{constructor(){this.size=0}init(){this.initialized=!0}}class sn extends xs{get readable(){const e=this,{chunkSize:t=tn}=e,s=new ReadableStream({start(){this.chunkOffset=0},async pull(a){const{offset:r=0,size:l}=s,{chunkOffset:m}=this;a.enqueue(await e.readUint8Array(r+m,Math.min(t,l-m))),m+t>l?a.close():this.chunkOffset+=t}});return s}}class Us extends sn{constructor(e){super(),this.blob=e,this.size=e.size}async readUint8Array(e,t){const s=this;return new Uint8Array(await s.blob.slice(e,e+t).arrayBuffer())}}class an extends xs{constructor(e){super();const t=this,s=new TransformStream,a=[];e&&a.push(["content-type",e]),Object.defineProperty(t,"writable",{get(){return s.writable}}),t.blob=new Response(s.readable,{headers:a}).blob()}getData(){return this.blob}}async function ys(i,e){i.init&&!i.initialized&&await i.init(e)}const Je=4294967295,ts=65535,nn=8,rn=0,on=99,ln=67324752,ss=33639248,cn=101010256,is=101075792,mn=117853008,je=22,gt=20,pt=56,un=1,dn=39169,hn=10,fn=1,gn=21589,pn=28789,vn=25461,as=1,Nn=6,ns=8,rs=2048,os=16,bn="/";function yt(i,e){return e&&e.trim().toLowerCase()=="cp437"?ei(i):new TextDecoder(e).decode(i)}const wn=["filename","rawFilename","directory","encrypted","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","signature","extraField","rawExtraField","bitFlag","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","filenameUTF8","commentUTF8","offset","zip64","compressionMethod","extraFieldNTFS","lastAccessDate","creationDate","extraFieldExtendedTimestamp","version","versionMadeBy","msDosCompatible","internalFileAttribute","externalFileAttribute"];class ls{constructor(e){wn.forEach(t=>this[t]=e[t])}}const vt="File format is not recognized",Sn="End of central directory not found",xn="End of Zip64 central directory not found",Un="End of Zip64 central directory locator not found",yn="Central directory header not found",Cn="Local file header not found",In="Zip64 extra field not found",Dn="File contains encrypted entry",kn="Encryption method not supported",cs="Compression method not supported",ms="utf-8",us="cp437",ds=["uncompressedSize","compressedSize","offset"];class Mn{constructor(e,t={}){e instanceof ReadableStream&&(e={readable:e}),Object.assign(this,{reader:e,options:t,config:ti()})}async*getEntriesGenerator(e={}){const t=this;let{reader:s}=t;const{config:a}=t;if(await ys(s),s.size===void 0||!s.readUint8Array){const I=await new Response(s.readable).blob();s=new Us(I)}if(s.size<je)throw new Error(vt);s.chunkSize=si(a);const r=await Pn(s,cn,s.size,je,ts*16);if(!r)throw new Error(Sn);const l=H(r);let m=F(l,12),o=F(l,16);const c=r.offset,u=$(l,20),f=c+je+u;let g=$(l,8),N=0,v=0;if(o==Je||m==Je||g==ts){const I=await J(s,r.offset-gt,gt),D=H(I);if(F(D,0)!=mn)throw new Error(xn);o=Ge(D,8);let T=await J(s,o,pt),W=H(T);const B=r.offset-gt-pt;if(F(W,0)!=is&&o!=B){const X=o;o=B,N=o-X,T=await J(s,o,pt),W=H(T)}if(F(W,0)!=is)throw new Error(Un);g=Ge(W,32),m=Ge(W,40),o-=m}if(o<0||o>=s.size)throw new Error(vt);let p=0,b=await J(s,o,m),w=H(b);if(m){const I=r.offset-m;if(F(w,p)!=ss&&o!=I){const D=o;o=I,N=o-D,b=await J(s,o,m),w=H(b)}}if(o<0||o>=s.size)throw new Error(vt);const S=q(t,e,"filenameEncoding"),E=q(t,e,"commentEncoding");for(let I=0;I<g;I++){const D=new En(s,a,t.options);if(F(w,p)!=ss)throw new Error(yn);Cs(D,w,p+6);const T=Boolean(D.bitFlag.languageEncodingFlag),W=p+46,B=W+D.filenameLength,X=B+D.extraFieldLength,U=$(w,p+4),k=(U&0)==0,R=b.subarray(W,B),se=$(w,p+32),ve=X+se,Ne=b.subarray(X,ve),be=T,Le=T,He=k&&(ye(w,p+38)&os)==os,We=F(w,p+42)+N;Object.assign(D,{versionMadeBy:U,msDosCompatible:k,compressedSize:0,uncompressedSize:0,commentLength:se,directory:He,offset:We,internalFileAttribute:$(w,p+36),externalFileAttribute:F(w,p+38),rawFilename:R,filenameUTF8:be,commentUTF8:Le,rawExtraField:b.subarray(B,X)});const[Tt,Ds]=await Promise.all([yt(R,be?ms:S||us),yt(Ne,Le?ms:E||us)]);Object.assign(D,{rawComment:Ne,filename:Tt,comment:Ds,directory:He||Tt.endsWith(bn)}),v=Math.max(We,v),await Is(D,D,w,p+6);const et=new ls(D);et.getData=(Pt,ks)=>D.getData(Pt,et,ks),p=ve;const{onprogress:Ft}=e;if(Ft)try{await Ft(I+1,g,new ls(D))}catch{}yield et}const L=q(t,e,"extractPrependedData"),_=q(t,e,"extractAppendedData");return L&&(t.prependedData=v>0?await J(s,0,v):new Uint8Array),t.comment=u?await J(s,c+je,u):new Uint8Array,_&&(t.appendedData=f<s.size?await J(s,f,s.size-f):new Uint8Array),!0}async getEntries(e={}){const t=[];for await(const s of this.getEntriesGenerator(e))t.push(s);return t}async close(){}}class En{constructor(e,t,s){Object.assign(this,{reader:e,config:t,options:s})}async getData(e,t,s={}){const a=this,{reader:r,offset:l,extraFieldAES:m,compressionMethod:o,config:c,bitFlag:u,signature:f,rawLastModDate:g,uncompressedSize:N,compressedSize:v}=a,p=a.localDirectory={};let b=await J(r,l,30);const w=H(b);let S=q(a,s,"password");if(S=S&&S.length&&S,m&&m.originalCompressionMethod!=on)throw new Error(cs);if(o!=rn&&o!=nn)throw new Error(cs);if(F(w,0)!=ln)throw new Error(Cn);Cs(p,w,4),b=await J(r,l,30+p.filenameLength+p.extraFieldLength),p.rawExtraField=b.subarray(30+p.filenameLength),await Is(a,p,w,4),Object.assign(t,{lastAccessDate:p.lastAccessDate,creationDate:p.creationDate});const E=a.encrypted&&p.encrypted,L=E&&!m;if(E){if(!L&&m.strength===void 0)throw new Error(kn);if(!S)throw new Error(Dn)}const _=l+30+p.filenameLength+p.extraFieldLength,I=r.readable;I.offset=_;const D=I.size=v;e instanceof WritableStream&&(e={writable:e});const{writable:T}=e;T.size===void 0&&(T.size=0);const W=q(a,s,"signal"),B=q(a,s,"preventClose");await ys(e,N);const{onstart:X,onprogress:U,onend:k}=s,R={options:{codecType:ii,password:S,zipCrypto:L,encryptionStrength:m&&m.strength,signed:q(a,s,"checkSignature"),passwordVerification:L&&(u.dataDescriptor?g>>>8&255:f>>>24&255),signature:f,compressed:o!=0,encrypted:E,useWebWorkers:q(a,s,"useWebWorkers"),useCompressionStream:q(a,s,"useCompressionStream"),transferStreams:q(a,s,"transferStreams"),preventClose:B},config:c,streamOptions:{signal:W,size:D,onstart:X,onprogress:U,onend:k}};if(T.size+=(await en({readable:I,writable:T},R)).size,!B)try{await T.close()}catch{}return e.getData?e.getData():T}}function Cs(i,e,t){const s=i.rawBitFlag=$(e,t+2),a=(s&as)==as,r=F(e,t+6);Object.assign(i,{encrypted:a,version:$(e,t),bitFlag:{level:(s&Nn)>>1,dataDescriptor:(s&ns)==ns,languageEncodingFlag:(s&rs)==rs},rawLastModDate:r,lastModDate:An(r),filenameLength:$(e,t+22),extraFieldLength:$(e,t+24)})}async function Is(i,e,t,s){const{rawExtraField:a}=e,r=e.extraField=new Map,l=H(new Uint8Array(a));let m=0;try{for(;m<a.length;){const p=$(l,m),b=$(l,m+2);r.set(p,{type:p,data:a.slice(m+4,m+4+b)}),m+=4+b}}catch{}const o=$(t,s+4);Object.assign(e,{signature:F(t,s+10),uncompressedSize:F(t,s+18),compressedSize:F(t,s+14)});const c=r.get(un);c&&(Rn(c,e),e.extraFieldZip64=c);const u=r.get(pn);u&&(await hs(u,"filename","rawFilename",e,i),e.extraFieldUnicodePath=u);const f=r.get(vn);f&&(await hs(f,"comment","rawComment",e,i),e.extraFieldUnicodeComment=f);const g=r.get(dn);g?(_n(g,e,o),e.extraFieldAES=g):e.compressionMethod=o;const N=r.get(hn);N&&(Tn(N,e),e.extraFieldNTFS=N);const v=r.get(gn);v&&(Fn(v,e),e.extraFieldExtendedTimestamp=v)}function Rn(i,e){e.zip64=!0;const t=H(i.data);i.values=[];for(let a=0;a<Math.floor(i.data.length/8);a++)i.values.push(Ge(t,0+a*8));const s=ds.filter(a=>e[a]==Je);for(let a=0;a<s.length;a++)i[s[a]]=i.values[a];ds.forEach(a=>{if(e[a]==Je)if(i[a]!==void 0)e[a]=i[a];else throw new Error(In)})}async function hs(i,e,t,s,a){const r=H(i.data),l=new ai;l.append(a[t]);const m=H(new Uint8Array(4));m.setUint32(0,l.get(),!0),Object.assign(i,{version:ye(r,0),signature:F(r,1),[e]:await yt(i.data.subarray(5)),valid:!a.bitFlag.languageEncodingFlag&&i.signature==F(m,0)}),i.valid&&(s[e]=i[e],s[e+"UTF8"]=!0)}function _n(i,e,t){const s=H(i.data),a=ye(s,4);Object.assign(i,{vendorVersion:ye(s,0),vendorId:ye(s,2),strength:a,originalCompressionMethod:t,compressionMethod:$(s,5)}),e.compressionMethod=i.compressionMethod}function Tn(i,e){const t=H(i.data);let s=4,a;try{for(;s<i.data.length&&!a;){const r=$(t,s),l=$(t,s+2);r==fn&&(a=i.data.slice(s+4,s+4+l)),s+=4+l}}catch{}try{if(a&&a.length==24){const r=H(a),l=r.getBigUint64(0,!0),m=r.getBigUint64(8,!0),o=r.getBigUint64(16,!0);Object.assign(i,{rawLastModDate:l,rawLastAccessDate:m,rawCreationDate:o});const c=Nt(l),u=Nt(m),f=Nt(o),g={lastModDate:c,lastAccessDate:u,creationDate:f};Object.assign(i,g),Object.assign(e,g)}}catch{}}function Fn(i,e){const t=H(i.data),s=ye(t,0),a=[],r=[];(s&1)==1&&(a.push("lastModDate"),r.push("rawLastModDate")),(s&2)==2&&(a.push("lastAccessDate"),r.push("rawLastAccessDate")),(s&4)==4&&(a.push("creationDate"),r.push("rawCreationDate"));let l=1;a.forEach((m,o)=>{if(i.data.length>=l+4){const c=F(t,l);e[m]=i[m]=new Date(c*1e3);const u=r[o];i[u]=c}l+=4})}async function Pn(i,e,t,s,a){const r=new Uint8Array(4),l=H(r);Ln(l,0,e);const m=s+a;return await o(s)||await o(Math.min(m,t));async function o(c){const u=t-c,f=await J(i,u,c);for(let g=f.length-s;g>=0;g--)if(f[g]==r[0]&&f[g+1]==r[1]&&f[g+2]==r[2]&&f[g+3]==r[3])return{offset:u+g,buffer:f.slice(g,g+s).buffer}}}function q(i,e,t){return e[t]===void 0?i.options[t]:e[t]}function An(i){const e=(i&4294901760)>>16,t=i&65535;try{return new Date(1980+((e&65024)>>9),((e&480)>>5)-1,e&31,(t&63488)>>11,(t&2016)>>5,(t&31)*2,0)}catch{}}function Nt(i){return new Date(Number(i/BigInt(1e4)-BigInt(116444736e5)))}function ye(i,e){return i.getUint8(e)}function $(i,e){return i.getUint16(e,!0)}function F(i,e){return i.getUint32(e,!0)}function Ge(i,e){return Number(i.getBigUint64(e,!0))}function Ln(i,e,t){i.setUint32(e,t,!0)}function H(i){return new DataView(i.buffer)}function J(i,e,t){return i.readUint8Array(e,t)}class qe{constructor(){d(this,"downloaders",new Map)}async preload(e){const t=qe.parsePPTURLInfo(e),{baseURL:s,pptType:a,taskUUID:r}=t;if(this.downloaders.has(r))return;const l=await Hi(t);this.downloaders.set(r,l);const m=`${s}/${a}Convert`;return qe.unzip(l,m)}static parsePPTURLInfo(e){const t=/^(\S+)\/(static|dynamic)Convert\/([0-9a-f]{32})\//.exec(e);if(!t)throw new Error("parse ppt url failed.");const[,s,a,r]=t;return{baseURL:s.replace(/^pptx:\/\//,"https://"),pptType:a,taskUUID:r}}static async unzip(e,t){const a=await new Mn(new Us(e)).getEntries();for(const r of a){if(!r.getData||r.filename.endsWith(".mp4"))continue;const l=await r.getData(new an),m=`${t}/${r.filename}`;await this.cacheEntry(m,l)}}static async cacheEntry(e,t){const s=await ni(),a=new Response(t,{headers:{"Content-Type":ri(e)}});s.put(e,a)}}const Hn=new qe;class Wn{constructor(e){d(this,"sideEffect",new It);d(this,"whiteboard");d(this,"fastboardAPP",null);d(this,"room",null);d(this,"phase",Ye.Connecting);d(this,"viewMode",null);d(this,"windowManager",null);d(this,"isWritable");d(this,"isShowPreviewPanel",!1);d(this,"isFileOpen",!1);d(this,"isKicked",!1);d(this,"isRightSideClose",!1);d(this,"currentSceneIndex",0);d(this,"scenesCount",0);d(this,"isCreator");d(this,"getRoomType");d(this,"onDrop");d(this,"cloudStorageStore");d(this,"updateFastboardAPP",e=>{this.fastboardAPP=e});d(this,"updateRoom",e=>{this.room=e});d(this,"updateWindowManager",e=>{this.windowManager=e});d(this,"updateWritable",async e=>{this.isWritable=e,this.whiteboard.setAllowDrawing(e)});d(this,"setFileOpen",e=>{this.isFileOpen=e});d(this,"toggleFileOpen",()=>{this.isFileOpen=!this.isFileOpen});d(this,"showPreviewPanel",()=>{this.isShowPreviewPanel=!0});d(this,"setPreviewPanel",e=>{this.isShowPreviewPanel=e});d(this,"setRightSideClose",e=>{this.isRightSideClose=e});d(this,"preloadPPTResource",Oi(async e=>{await Hn.preload(e)},2e3));d(this,"insertCourseware",async e=>{var s;if(((s=e.meta.whiteboardConvert||e.meta.whiteboardProjector)==null?void 0:s.convertStep)===ci.Converting){K.warn(Pe.t("in-the-process-of-transcoding-tips"));return}e.resourceType!==mi.Directory&&K.info(Pe.t("inserting-courseware-tips"));const t=await Dt.getInstance().requestService("file");if(!t){K.error(Pe.t("unable-to-insert-courseware"));return}await t.insert(e),this.cloudStorageStore.onCoursewareInserted&&this.cloudStorageStore.onCoursewareInserted()});this.whiteboard=e.whiteboard,this.isCreator=e.isCreator,this.isWritable=e.isWritable,this.getRoomType=e.getRoomType,this.onDrop=e.onDrop,Qe(this,{room:Z.ref,preloadPPTResource:!1,fastboardAPP:!1,sideEffect:!1,whiteboard:!1}),this.whiteboard.setAllowDrawing(this.isWritable),this.cloudStorageStore=new _i({compact:!0,insertCourseware:this.insertCourseware}),this.sideEffect.push([e.whiteboard.events.on("kicked",()=>{this.isCreator||oe(()=>{this.isKicked=!0})}),e.whiteboard.$Val.phase$.subscribe(()=>{const t=this.getRoom();t&&oe(()=>{this.phase=t.phase})})])}async joinWhiteboardRoom(){var a,r,l;if(!M.userUUID)throw new Error("Missing userUUID");if(!M.whiteboardRoomUUID||!M.whiteboardRoomToken)throw new Error("Missing Whiteboard UUID and Token");await this.whiteboard.joinRoom({roomID:M.whiteboardRoomUUID,roomToken:M.whiteboardRoomToken,region:(a=M.region)!=null?a:oi.CN_HZ,uid:M.userUUID,nickName:(l=(r=M.userInfo)==null?void 0:r.name)!=null?l:M.userUUID,classroomType:this.getRoomType(),options:{strokeTail:re.strokeTail,ratio:Wi}});const e=await this.whiteboard._app$.value;this.updateFastboardAPP(e);const{room:t,manager:s}=e;return this.updateRoom(t),this.updateWindowManager(s),this.scrollToTopOnce(),window.room=t,window.manager=s,e}scrollToTopOnce(){const{room:e,windowManager:t}=this;!e||!t||!e.isWritable||(!e.state.globalState||!e.state.globalState.scrollToTop)&&(e.setGlobalState({scrollToTop:!0}),t.moveCamera({centerY:-950,animationMode:li.Immediately}))}async destroy(){this.sideEffect.flushAll(),this.preloadPPTResource.cancel(),await this.whiteboard.destroy(),window.room=null,window.manager=null,console.log(`Whiteboard unloaded: ${M.whiteboardRoomUUID}`)}getSaveAnnotationImages(){return this.whiteboard.exportAnnotations()}getRoom(){var e,t;return(t=(e=this.whiteboard._app$.value)==null?void 0:e.room)!=null?t:null}}var Fe=(i=>(i.Lecture="Lecture",i.Interaction="Interaction",i))(Fe||{}),ge=(i=>(i[i.Null=0]="Null",i[i.Starting=1]="Starting",i[i.Pausing=2]="Pausing",i[i.Stopping=3]="Stopping",i))(ge||{});class On{constructor(e){d(this,"sideEffect",new It);d(this,"roomUUID");d(this,"ownerUUID");d(this,"userUUID");d(this,"classMode");d(this,"isBan",!1);d(this,"isRecording",!1);d(this,"isRecordingLoading",!1);d(this,"isRemoteLogin",!1);d(this,"isCloudStoragePanelVisible",!1);d(this,"roomStatusLoading",ge.Null);d(this,"isJoinedRTC",!1);d(this,"isScreenSharing",!1);d(this,"isRemoteScreenSharing",!1);d(this,"shareScreenInfo",[]);d(this,"selectedScreenInfo",null);d(this,"shareScreenPickerVisible",!1);d(this,"networkQuality",{delay:0,uplink:0,downlink:0});d(this,"deviceStateStorage");d(this,"classroomStorage");d(this,"onStageUsersStorage");d(this,"users");d(this,"onStageUserUUIDs",Z.array());d(this,"rtc");d(this,"rtm");d(this,"chatStore");d(this,"whiteboardStore");d(this,"recording");d(this,"startClass",()=>this.switchRoomStatus(G.Started));d(this,"pauseClass",()=>this.switchRoomStatus(G.Paused));d(this,"stopClass",()=>this.switchRoomStatus(G.Stopped));d(this,"hangClass",async()=>{await new Promise(e=>setTimeout(e,200))});d(this,"toggleCloudStoragePanel",e=>{this.isCloudStoragePanelVisible=e});d(this,"onDrop",e=>{this.toggleCloudStoragePanel(!0);const t=this.whiteboardStore.cloudStorageStore;t.setPanelExpand(!0),t.uploadTaskManager.addTasks([e],t.parentDirectoryPath)});d(this,"onMessageSend",async e=>{this.isBan&&!this.isCreator||!(await Ai({text:e})).valid||await this.rtm.sendRoomMessage(e)});d(this,"toggleRecording",async({onStop:e}={})=>{this.isRecordingLoading=!0;try{this.isRecording?(await this.stopRecording(),e==null||e()):await this.startRecording()}catch(t){Ce(t)}oe(()=>{this.isRecordingLoading=!1})});d(this,"updateRecordingLayout",e=>{this.isRecording&&this.recording.updateLayout(e)});d(this,"updateClassMode",e=>{var t;this.classMode=e!=null?e:((t=this.roomInfo)==null?void 0:t.roomType)===Ie.SmallClass?Fe.Interaction:Fe.Lecture});d(this,"updateRoomStatus",e=>{this.roomInfo&&this.roomInfo.roomStatus!==e&&(this.roomInfo.roomStatus=e,this.isCreator&&this.rtm.sendRoomCommand("update-room-status",{roomUUID:this.roomUUID,status:e}))});d(this,"updateShareScreen",(e,t)=>{this.isScreenSharing=e,this.isRemoteScreenSharing=t});d(this,"refreshShareScreenInfo",async()=>{this.selectShareScreenInfo(null),this.shareScreenInfo=[];const e=await this.rtc.shareScreen.getScreenInfo();oe(()=>{this.shareScreenInfo=e})});d(this,"toggleShareScreenPicker",(e=!this.shareScreenPickerVisible)=>{this.shareScreenPickerVisible=e});d(this,"selectShareScreenInfo",e=>{this.selectedScreenInfo=e,this.rtc.shareScreen.setScreenInfo(e)});d(this,"toggleShareScreen",(e=!this.isScreenSharing)=>{this.rtc.shareScreen.enable(e),this.toggleShareScreenPicker(!1)});d(this,"acceptRaiseHand",e=>{var t;this.isCreator&&((t=this.classroomStorage)==null?void 0:t.isWritable)&&this.classroomStorage.state.raiseHandUsers.includes(e)&&(this.classroomStorage.setState({raiseHandUsers:this.classroomStorage.state.raiseHandUsers.filter(s=>s!==e)}),this.onStaging(e,!0))});d(this,"onCancelAllHandRaising",()=>{var e;this.isCreator&&((e=this.classroomStorage)==null?void 0:e.isWritable)&&this.classroomStorage.setState({raiseHandUsers:[]})});d(this,"onToggleHandRaising",()=>{var e;this.isCreator||((e=this.users.currentUser)==null?void 0:e.isSpeak)||this.users.currentUser&&this.rtm.sendPeerCommand("raise-hand",{roomUUID:this.roomUUID,raiseHand:!this.users.currentUser.isRaiseHand},this.ownerUUID)});d(this,"onToggleBan",()=>{var e;this.isCreator&&((e=this.classroomStorage)==null?void 0:e.isWritable)&&this.classroomStorage.setState({ban:!this.classroomStorage.state.ban})});d(this,"onStaging",async(e,t)=>{var s;this.classMode===Fe.Interaction||e===this.ownerUUID||!((s=this.onStageUsersStorage)!=null&&s.isWritable)||(this.isCreator?this.onStageUsersStorage.setState({[e]:t}):!t&&e===this.userUUID&&this.onStageUsersStorage.setState({[e]:!1}),!t&&(!this.isCreator||e!==this.userUUID)&&this.updateDeviceState(e,!1,!1))});d(this,"updateDeviceState",(e,t,s)=>{var a;if(((a=this.deviceStateStorage)==null?void 0:a.isWritable)&&(this.userUUID===e||this.isCreator)){const r=this.deviceStateStorage.state[e];if(r&&(e!==this.userUUID&&(t&&!r.camera&&(t=r.camera),s&&!r.mic&&(s=r.mic)),t===r.camera&&s===r.mic))return;this.deviceStateStorage.setState({[e]:t||s?{camera:t,mic:s}:void 0})}});d(this,"updateRoomStatusLoading",e=>{this.roomStatusLoading=e});if(!M.userUUID)throw new Error("Missing user uuid");window.classroomStore=this,this.roomUUID=e.roomUUID,this.ownerUUID=e.ownerUUID,this.userUUID=M.userUUID,this.classMode=Fe.Lecture,this.rtc=e.rtc,this.rtm=e.rtm,this.recording=e.recording,this.chatStore=new Xa({roomUUID:this.roomUUID,ownerUUID:this.ownerUUID,rtm:this.rtm,isShowUserGuide:M.isShowGuide}),this.users=new qa({roomUUID:this.roomUUID,ownerUUID:this.ownerUUID,userUUID:this.userUUID,isInRoom:t=>this.rtm.members.has(t)}),this.whiteboardStore=new Wn({isCreator:this.isCreator,isWritable:this.isCreator,getRoomType:()=>{var t;return((t=this.roomInfo)==null?void 0:t.roomType)||Ie.BigClass},whiteboard:e.whiteboard,onDrop:this.onDrop}),Qe(this,{rtc:Z.ref,rtm:Z.ref,sideEffect:!1,deviceStateStorage:!1,classroomStorage:!1,onStageUsersStorage:!1,shareScreenInfo:Z.ref}),this.sideEffect.addDisposer(this.recording.$Val.isRecording$.subscribe(t=>{oe(()=>{this.isRecording=t})})),this.sideEffect.addDisposer(Ht(()=>this.isRecording,t=>{t&&K.success(Pe.t("start-recording"))})),this.sideEffect.addDisposer(this.rtm.events.on("remote-login",Te("remote-login",()=>{this.isRemoteLogin=!0}))),this.isCreator||this.rtm.events.on("update-room-status",t=>{t.roomUUID===this.roomUUID&&t.senderID===this.ownerUUID&&this.updateRoomStatus(t.status)}),this.isCreator&&(this.sideEffect.addDisposer(this.rtm.events.on("raise-hand",t=>{var s;if(((s=this.classroomStorage)==null?void 0:s.isWritable)&&this.roomUUID===t.roomUUID){const a=this.classroomStorage.state.raiseHandUsers.some(r=>r===t.userUUID);t.raiseHand?a||this.classroomStorage.setState({raiseHandUsers:[...this.classroomStorage.state.raiseHandUsers,t.userUUID]}):a&&this.classroomStorage.setState({raiseHandUsers:this.classroomStorage.state.raiseHandUsers.filter(r=>r!==t.userUUID)})}})),this.sideEffect.addDisposer(Ht(()=>this.isScreenSharing||this.isRemoteScreenSharing,t=>{var s;(s=this.classroomStorage)!=null&&s.isWritable&&this.classroomStorage.setState({shareScreen:t})})))}get roomType(){var e,t;return(t=(e=this.roomInfo)==null?void 0:e.roomType)!=null?t:Ie.BigClass}get roomInfo(){return Oe.rooms.get(this.roomUUID)}get isCreator(){return this.ownerUUID===this.userUUID}get roomStatus(){var e,t;return this.whiteboardStore.isKicked?G.Stopped:(t=(e=this.roomInfo)==null?void 0:e.roomStatus)!=null?t:G.Idle}get firstOnStageUser(){return this.onStageUserUUIDs.length>0?this.users.cachedUsers.get(this.onStageUserUUIDs[0]):void 0}async init(){await Oe.syncOrdinaryRoomInfo(this.roomUUID),this.roomInfo&&this.roomInfo.ownerUUID!==this.ownerUUID&&(this.ownerUUID=this.roomInfo.ownerUUID,console.error(new Error("ClassRoom Error: ownerUUID mismatch!"))),await this.initRTC(),await this.rtm.joinRoom({roomUUID:this.roomUUID,ownerUUID:this.ownerUUID,uid:this.userUUID,token:M.rtmToken});const e=await this.whiteboardStore.joinWhiteboardRoom();await this.users.initUsers([...this.rtm.members]);const t=e.syncedStore.connectStorage("deviceState",{}),s=e.syncedStore.connectStorage("classroom",{ban:!1,raiseHandUsers:[],shareScreen:!1}),a=e.syncedStore.connectStorage("onStageUsers",{});this.deviceStateStorage=t,this.classroomStorage=s,this.onStageUsersStorage=a,this.isCreator?this.updateDeviceState(this.userUUID,Boolean(re.autoCameraOn),Boolean(re.autoMicOn)):this.whiteboardStore.updateWritable(Boolean(a.state[this.userUUID])),this._updateIsBan(s.state.ban),this.chatStore.onNewMessage=o=>{this.isRecording&&e.syncedStore.dispatchEvent("new-message",o)};const r=new Set,l=(o=[])=>{r.clear(),o.forEach(c=>{r.add(c)})};l(s.state.raiseHandUsers),this.users.updateUsers(o=>{if(o.userUUID===this.ownerUUID||a.state[o.userUUID]){o.isSpeak=!0,o.isRaiseHand=!1;const c=t.state[o.userUUID];c&&(o.camera=c.camera,o.mic=c.mic)}else o.isSpeak=!1,o.mic=!1,o.camera=!1,o.isRaiseHand=r.has(o.userUUID)}),this.sideEffect.addDisposer(this.rtm.events.on("member-joined",async({userUUID:o})=>{await this.users.addUser(o),this.users.updateUsers(c=>{if(c.userUUID===o&&(o===this.ownerUUID||a.state[o])){c.isSpeak=!0,c.isRaiseHand=!1;const u=t.state[c.userUUID];return u?(c.camera=u.camera,c.mic=u.mic):(c.camera=!1,c.mic=!1),!1}return!0})})),this.sideEffect.addDisposer(this.rtm.events.on("member-left",({userUUID:o})=>{this.users.removeUser(o)})),this.sideEffect.addDisposer(s.on("stateChanged",o=>{o.raiseHandUsers&&(l(o.raiseHandUsers.newValue),this.users.updateUsers(c=>{c.isRaiseHand=r.has(c.userUUID)})),o.ban&&(this._updateIsBan(o.ban.newValue),this.isCreator&&this.rtm.sendRoomCommand("ban",{roomUUID:this.roomUUID,status:o.ban.newValue}))}));const m=async o=>{const c=Object.keys(a.state).filter(u=>a.state[u]);if(await this.users.syncExtraUsersInfo(c),oe(()=>{this.onStageUserUUIDs.replace(c)}),this.users.updateUsers(u=>{if(u.userUUID!==this.ownerUUID)if(a.state[u.userUUID]){u.isSpeak=!0,u.isRaiseHand=!1;const f=t.state[u.userUUID];f?(u.camera=f.camera,u.mic=f.mic):(u.camera=!1,u.mic=!1)}else u.isSpeak=!1,u.mic=!1,u.camera=!1}),!this.isCreator){const u=Boolean(a.state[this.userUUID]);await this.whiteboardStore.updateWritable(u),u&&!e.syncedStore.isRoomWritable&&await new Promise(f=>{const g=e.syncedStore.addRoomWritableChangeListener(N=>{N&&(g(),f())})}),u&&((o==null?void 0:o[this.userUUID])||!t.state[this.userUUID])&&this.updateDeviceState(this.userUUID,re.autoCameraOn,re.autoMicOn)}};m(),this.sideEffect.addDisposer(a.on("stateChanged",m)),this.sideEffect.addDisposer(Wt(()=>{const o=[],c=this.users.cachedUsers.get(this.ownerUUID);c&&o.push({uid:c.rtcUID,avatar:c.avatar,isOwner:!0}),this.onStageUserUUIDs.forEach(u=>{const f=this.users.cachedUsers.get(u);f&&o.push({uid:f.rtcUID,avatar:f.avatar,isOwner:u===this.ownerUUID})}),o.sort((u,f)=>u.isOwner?-1:f.isOwner?1:(+u.uid|0)-(+f.uid|0)),this.updateRecordingLayout(o)})),this.sideEffect.addDisposer(t.on("stateChanged",()=>{this.users.updateUsers(o=>{const c=t.state[o.userUUID];c?(o.camera=c.camera,o.mic=c.mic):(o.mic=!1,o.camera=!1)})})),this.roomType===Ie.OneToOne&&(this.isCreator&&this.roomStatus===G.Idle&&this.startClass(),this.isCreator&&e.syncedStore.isRoomWritable&&(await e.syncedStore.nextFrame(),this.sideEffect.addDisposer(Wt(o=>{if(this.onStageUserUUIDs.length>0){o.dispose();return}this.users.joiners.length===1&&this.onStaging(this.users.joiners[0].userUUID,!0)})))),this.isCreator&&(await this.recording.joinRoom({roomID:this.roomUUID,classroomType:this.roomType}),re.autoRecording&&!this.isRecording&&await this.toggleRecording())}async destroy(){this.sideEffect.flushAll(),await this.stopRecording(),this.deviceStateStorage=void 0,this.onStageUsersStorage=void 0,this.classroomStorage=void 0}_updateIsBan(e){this.isBan=e}async switchRoomStatus(e){if(!(!this.isCreator||this.roomStatusLoading!==ge.Null)){if(!this.roomInfo)throw new Error("Room not ready!");try{switch(e){case G.Started:{this.updateRoomStatusLoading(ge.Starting),await hi(this.roomUUID),await Oe.syncOrdinaryRoomInfo(this.roomUUID);const t=this.roomUUID,s=M.periodicUUID;s&&await Oe.syncPeriodicSubRoomInfo({periodicUUID:s,roomUUID:t});break}case G.Paused:{this.updateRoomStatusLoading(ge.Pausing),await di(this.roomUUID);break}case G.Stopped:{this.updateRoomStatusLoading(ge.Stopping),await ui(this.roomUUID);break}default:break}this.updateRoomStatus(e)}catch(t){Ce(t),console.error(t)}this.updateRoomStatusLoading(ge.Null)}}async startRecording(){await this.recording.startRecording()}async stopRecording(){await this.recording.stopRecording()}async initRTC(){var e,t,s,a;this.sideEffect.addDisposer(this.rtc.events.on("network",Te("checkNetworkQuality",r=>{this.networkQuality=r}))),this.sideEffect.addDisposer(this.rtc.shareScreen.events.on("local-changed",Te("localShareScreen",r=>{this.isScreenSharing=r}))),this.sideEffect.addDisposer(this.rtc.shareScreen.events.on("remote-changed",Te("remoteShareScreen",r=>{this.isRemoteScreenSharing=r}))),M.rtcUID&&(await this.rtc.joinRoom({roomUUID:this.roomUUID,uid:String(M.rtcUID),token:M.rtcToken,mode:((e=this.roomInfo)==null?void 0:e.roomType)===Ie.BigClass?Ot.Broadcast:Ot.Communication,role:this.isCreator||M.userUUID&&((t=this.onStageUsersStorage)==null?void 0:t.state[M.userUUID])?$t.Host:$t.Audience,refreshToken:Li,shareScreenUID:String(((s=M.rtcShareScreen)==null?void 0:s.uid)||-1),shareScreenToken:((a=M.rtcShareScreen)==null?void 0:a.token)||""}),oe(()=>{this.isJoinedRTC=!0}))}}var $n="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ChatPanel/index.tsx";const jn=async()=>{},Lr=y(function({classRoomStore:e,disableEndSpeaking:t,maxSpeakingUsers:s=1}){const a=fi(()=>{const l=e.onStageUserUUIDs.map(u=>e.users.cachedUsers.get(u)).filter(u=>!!u),{creator:m,handRaisingJoiners:o,otherJoiners:c}=e.users;return m?[...l,...o,m,...c]:[...l,...o,...c]}).get(),r=e.users.handRaisingJoiners.length>0;return n(xa,{disableEndSpeaking:t,generateAvatar:gi,getUserByUUID:l=>e.users.cachedUsers.get(l),hasHandRaising:r,isBan:e.isBan,isCreator:e.isCreator,loadMoreRows:jn,messages:e.chatStore.messages,openCloudStorage:()=>e.toggleCloudStoragePanel(!0),ownerUUID:e.ownerUUID,unreadCount:e.users.handRaisingJoiners.length||null,userUUID:e.userUUID,users:a,withAcceptHands:r&&e.onStageUserUUIDs.length<s,onAcceptRaiseHand:l=>{e.onStageUserUUIDs.length<s&&e.acceptRaiseHand(l)},onBanChange:e.onToggleBan,onCancelAllHandRaising:e.onCancelAllHandRaising,onEndSpeaking:l=>{e.onStaging(l,!1)},onMessageSend:e.onMessageSend},void 0,!1,{fileName:$n,lineNumber:34,columnNumber:9},this)});var Zn="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ClassRoom/RoomStatusStoppedModal.tsx";const Hr=y(function({isCreator:e,isRemoteLogin:t,roomStatus:s}){const a=Et(),r=h.exports.useCallback(()=>{a(kt.HomePage)},[a]);return n(Ra,{isCreator:e,isRemoteLogin:t,roomStatus:s,onExit:r},void 0,!1,{fileName:Zn,lineNumber:25,columnNumber:13},this)});var Vn="/Users/yl/github-repo/openflat/packages/flat-pages/src/CloudStoragePage/CloudStoragePanel.tsx";const Bn=y(function({cloudStorage:e,onCoursewareInserted:t}){const s=pi(),a=vi(),r=h.exports.useMemo(()=>new URLSearchParams(a.search).get("path"),[a.search]),l=h.exports.useCallback(m=>{const o=new URLSearchParams({path:m}).toString();s.push({search:o})},[s]);return h.exports.useEffect(()=>e.initialize({onCoursewareInserted:t}),[e,t]),h.exports.useEffect(()=>{r!==null&&e.onParentDirectoryPathClick(r)},[r,e]),n(Ti,{path:r,pushHistory:l,store:e},void 0,!1,{fileName:Vn,lineNumber:41,columnNumber:12},this)});var Ze="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/CloudStorageButton.tsx";const Wr=y(function({classroom:e}){const t=C(),s=h.exports.useCallback(()=>e.toggleCloudStoragePanel(!1),[e]),a=h.exports.useCallback(()=>e.toggleCloudStoragePanel(!0),[e]);return e.whiteboardStore.isWritable?n(pe,{children:[n(_t,{icon:n(Ni,{},void 0,!1,{fileName:Ze,lineNumber:29,columnNumber:23},this),title:t("cloud-storage"),onClick:a},void 0,!1,{fileName:Ze,lineNumber:28,columnNumber:13},this),n(le,{centered:!0,destroyOnClose:!0,className:"cloud-storage-button-modal",footer:[],open:e.isCloudStoragePanelVisible,title:t("my-cloud"),onCancel:s,children:n(Bn,{cloudStorage:e.whiteboardStore.cloudStorageStore,onCoursewareInserted:s},void 0,!1,{fileName:Ze,lineNumber:42,columnNumber:17},this)},void 0,!1,{fileName:Ze,lineNumber:33,columnNumber:13},this)]},void 0,!0):null});var bt="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ExitRoomConfirm.tsx",zn=(i=>(i[i.StopClassButton=0]="StopClassButton",i[i.ExitButton=1]="ExitButton",i))(zn||{});function Or({roomStatus:i,hangClass:e,stopClass:t}){const[s,a]=h.exports.useState(1),[r,l]=h.exports.useState(!1),[m,o]=h.exports.useState(!1),[c,u]=h.exports.useState(!1),f=Pi(),g=Et(),N=h.exports.useContext(bs),v=h.exports.useCallback(async()=>{o(!0);try{await f(e())}catch(S){o(!1),console.error(S),Ce(S)}g(kt.HomePage)},[g,e,f]),p=h.exports.useCallback(async()=>{u(!0);try{await f(t())}catch(S){u(!1),console.error(S),Ce(S)}},[t,f]),b=h.exports.useCallback(()=>{l(!1)},[]),w=h.exports.useCallback(S=>{i===G.Started||i===G.Paused?(l(!0),a(S)):v()},[v,i]);return h.exports.useEffect(()=>{if(N)return N.sendWindowWillCloseEvent(()=>w(1)),()=>{N.removeWindowWillCloseEvent()}}),{confirmType:s,visible:r,isReturnLoading:m,isStopLoading:c,onReturnMain:v,onStopClass:p,onCancel:b,confirm:w}}const $r=y(function({isCreator:e,confirmType:t,isReturnLoading:s,isStopLoading:a,onReturnMain:r,onStopClass:l,...m}){return e?t===1?n(ya,{...m,hangLoading:s,stopLoading:a,onHang:r,onStop:l},void 0,!1,{fileName:bt,lineNumber:126,columnNumber:17},this):n(Ua,{...m,loading:a,onStop:l},void 0,!1,{fileName:bt,lineNumber:134,columnNumber:17},this):n(Ca,{...m,onExit:r},void 0,!1,{fileName:bt,lineNumber:141,columnNumber:13},this)});var Gn="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/Modal/InviteModal.tsx";const Yn=y(function({visible:e,room:t,onCopied:s,onCancel:a}){var f;const r=C(),l=h.exports.useContext(bi),m=h.exports.useContext(wi),{periodicUUID:o}=t,c=o?m.periodicRooms.get(o):void 0;h.exports.useEffect(()=>{o&&m.syncPeriodicRoomInfo(o).catch(Ce)},[o,m]);const u=h.exports.useCallback(async g=>{await navigator.clipboard.writeText(g),K.success(r("copy-success")),s()},[s,r]);return n(Ri,{baseUrl:Si,periodicWeeks:c==null?void 0:c.periodic.weeks,room:t,userName:(f=l.userName)!=null?f:"",visible:e,onCancel:a,onCopy:u},void 0,!1,{fileName:Gn,lineNumber:47,columnNumber:9},this)});var Ve="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/InviteButton.tsx";const jr=y(function({roomInfo:e}){const t=C(),[s,a]=h.exports.useState(!1),r=()=>a(!1);return n("div",{children:[n(_t,{icon:n(ma,{},void 0,!1,{fileName:Ve,lineNumber:19,columnNumber:23},this),title:t("invitation"),onClick:()=>a(!0)},void 0,!1,{fileName:Ve,lineNumber:18,columnNumber:13},this),e&&n(Yn,{room:e,visible:s,onCancel:r,onCopied:r},void 0,!1,{fileName:Ve,lineNumber:24,columnNumber:17},this)]},void 0,!0,{fileName:Ve,lineNumber:17,columnNumber:9},this)});var Be="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/RealtimePanel.tsx";class Zr extends Ae.PureComponent{render(){const{isVideoOn:e,isShow:t,videoSlot:s,chatSlot:a}=this.props;return n("div",{className:A("realtime-panel-wrap",{isActive:t}),children:n("div",{className:"realtime-panel",children:[n("div",{className:A("realtime-panel-video-slot",{isActive:e}),children:s},void 0,!1,{fileName:Be,lineNumber:26,columnNumber:21},this),n("div",{className:"realtime-panel-chat-slot",children:a},void 0,!1,{fileName:Be,lineNumber:33,columnNumber:21},this)]},void 0,!0,{fileName:Be,lineNumber:25,columnNumber:17},this)},void 0,!1,{fileName:Be,lineNumber:20,columnNumber:13},this)}}const Jn=[".ppt",".pptx",".doc",".docx",".pdf",".png",".jpg",".jpeg",".gif",".mp3",".mp4"];function wt(i){return Jn.some(e=>i.name.endsWith(e))}const qn=["image/png","image/jpg","image/jpeg","image/webp","image/apng","image/svg+xml","image/gif","image/bmp","image/avif","image/tiff"];function Ct(i){return qn.includes(i.type)}async function fs(i,e,t,s,a){if(!Ct(i)){console.log("[dnd:image] unsupported file type:",i.type,i.name);return}const r=K.loading(Pe.t("inserting-courseware-tips")),l=Xn(i),m=new Fi(i,a.parentDirectoryPath);await m.upload();const{files:o}=await xi({page:1,order:"DESC",directoryPath:a.parentDirectoryPath}),c=o.find(N=>N.fileUUID===m.fileUUID);if(r(),!(c!=null&&c.fileURL)){console.log("[dnd:image] upload failed:",i.name);return}const u=ws(),{width:f,height:g}=await l;s.insertImage({uuid:u,centerX:e,centerY:t,width:f,height:g,locked:!1}),s.completeImageUpload(u,c.fileURL),s.setMemberState({currentApplianceName:Ui.selector})}function Xn(i){const e=new Image,t=URL.createObjectURL(i),{innerWidth:s,innerHeight:a}=window,r=s*.8,l=a*.8;return e.src=t,new Promise(m=>{e.onload=()=>{URL.revokeObjectURL(t);const{width:o,height:c}=e;let u=1;(o>r||c>l)&&(u=Math.min(r/o,l/c)),m({width:Math.floor(o*u),height:Math.floor(c*u)})},e.onerror=()=>{m({width:s,height:a})}})}const Kn=[{src:"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/math_1.png",i18nKey:"presets.math_1"},{src:"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/english_1.jpeg",i18nKey:"presets.english_1"},{src:"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/chinese_1.png",i18nKey:"presets.chinese_1"}];function Qn(i){return{fileUUID:ws(),fileName:"",fileSize:0,fileURL:"",resourceType:"NormalResources",createAt:new Date,meta:{},...i}}var fe="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/Whiteboard.tsx";const er=()=>{},Vr=y(function({whiteboardStore:e,classRoomStore:t,disableHandRaising:s}){var X;const a=C(),{room:r,windowManager:l,phase:m,whiteboard:o}=e,c=h.exports.useContext(Ns),[u,f]=h.exports.useState(!1),[g,N]=h.exports.useState([]),[v,p]=h.exports.useState(!1),[b,w]=h.exports.useState(0),[S,E]=h.exports.useState(1/0),[L,_]=h.exports.useState(!1),I=m===Ye.Reconnecting;h.exports.useEffect(()=>o.events.on("exportAnnotations",()=>f(!0)),[o]),h.exports.useEffect(()=>o.events.on("insertPresets",()=>p(!0)),[o]),h.exports.useEffect(()=>{const U=o.events.on("scrollPage",w),k=o.events.on("maxScrollPage",E),R=o.events.on("userScroll",()=>_(!0));return()=>{U(),k(),R()}},[o]),h.exports.useEffect(()=>{if(L){let U=!0;const k=setTimeout(()=>{U&&_(!1)},1e3);return()=>{clearTimeout(k),U=!1}}else return},[L]),h.exports.useEffect(()=>{o.setTheme(c?"dark":"light")},[c,o]),h.exports.useEffect(()=>I?K.info(a("reconnecting"),0):er,[I,a]),h.exports.useEffect(()=>{u&&N(e.getSaveAnnotationImages())},[u,e]);const D=h.exports.useCallback(U=>{U&&o.render(U)},[o]),T=h.exports.useCallback(async U=>{const k=await Dt.getInstance().requestService("file");k&&k.insert(Qn({fileName:`${Date.now()}.png`,fileURL:U})),p(!1)},[]),W=h.exports.useCallback(U=>{U.preventDefault();const k=U.dataTransfer.files[0];r&&k&&wt(k)&&(U.dataTransfer.dropEffect="copy")},[r]),B=h.exports.useCallback(async U=>{U.preventDefault();const k=U.dataTransfer.files[0];if(r&&k)if(Ct(k)){const R=U.target.getBoundingClientRect(),se=U.clientX-R.left,ve=U.clientY-R.top,{x:Ne,y:be}=r.convertToPointInWorld({x:se,y:ve});await fs(k,Ne,be,r,e.cloudStorageStore)}else wt(k)&&e.onDrop(k)},[r,e]);return h.exports.useEffect(()=>{const U=k=>{var se;const R=(se=k.clipboardData)==null?void 0:se.files[0];if(r&&l&&R){const{centerX:ve,centerY:Ne}=l.camera;if(Ct(R)){const be=Ut(Date.now(),"yyyy-MM-dd_HH-mm-ss"),Le=yi(R.name),He=`screenshot_${be}.${Le}`,We=new File([R],He,{type:R.type,lastModified:R.lastModified});fs(We,ve,Ne,r,e.cloudStorageStore)}else wt(R)&&e.onDrop(R)}};return document.addEventListener("paste",U),()=>document.removeEventListener("paste",U)},[r,e,l]),n(pe,{children:[r&&n("div",{className:A("whiteboard-container",{"is-readonly":!e.isWritable}),onDragOver:W,onDrop:B,children:[!e.isCreator&&t.users.currentUser&&!t.users.currentUser.isSpeak&&n("div",{className:"raise-hand-container",children:n(Aa,{disableHandRaising:s,isRaiseHand:(X=t.users.currentUser)==null?void 0:X.isRaiseHand,onRaiseHandChange:t.onToggleHandRaising},void 0,!1,{fileName:fe,lineNumber:185,columnNumber:33},this)},void 0,!1,{fileName:fe,lineNumber:184,columnNumber:29},this),n("div",{ref:D,className:"whiteboard"},void 0,!1,{fileName:fe,lineNumber:192,columnNumber:21},this),n("div",{className:A("whiteboard-scroll-page",{"is-active":L}),children:tr(a,b,S)},void 0,!1,{fileName:fe,lineNumber:193,columnNumber:21},this)]},void 0,!0,{fileName:fe,lineNumber:174,columnNumber:17},this),n(Oa,{images:g,visible:u,onClose:()=>f(!1)},void 0,!1,{fileName:fe,lineNumber:202,columnNumber:13},this),n(Ya,{images:Kn,visible:v,onClick:T,onClose:()=>p(!1)},void 0,!1,{fileName:fe,lineNumber:207,columnNumber:13},this)]},void 0,!0)});function tr(i,e,t){return e===0?i("scroll.first-page"):e>=t?i("scroll.last-page"):i("scroll.page",{page:(((e+1)*10|0)/10).toFixed(1)})}var sr="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/RTCAvatar/AvatarCanvas.tsx";const ir=y(function({avatarUser:e,rtcAvatar:t,children:s}){const a=e==null?void 0:e.camera,r=e==null?void 0:e.mic,[l,m]=h.exports.useState(null),o=h.exports.useCallback(()=>(t==null?void 0:t.getVolumeLevel())||0,[t]);return h.exports.useEffect(()=>{t&&t.setElement(l)},[l,t]),h.exports.useEffect(()=>()=>{t&&(t.setElement(null),t.enableCamera(!1),t.enableMic(!1))},[t]),h.exports.useEffect(()=>{t&&t.enableCamera(Boolean(a))},[a,t]),h.exports.useEffect(()=>{t&&t.enableMic(Boolean(r))},[r,t]),s(o,n("div",{ref:m,className:"video-avatar-canvas"},void 0,!1,{fileName:sr,lineNumber:61,columnNumber:20},this))});var St="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/RTCAvatar/index.tsx";const Br=y(function({userUUID:e,avatarUser:t,rtcAvatar:s,isAvatarUserCreator:a,small:r,isCreator:l,updateDeviceState:m}){return t&&!t.hasLeft?n(ir,{avatarUser:t,rtcAvatar:s,children:(o,c)=>n(Ta,{avatarUser:t,getVolumeLevel:o,isCreator:l,small:r,updateDeviceState:m,userUUID:e,children:c},void 0,!1,{fileName:St,lineNumber:27,columnNumber:21},this)},void 0,!1,{fileName:St,lineNumber:25,columnNumber:13},this):n(Pa,{avatarUser:t,isAvatarUserCreator:a,small:r},void 0,!1,{fileName:St,lineNumber:40,columnNumber:13},this)});const ar="data:image/svg+xml;charset=utf8,%3csvg width='6' height='10' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M1 8a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2ZM1 4a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2ZM1 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z' fill='white' fill-rule='evenodd'/%3e%3c/svg%3e";var _e="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ShareScreen/ShareScreenTip/index.tsx";const nr=y(function({classroomStore:e}){const t=C(),s=h.exports.useContext(bs),[a]=h.exports.useState(()=>document.createElement("div"));h.exports.useEffect(()=>{if(s)return s.createShareScreenTipPortalWindow(a,t("share-screen.tip-window-title"))},[a,t,s]);const r=h.exports.useCallback(()=>e.toggleShareScreen(!1),[e]);return Ci.createPortal(n("div",{className:"share-screen-tip",children:[n("div",{children:[n("img",{alt:"drag icon",src:ar},void 0,!1,{fileName:_e,lineNumber:43,columnNumber:17},this),n("span",{children:t("share-screen.tip-window-body")},void 0,!1,{fileName:_e,lineNumber:44,columnNumber:17},this)]},void 0,!0,{fileName:_e,lineNumber:42,columnNumber:13},this),n(xe,{danger:!0,ghost:!0,onClick:r,children:t("share-screen.tip-window-button")},void 0,!1,{fileName:_e,lineNumber:46,columnNumber:13},this)]},void 0,!0,{fileName:_e,lineNumber:41,columnNumber:9},this),a)});var xt="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ShareScreen/index.tsx";const zr=y(function({classroomStore:e}){const t=h.exports.useRef(null),s=C();h.exports.useEffect(()=>{t.current&&e.rtc.shareScreen.setElement(t.current)},[e]),h.exports.useEffect(()=>{const r=l=>{rr(l)&&or(l.message)&&K.error(s("share-screen.browser-not-permission"))};return e.rtc.shareScreen.events.on("err-enable",r),()=>{e.rtc.shareScreen.events.off("err-enable",r)}},[e.rtc.shareScreen.events,s]);const a=h.exports.useMemo(()=>A("share-screen",{active:e.isRemoteScreenSharing}),[e.isRemoteScreenSharing]);return window.isElectron?n(pe,{children:[n("div",{ref:t,className:a},void 0,!1,{fileName:xt,lineNumber:49,columnNumber:17},this),e.isScreenSharing&&n(nr,{classroomStore:e},void 0,!1,{fileName:xt,lineNumber:51,columnNumber:21},this)]},void 0,!0):n("div",{ref:t,className:a},void 0,!1,{fileName:xt,lineNumber:57,columnNumber:12},this)});function rr(i){return"code"in i&&"message"in i&&i.code==="PERMISSION_DENIED"}function or(i){return i.indexOf("by system")!==-1}function lr(i){var l;const[e,t]=h.exports.useState(),s=Et(),a=Xe(),r=(l=e==null?void 0:e.roomInfo)==null?void 0:l.title;return h.exports.useEffect(()=>{r&&(document.title=r)},[r]),h.exports.useEffect(()=>{let m=!1,o;const c=Dt.getInstance();return a(Promise.all([c.requestService("videoChat"),c.requestService("textChat"),c.requestService("whiteboard"),c.requestService("recording")])).then(([u,f,g,N])=>{!m&&u&&f&&g&&N&&(o=new On({...i,rtc:u,rtm:f,whiteboard:g,recording:N}),t(o),a(o.init()).catch(v=>{Ce(v),s(kt.HomePage)}))}),()=>{m=!0,o==null||o.destroy().catch(u=>{console.error(u)}),c.shutdownService("videoChat"),c.shutdownService("textChat"),c.shutdownService("whiteboard"),c.shutdownService("recording")}},[]),e}var gs="/Users/yl/github-repo/openflat/packages/flat-pages/src/utils/with-classroom-store.tsx";const Gr=i=>y(function(t){const s=Ii(),a=lr(s);return a&&a.whiteboardStore.room&&a.whiteboardStore.phase!==Ye.Connecting&&a.whiteboardStore.phase!==Ye.Disconnecting?n(i,{classroomStore:a,...t},void 0,!1,{fileName:gs,lineNumber:33,columnNumber:13},this):n(Di,{onTimeout:"full-reload"},void 0,!1,{fileName:gs,lineNumber:35,columnNumber:13},this)});var Se="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ShareScreen/ShareScreenPicker/ScreenList/index.tsx";const cr=i=>URL.createObjectURL(new Blob([i.buffer],{type:"image/png"})),mr=y(function({screenInfo:e,classroomStore:t}){const[s,a]=h.exports.useState(""),r=C();h.exports.useEffect(()=>{e.length===0&&K.error(r("share-screen.desktop-not-permission"))},[e,r]);const l=h.exports.useCallback((o,c)=>{a(c),t.selectShareScreenInfo(o)},[t]),m=h.exports.useCallback(()=>{a(""),t.selectShareScreenInfo(null)},[t]);return n("div",{className:"screen-list",children:e.map(o=>{const c=typeof o.screenId=="number"?o.screenId:o.screenId.id,u=`${o.type}-${c}`,f=s===u;return n(ur,{active:f,activeKey:u,handleClick:f?m:l,info:o},u,!1,{fileName:Se,lineNumber:58,columnNumber:21},this)})},void 0,!1,{fileName:Se,lineNumber:51,columnNumber:9},this)}),ur=y(function({info:e,handleClick:t,active:s,activeKey:a}){return n(pe,{children:n("div",{className:"screen-item",children:[n("div",{className:A("screen-image-box",{active:s}),onClick:()=>t(e,a),children:n("img",{alt:"screenshots",src:cr(e.image)},void 0,!1,{fileName:Se,lineNumber:93,columnNumber:21},this)},void 0,!1,{fileName:Se,lineNumber:87,columnNumber:17},this),n("span",{children:e.name},void 0,!1,{fileName:Se,lineNumber:95,columnNumber:17},this)]},void 0,!0,{fileName:Se,lineNumber:86,columnNumber:13},this)},void 0,!1)});var ee="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ShareScreen/ShareScreenPicker/index.tsx";const dr=y(function({classroomStore:e,handleOk:t}){const s=C();h.exports.useLayoutEffect(()=>{e.refreshShareScreenInfo()},[e]);const a=h.exports.useCallback(()=>{e.toggleShareScreenPicker(!1)},[e]),r=e.selectedScreenInfo!==null;return n("div",{children:n(le,{centered:!0,open:!0,bodyStyle:{padding:"16px 0 0 16px"},className:"share-screen-picker-model",footer:[n(xe,{className:"footer-button",onClick:a,children:s("cancel")},"cancel",!1,{fileName:ee,lineNumber:43,columnNumber:21},this),n(hr,{handleOk:t,isSelected:r},"confirm",!1,{fileName:ee,lineNumber:46,columnNumber:21},this)],title:s("share-screen.choose-share-content"),width:"784px",onCancel:a,children:n("div",{className:A("share-screen-picker",{loading:e.shareScreenInfo.length===0}),children:e.shareScreenInfo.length>0?n(mr,{classroomStore:e,screenInfo:e.shareScreenInfo},void 0,!1,{fileName:ee,lineNumber:58,columnNumber:25},this):n(Ss,{size:"large"},void 0,!1,{fileName:ee,lineNumber:63,columnNumber:25},this)},void 0,!1,{fileName:ee,lineNumber:52,columnNumber:17},this)},void 0,!1,{fileName:ee,lineNumber:35,columnNumber:13},this)},void 0,!1,{fileName:ee,lineNumber:34,columnNumber:9},this)}),Yr=y(function({classroomStore:e,handleOk:t}){return e.shareScreenPickerVisible?n(dr,{classroomStore:e,handleOk:t},void 0,!1,{fileName:ee,lineNumber:76,columnNumber:9},this):null}),hr=y(function({isSelected:e,handleOk:t}){const[s,a]=h.exports.useState(!1),r=C();return n(xe,{className:"footer-button",disabled:!e,loading:s,type:"primary",onClick:()=>{a(!0),t()},children:r("confirm")},"submit",!1,{fileName:ee,lineNumber:93,columnNumber:9},this)});var fr="/Users/yl/github-repo/openflat/packages/flat-pages/src/components/ExtraPadding.tsx";const Jr=Ae.memo(function(){const e=h.exports.useContext(ki);return e!=null&&e.isMac?n("div",{className:"extra-padding"},void 0,!1,{fileName:fr,lineNumber:8,columnNumber:29},this):null});export{Pr as C,$r as E,jr as I,Tr as N,Hr as R,zr as S,Ar as T,Vr as W,Yr as a,Jr as b,Fr as c,_t as d,_r as e,Wr as f,Mr as g,zn as h,Rr as i,Er as j,Zr as k,Lr as l,Br as m,Or as u,Gr as w};
//# sourceMappingURL=ExtraPadding.01770bc1.js.map
