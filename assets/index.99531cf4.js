import{bP as f,bQ as b,bb as T,a$ as h,bp as y,l as i,bF as w,bd as x,bA as S,aR as M,d9 as p,d5 as v,da as P,q as R,db as k}from"./index.ec641b5a.js";import{u as C}from"./lifecycle.f56c70c9.js";import{E as D}from"./index.857b4caa.js";import{e as B}from"./routes.96a891de.js";import{u as E}from"./use-login-check.7d6be6b3.js";import{g as N}from"./index.a792be8b.js";function I(s,t){var a;if(arguments.length<1)throw new TypeError("1 argument required, but only none provided present");var o=f((a=t==null?void 0:t.nearestTo)!==null&&a!==void 0?a:1);if(o<1||o>30)throw new RangeError("`options.nearestTo` must be between 1 and 30");var r=b(s),d=r.getSeconds(),u=r.getMinutes()+d/60,m=N(t==null?void 0:t.roundingMethod),c=m(u/o)*o,l=u%o,g=Math.round(l/o)*o;return new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),c+g)}var O="/Users/yl/github-repo/openflat/packages/flat-pages/src/UserScheduledPage/index.tsx";const U=()=>{const s=new Date;let t=I(s,{nearestTo:30});return k(t,s)&&(t=p(t,30)),t.setSeconds(0),t.setMilliseconds(0),t},_=T(function(){E();const t=h(),a=y(),o=C(),r=i.exports.useContext(w),d=i.exports.useContext(x),u=i.exports.useContext(S),[m,c]=i.exports.useState(!1),[l]=i.exports.useState(()=>{var n;const e=U();return{title:(n=d.userInfo)!=null&&n.name?t("schedule-room-default-title",{name:d.userInfo.name}):"",type:M.BigClass,isPeriodic:!1,region:u.getRegion(),beginTime:new Date(e),endTime:p(e,30),periodic:{endType:"rate",weeks:[v(e)],rate:7,endTime:P(e,6)}}});return R(D,{initialValues:l,loading:m,type:"schedule",onSubmit:g},void 0,!1,{fileName:O,lineNumber:61,columnNumber:9},this);async function g(e){c(!0);try{const n={title:e.title,type:e.type,region:e.region,beginTime:e.beginTime.valueOf(),endTime:e.endTime.valueOf()};e.isPeriodic?await o(r.createPeriodicRoom({...n,periodic:e.periodic.endType==="rate"?{weeks:e.periodic.weeks,rate:e.periodic.rate}:{weeks:e.periodic.weeks,endTime:e.periodic.endTime.valueOf()}})):await o(r.createOrdinaryRoom(n)),a.goBack()}catch(n){console.error(n),B(n),c(!1)}}});export{_ as UserScheduledPage,_ as default};
//# sourceMappingURL=index.99531cf4.js.map
